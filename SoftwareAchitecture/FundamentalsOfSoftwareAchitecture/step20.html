<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
    
</style>
<link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492092506/files/epub.css" crossorigin="anonymous">
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 20. Analyzing Architecture Risk"><div class="chapter" id="ch-analyzing-architecture-risk">
        <h1><span class="label">Chapter 20. </span>Analyzing Architecture Risk</h1>
        
        
        <p>Every architecture has risk associated with it, whether it be risk involving availability, scalability, or data integrity.<a data-type="indexterm" data-primary="architecture risk, analyzing" id="ix_archrsk"></a><a data-type="indexterm" data-primary="risk (architecture), analyzing" data-see="architecture risk, analyzing" id="idm45838969755904"></a> Analyzing architecture risk is one of the key activities of architecture. By continually analyzing risk, the architect can address deficiencies within the architecture and take corrective action to mitigate the risk. In this chapter we introduce some of the key techniques and practices for qualifying risk, creating risk assessments, and identifying risk through an activity called <em>risk storming</em>.</p>
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Risk Matrix"><div class="sect1" id="idm45838969753888">
        <h1>Risk Matrix</h1>
        
        <p>The first issue that arises when assessing architecture risk is determining whether the risk should be classified as low, medium, or high.<a data-type="indexterm" data-primary="risk matrix (for architecture risk)" id="idm45838969752192"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk matrix for" id="idm45838969751472"></a> Too much subjectiveness usually enters into this classification, creating confusion about which parts of the architecture are really high risk versus medium risk. Fortunately, there is a risk matrix architects can leverage to help reduce the level of subjectiveness and qualify the risk associated with a particular area of the architecture.</p>
        
        <p>The architecture risk matrix (illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-matrix">Figure&nbsp;20-1</a>) uses two dimensions to qualify risk: the overall impact of the risk and the likelihood of that risk occurring. Each dimensions has a low (1), medium (2), and high (3) rating. These numbers are multiplied together within each grid of the matrix, providing an objective numerical number representing that risk. Numbers 1 and 2 are considered low risk (green), numbers 3 and 4 are considered medium risk (yellow), and numbers 6 through 9 are considered high risk (red).</p>
        
        <figure class="width-75"><div id="fig-analyzing-architecture-risk-matrix" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2001.png" alt="Risk Matrix" width="997" height="666">
        <h6><span class="label">Figure 20-1. </span>Matrix for determining architecture risk</h6>
        </div></figure>
        
        <p>To see how the risk matrix can be used, suppose there is a concern about availability with regard to a primary central database used in the application. First, consider the impact dimension—what is the overall impact if the database goes down or becomes unavailable? Here, an architect might deem that high risk, making that risk either a 3 (medium), 6 (high), or 9 (high). However, after applying the second dimension (likelihood of risk occurring), the architect realizes that the database is on highly available servers in a clustered configuration, so the likelihood is low that the database would become unavailable. Therefore, the intersection between the high impact and low likelihood gives an overall risk rating of 3 (medium risk).</p>
        <div data-type="tip"><h6>Tip</h6>
        <p>When leveraging the risk matrix to qualify the risk, consider the impact dimension first and the likelihood dimension second.</p>
        </div>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Risk Assessments"><div class="sect1" id="idm45838969743392">
        <h1>Risk Assessments</h1>
        
        <p>The risk matrix described in the previous section can be used to build what is called a <em>risk assessment</em>.<a data-type="indexterm" data-primary="risk assessments (for architecture risk)" id="idm45838969741200"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk assessments" id="idm45838969740368"></a> A risk assessment is a summarized report of the overall risk of an architecture with respect to some sort of contextual and meaningful assessment <span class="keep-together">criteria</span>.</p>
        
        <p class="pagebreak-before">Risk assessments can vary greatly, but in general they contain the risk (qualified from the risk matrix) of some <em>assessment criteria</em> based on services or domain areas of an application.<a data-type="indexterm" data-primary="services" data-secondary="risk assessment based on" id="idm45838969737248"></a><a data-type="indexterm" data-primary="domains" data-secondary="domain areas of applications, risk assessment on" id="idm45838969736256"></a> This basic risk assessment report format is illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-assessment">Figure&nbsp;20-2</a>, where light gray (1-2) is low risk, medium gray (3-4) is medium risk, and dark gray (6-9) is high risk. Usually these are color-coded as green (low), yellow (medium), and red (high), but shading can be useful for black-and-white rendering and for color blindness.</p>
        
        <figure><div id="fig-analyzing-architecture-risk-assessment" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2002.png" alt="Risk Assessment" width="1435" height="758">
        <h6><span class="label">Figure 20-2. </span>Example of a standard risk assessment</h6>
        </div></figure>
        
        <p>The quantified risk from the risk matrix can be accumulated by the risk criteria and also by the service or domain area. For example, notice in <a data-type="xref" href="#fig-analyzing-architecture-risk-assessment">Figure&nbsp;20-2</a> that the accumulated risk for data integrity is the highest risk area at a total of 17, whereas the accumulated risk for Availability is only 10 (the least amount of risk). The relative risk of each domain area can also be determined by the example risk assessment. Here, customer registration carries the highest area of risk, whereas order fulfillment carries the lowest risk. These relative numbers can then be tracked to demonstrate either improvements or degradation of risk within a particular risk category or domain area.</p>
        
        <p>Although the risk assessment example in <a data-type="xref" href="#fig-analyzing-architecture-risk-assessment">Figure&nbsp;20-2</a> contains all the risk analysis results, rarely is it presented as such. Filtering is essential for visually indicating a particular message within a given context. For example, suppose an architect is in a meeting for the purpose of presenting areas of the system that are high risk. Rather than presenting the risk assessment as illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-assessment">Figure&nbsp;20-2</a>, filtering can be used to only show the high risk areas (shown in <a data-type="xref" href="#fig-analyzing-architecture-risk-filtering">Figure&nbsp;20-3</a>), improving the overall signal-to-noise ratio and presenting a clear picture of the state of the system (good or bad).</p>
        
        <figure><div id="fig-analyzing-architecture-risk-filtering" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2003.png" alt="Assessment Filtering" width="1435" height="758">
        <h6><span class="label">Figure 20-3. </span>Filtering the risk assessment to only high risk</h6>
        </div></figure>
        
        <p>Another issue with <a data-type="xref" href="#fig-analyzing-architecture-risk-assessment">Figure&nbsp;20-2</a> is that this assessment report only shows a snapshot in time; it does not show whether things are improving or getting worse. In other words, <a data-type="xref" href="#fig-analyzing-architecture-risk-assessment">Figure&nbsp;20-2</a> does not show the direction of risk.<a data-type="indexterm" data-primary="direction of risk" id="idm45838969722000"></a> Rendering the direction of risk presents somewhat of an issue. If an up or down arrow were to be used to indicate direction, what would an up arrow mean? Are things getting better or worse? We’ve spent years asking people if an up arrow meant things were getting better or worse, and almost 50% of people asked said that the up arrow meant things were progressively getting worse, whereas almost 50% said an up arrow indicated things were getting better. The same is true for left and right arrows. For this reason, when using arrows to indicate direction, a key must be used. However, we’ve also found this doesn’t work either. Once the user scrolls beyond the key, confusion happens once again.</p>
        
        <p>We usually use the universal direction symbol of a plus (+) and minus (-) sign next to the risk rating <a data-type="indexterm" data-primary="plus (+) and minus (−) sign indicating risk direction" id="idm45838969719984"></a>to indicate direction, as illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-direction">Figure&nbsp;20-4</a>. Notice in <a data-type="xref" href="#fig-analyzing-architecture-risk-direction">Figure&nbsp;20-4</a> that although performance for customer registration is medium (4), the direction is a minus sign (red), indicating that it is progressively getting worse and heading toward high risk. On the other hand, notice that scalability of catalog checkout is high (6) with a plus sign (green), showing that it is improving. Risk ratings without a plus or minus sign indicate that the risk is stable and neither getting better nor worse.</p>
        
        <figure><div id="fig-analyzing-architecture-risk-direction" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2004.png" alt="Assessment Direction" width="1435" height="758">
        <h6><span class="label">Figure 20-4. </span>Showing direction of risk with plus and minus signs</h6>
        </div></figure>
        
        <p>Occasionally, even the plus and minus signs can be confusing to some people. Another technique for indicating direction is to leverage an arrow along with the risk rating number it is trending toward. This technique, as illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-direction2">Figure&nbsp;20-5</a>, does not require a key because the direction is clear.<a data-type="indexterm" data-primary="arrows indicating direction of risk" id="idm45838969713344"></a> Furthermore, the use of colors (red arrow for worse, green arrow for better) makes it even more clear where the risk is heading.</p>
        
        <figure><div id="fig-analyzing-architecture-risk-direction2" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2005.png" alt="Assessment Direction 2" width="1435" height="758">
        <h6><span class="label">Figure 20-5. </span>Showing direction of risk with arrows and numbers</h6>
        </div></figure>
        
        <p>The direction of risk can be determined by using continuous measurements through fitness functions described earlier in the book. By objectively analyzing each risk criteria, trends can be observed, providing the direction of each risk criteria.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Risk Storming"><div class="sect1" id="idm45838969742800">
        <h1>Risk Storming</h1>
        
        <p>No architect can single-handedly determine the overall risk of a system. The reason for this is two-fold.<a data-type="indexterm" data-primary="risk storming" id="ix_rskstrm"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming" id="ix_archrskrs"></a> First, a single architect might miss or overlook a risk area, and very few architects have full knowledge of every part of the system. This is where <em>risk storming</em> can help.</p>
        
        <p>Risk storming is a collaborative exercise used to determine architectural risk within a specific dimension. Common dimensions (areas of risk) include unproven technology, performance, scalability, availability (including transitive dependencies), data loss, single points of failure, and security. While most risk storming efforts involve multiple architects, it is wise to include senior developers and tech leads as well. Not only will they provide an implementation perspective to the architectural risk, but involving developers helps them gain a better understanding of the architecture.</p>
        
        <p>The risk storming effort involves both an individual part and a collaborative part. In the individual part, all participants individually (without collaboration) assign risk to areas of the architecture using the risk matrix described in the previous section. This noncollaborative part of risk storming is essential so that participants don’t influence or direct attention away from particular areas of the architecture. In the collaborative part of risk storming, all participants work together to gain consensus on risk areas, discuss risk, and form solutions for mitigating the risk.</p>
        
        <p>An architecture diagram is used for both parts of the risk storming effort. For holistic risk assessments, usually a comprehensive architecture diagram is used, whereas risk storming within specific areas of the application would use a contextual architecture diagram. It is the responsibility of the architect conducting the risk storming effort to make sure these diagrams are up to date and available to all participants.</p>
        
        <p><a data-type="xref" href="#fig-analyzing-architecture-risk-diagram">Figure&nbsp;20-6</a> shows an example architecture we’ll use to illustrate the risk storming process. In this architecture, an Elastic Load Balancer fronts each EC2 instance containing the web servers (Nginx) and application services. The application services make calls to a MySQL database, a Redis cache, and a MongoDB database for logging. <a data-type="indexterm" data-primary="MongoDB" data-secondary="database for logging in risk storming example" id="idm45838969700528"></a>They also make calls to the Push Expansion Servers. The expansion servers, in turn, all interface with the MySQL database, Redis cache, and MongoDB logging facility.</p>
        
        <figure><div id="fig-analyzing-architecture-risk-diagram" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2006.png" alt="Example Architecture Diagram" width="1174" height="1006">
        <h6><span class="label">Figure 20-6. </span>Architecture diagram for risk storming example</h6>
        </div></figure>
        
        <p>Risk storming is broken down into<a data-type="indexterm" data-primary="risk storming" data-secondary="primary activities in" id="idm45838969696864"></a> three primary activities:</p>
        <ol>
        <li>
        <p>Identification</p>
        </li>
        <li>
        <p>Consensus</p>
        </li>
        <li>
        <p>Mitigation</p>
        </li>
        
        </ol>
        
        <p>Identification is always an individual, noncollaborative activity, whereas consensus and mitigation are always collaborative and involve all participants working together in the same room (at least virtually). Each of these primary activities is discussed in detail in the following sections.</p>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Identification"><div class="sect2" id="idm45838969691520">
        <h2>Identification</h2>
        
        <p>The <em>identification</em> activity of risk storming involves each participant individually identifying areas of risk within the architecture.<a data-type="indexterm" data-primary="risk storming" data-secondary="identifying areas of risk" id="idm45838969689440"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming" data-tertiary="identifying areas of risk" id="idm45838969688448"></a> The following steps describe the identification part of the risk storming effort:</p>
        <ol>
        <li>
        <p>The architect conducting the risk storming sends out an invitation to all participants one to two days prior to the collaborative part of the effort. The invitation contains the architecture diagram (or the location of where to find it), the risk storming dimension (area of risk being analyzed for that particular risk storming effort), the date when the collaborative part of risk storming will take place, and the location.</p>
        </li>
        <li>
        <p>Using the risk matrix described in the first section of this chapter, participants individually analyze the architecture and classify the risk as low (1-2), medium (3-4), or high (6-9).</p>
        </li>
        <li>
        <p>Participants prepare small Post-it notes with corresponding colors (green, yellow, and red) and write down the corresponding risk number (found on the risk matrix).</p>
        </li>
        
        </ol>
        
        <p>Most risk storming efforts only involve analyzing one particular dimension (such as performance), but there might be times, due to the availability of staff or timing issues, when multiple dimensions are analyzed within a single risk storming effort (such as performance, scalability, and data loss). When multiple dimensions are analyzed within a single risk storming effort, the participants write the dimension next to the risk number on the Post-it notes so that everyone is aware of the specific dimension. For example, suppose three participants found risk within the central database. All three identified the risk as high (6), but one participant found risk with respect to availability, whereas two participants found risk with respect to performance. These two dimensions would be discussed separately.</p>
        <div data-type="tip"><h6>Tip</h6>
        <p>Whenever possible, restrict risk storming efforts to a single dimension. This allows participants to focus their attention to that specific dimension and avoids confusion about multiple risk areas being identified for the same area of the architecture.</p>
        </div>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Consensus"><div class="sect2" id="idm45838969680448">
        <h2>Consensus</h2>
        
        <p>The <em>consensus</em> activity in the risk storming effort is highly collaborative with the goal of gaining consensus among all participants regarding the risk within the architecture. <a data-type="indexterm" data-primary="risk storming" data-secondary="consensus activity" id="idm45838969678160"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming" data-tertiary="consensus" id="idm45838969677184"></a>This activity is most effective when a large, printed version of the architecture diagram is available and posted on the wall. In lieu of a large printed version, an electronic version can be displayed on a large screen.</p>
        
        <p>Upon arrival at the risk storming session, participants begin placing their Post-it notes on the architecture diagram in the area where they individually found risk. If an electronic version is used, the architect conducting the risk storming session queries every participant and electronically places the risk on the diagram in the area of the architecture where the risk was identified (see <a data-type="xref" href="#fig-analyzing-architecture-risk-identification">Figure&nbsp;20-7</a>).</p>
        
        <figure><div id="fig-analyzing-architecture-risk-identification" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2007.png" alt="Risk Storming Identification" width="1174" height="1030">
        <h6><span class="label">Figure 20-7. </span>Initial identification of risk areas</h6>
        </div></figure>
        
        <p>Once all of the Post-it notes are in place, the collaborative part of risk storming can begin. The goal of this activity of risk storming is to analyze the risk areas as a team and gain consensus in terms of the risk qualification. Notice several areas of risk were identified in the architecture, illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-identification">Figure&nbsp;20-7</a>:</p>
        <ol>
        <li>
        <p>Two participants individually identified the Elastic Load Balancer as medium risk (3), whereas one participant identified it as high risk (6).</p>
        </li>
        <li>
        <p>One participant individually identified the Push Expansion Servers as high risk (9).</p>
        </li>
        <li>
        <p>Three participants individually identified the MySQL database as medium risk (3).</p>
        </li>
        <li>
        <p>One participant individually identified the Redis cache as high risk (9).</p>
        </li>
        <li>
        <p>Three participants identified MongoDB logging as low risk (2).</p>
        </li>
        <li>
        <p>All other areas of the architecture were not deemed to carry any risk, hence there are no Post-it notes on any other areas of the architecture.<a data-type="indexterm" data-primary="MongoDB" data-secondary="database for logging in risk storming example" id="idm45838969664080"></a></p>
        </li>
        
        </ol>
        
        <p class="pagebreak-before">Items 3 and 5 in the prior list do not need further discussion in this activity since all participants agreed on the level and qualification of risk. However, notice there was a difference of opinion in item 1 in the list, and items 2 and 4 only had a single participant identifying the risk. These items need to be discussed during this activity.</p>
        
        <p>Item 1 in the list showed that two participants individually identified the Elastic Load Balancer as medium risk (3), whereas one participant identified it as high risk (6). In this case the other two participants ask the third participant why they identified the risk as high. Suppose the third participant says that they assigned the risk as high because if the Elastic Load Balancer goes down, the entire system cannot be accessed. While this is true and in fact does bring the overall impact rating to high, the other two participants convince the third participant that there is low risk of this happening. After much discussion, the third participant agrees, bringing that risk level down to a medium (3). However, the first and second participants might not have seen a particular aspect of risk in the Elastic Load Balancer that the third did, hence the need for collaboration within this activity of risk storming.</p>
        
        <p>Case in point, consider item 2 in the prior list where one participant individually identified the Push Expansion Servers as high risk (9), whereas no other participant identified them as any risk at all. In this case, all other participants ask the participant who identified the risk why they rated it as high. That participant then says that they have had bad experiences with the Push Expansion Servers continually going down under high load, something this particular architecture has. This example shows the value of risk storming—without that participant’s involvement, no one would have seen the high risk (until well into production of course!).</p>
        
        <p>Item 4 in the list is an interesting case. One participant identified the Redis cache as high risk (9), whereas no other participant saw that cache as any risk in the architecture. The other participants ask what the rationale is for the high risk in that area, and the one participant responds with, “What is a Redis cache?” In this case, Redis was unknown to the participant, hence the high risk in that area.</p>
        <div data-type="tip"><h6>Tip</h6>
        <p>For unproven or unknown technologies, always assign the highest risk rating (9) since the risk matrix cannot be used for this <span class="keep-together">dimension.</span></p>
        </div>
        
        <p>The example of item 4 in the list illustrates why it is wise (and important) to bring developers into risk storming sessions. Not only can developers learn more about the architecture, but the fact that one participant (who was in this case a developer on the team) didn’t know a given technology provides the architect with valuable information regarding overall risk.</p>
        
        <p>This process continues until all participants agree on the risk areas identified. Once all the Post-it notes are consolidated, this activity ends, and the next one can begin. The final outcome of this activity is shown in <a data-type="xref" href="#fig-analyzing-architecture-risk-consensus">Figure&nbsp;20-8</a>.</p>
        
        <figure><div id="fig-analyzing-architecture-risk-consensus" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2008.png" alt="Risk Storming Consensus" width="1174" height="1030">
        <h6><span class="label">Figure 20-8. </span>Consensus of risk areas</h6>
        </div></figure>
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect3" data-pdf-bookmark="Mitigation"><div class="sect3" id="idm45838969652272">
        <h3>Mitigation</h3>
        
        <p>Once all participants agree on the qualification of the risk areas of the architecture, the final and most important activity occurs—<em>risk mitigation</em>.<a data-type="indexterm" data-primary="risk storming" data-secondary="mitigation of risk" id="idm45838969650176"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming" data-tertiary="mitigation of risk" id="idm45838969649168"></a><a data-type="indexterm" data-primary="mitigation of architecture risk" id="idm45838969647936"></a> Mitigating risk within an architecture usually involves changes or enhancements to certain areas of the architecture that otherwise might have been deemed perfect the way they were.</p>
        
        <p>This activity, which is also usually collaborative, seeks ways to reduce or eliminate the risk identified in the first activity. There may be cases where the original architecture needs to be completely changed based on the identification of risk, whereas others might be a straightforward architecture refactoring, such as adding a queue for back pressure to reduce a throughput bottleneck issue.</p>
        
        <p>Regardless of the changes required in the architecture, this activity usually incurs additional cost. For that reason, key stakeholders typically decide whether the cost outweighs the risk.<a data-type="indexterm" data-primary="cost" data-secondary="for risk mitigation" data-secondary-sortas="risk" id="idm45838969645504"></a> For example, suppose that through a risk storming session the central database was identified as being medium risk (4) with regard to overall system availability. In this case, the participants agreed that clustering the database, combined with breaking the single database into separate physical databases, would mitigate that risk. However, while risk would be significantly reduced, this solution would cost $20,000. The architect would then conduct a meeting with the key business stakeholder to discuss this trade-off. During this negotiation, the business owner decides that the price tag is too high and that the cost does not outweigh the risk. Rather than giving up, the architect then suggests a different approach—what about skipping the clustering and splitting the database into two parts? The cost in this case is reduced to $8,000 while still mitigating most of the risk. In this case, the stakeholder agrees to the solution.</p>
        
        <p>The previous scenario shows the impact risk storming can have not only on the overall architecture, but also with regard to negotiations between architects and business stakeholders. Risk storming, combined with the risk assessments described at the start of this chapter, provide an excellent vehicle for identifying and tracking risk, improving the architecture, and handling negotiations between key stakeholders.<a data-type="indexterm" data-primary="risk storming" data-startref="ix_rskstrm" id="idm45838969642352"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming" data-startref="ix_archrskrs" id="idm45838969641376"></a></p>
        </div></section>
        
        
        
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Agile Story Risk Analysis"><div class="sect1" id="idm45838969709152">
        <h1>Agile Story Risk Analysis</h1>
        
        <p>Risk storming can be used for other aspects of software development besides just architecture.<a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="Agile story risk analysis" id="idm45838969639008"></a><a data-type="indexterm" data-primary="Agile development" data-secondary="Agile Story risk analysis" id="idm45838969638032"></a> For example, we’ve leveraged risk storming for determining overall risk of user story completion within a given Agile iteration (and consequently the overall risk assessment of that iteration) during story grooming. Using the risk matrix, user story risk can be identified by the first dimension (the overall impact if the story is not completed within the iteration) and the second dimension (the likelihood that the story will not be completed). By utilizing the same architecture risk matrix for stories, teams can identify stories of high risk, track those carefully, and prioritize them.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Risk Storming Examples"><div class="sect1" id="idm45838969636080">
        <h1>Risk Storming Examples</h1>
        
        <p>To illustrate the power of risk storming and how it can improve the overall architecture<a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming examples" id="ix_archrskrsex"></a><a data-type="indexterm" data-primary="risk storming" data-secondary="examples" id="ix_rskstrmex"></a> of a system, consider the example of a call center system to support nurses advising patients on various health conditions.<a data-type="indexterm" data-primary="risk storming" data-secondary="examples" data-tertiary="nurse diagnostics system" id="idm45838969631584"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming examples" data-tertiary="nurse diagnostics system" id="idm45838969630352"></a> The requirements for such a system are as follows:</p>
        
        <ul>
        <li>
        <p>The system will use a third-party diagnostics engine that serves up questions and guides the nurses or patients regarding their medical issues.</p>
        </li>
        <li>
        <p>Patients can either call in using the call center to speak to a nurse or choose to use a self-service website that accesses the diagnostic engine directly, bypassing the nurses.</p>
        </li>
        <li>
        <p>The system must support 250 concurrent nurses nationwide and up to hundreds of thousands of concurrent self-service patients nationwide.</p>
        </li>
        <li>
        <p>Nurses can access patients’ medical records through a medical records exchange, but patients cannot access their own medical records.</p>
        </li>
        <li>
        <p>The system must be HIPAA compliant with regard to the medical records. This means that it is essential that no one but nurses have access to medical records.</p>
        </li>
        <li>
        <p>Outbreaks and high volume during cold and flu season need to be addressed in the system.</p>
        </li>
        <li>
        <p>Call routing to nurses is based on the nurse’s profile (such as bilingual needs).</p>
        </li>
        <li>
        <p>The third-party diagnostic engine can handle about 500 requests a <span class="keep-together">second</span>.</p>
        </li>
        </ul>
        
        <p>The architect of the system created the high-level architecture illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-example">Figure&nbsp;20-9</a>. In this architecture there are three separate web-based user interfaces: one for self-service, one for nurses receiving calls, and one for administrative staff to add and maintain the nursing profile and configuration settings. The call center portion of the system consists of a call accepter which receives calls and the call router which routes calls to the next available nurse based on their profile (notice how the call router accesses the central database to get nurse profile information). Central to this architecture is a diagnostics system API gateway, which performs security checks and directs the request to the appropriate backend service.</p>
        <figure><div id="fig-analyzing-architecture-risk-example" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2009.png" alt="Nurse Example" width="1425" height="739">
        <h6><span class="label">Figure 20-9. </span>High-level architecture for nurse diagnostics system example</h6>
        </div></figure>
        
        <p>There are four main services in this system: a case management service, a nurse profile management service, an interface to the medical records exchange, and the external third-party diagnostics engine. All communications are using REST with the exception of proprietary protocols to the external systems and call center services.</p>
        
        <p>The architect has reviewed this architecture numerous times and believes it is ready for implementation. As a self-assessment, study the requirements and the architecture diagram in <a data-type="xref" href="#fig-analyzing-architecture-risk-example">Figure&nbsp;20-9</a> and try to determine the level of risk within this architecture in terms of availability, elasticity, and security. After determining the level of risk, then determine what changes would be needed in the architecture to mitigate that risk. The sections that follow contain scenarios that can be used as a comparison.</p>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Availability"><div class="sect2" id="idm45838969613008">
        <h2>Availability</h2>
        
        <p>During the first risk storming exercise, the architect chose to focus on availability first since system availability is critical for the success of this system. <a data-type="indexterm" data-primary="risk storming" data-secondary="examples" data-tertiary="availability of nurse diagnostics system" id="idm45838969611360"></a><a data-type="indexterm" data-primary="availability" data-secondary="in nurse diagnostics system risk storming example" id="idm45838969610080"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming examples" data-tertiary="availability of nurse diagnostics system" id="idm45838969609104"></a>After the risk storming identification and collaboration activities, the participants came up with the following risk areas using the risk matrix (as illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-availability-risk">Figure&nbsp;20-10</a>):</p>
        
        <ul>
        <li>
        <p>The use of a central database was identified as high risk (6) due to high impact (3) and medium likelihood (2).</p>
        </li>
        <li>
        <p>The diagnostics engine availability was identified as high risk (9) due to high impact (3) and unknown likelihood (3).</p>
        </li>
        <li>
        <p>The medical records exchange availability was identified as low risk (2) since it is not a required component for the system to run.</p>
        </li>
        <li>
        <p>Other parts of the system were not deemed as risk for availability due to multiple instances of each service and clustering of the API gateway.</p>
        </li>
        </ul>
        <figure><div id="fig-analyzing-architecture-risk-availability-risk" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2010.png" alt="Availability Risk" width="1425" height="739">
        <h6><span class="label">Figure 20-10. </span>Availability risk areas</h6>
        </div></figure>
        
        <p>During the risk storming effort, all participants agreed that while nurses can manually write down case notes if the database went down, the call router could not function if the database were not available. To mitigate the database risk, participants chose to break apart the single physical database into two separate databases: one clustered database containing the nurse profile information, and one single instance database for the case notes. Not only did this architecture change address the concerns about availability of the database, but it also helped secure the case notes from admin access. Another option to mitigate this risk would have been to cache the nurse profile information in the call router. However, because the implementation of the call router was unknown and may be a third-party product, the participants went with the database approach.</p>
        
        <p>Mitigating the risk of availability of the external systems (diagnostics engine and medical records exchange) is much harder to manage due to the lack of control of these systems.<a data-type="indexterm" data-primary="mitigation of architecture risk" data-secondary="availability risk in nurse diagnostics system example" id="idm45838969598256"></a> One way to mitigate this sort of availability risk is to research if there is a published service-level agreement (SLA) or service-level objective (SLO) for each of these systems. An SLA is usually a contractual agreement and is legally binding, whereas an SLO is usually not. Based on research, the architect found that the SLA for the diagnostics engine is guaranteed to be 99.99% available (that’s 52.60 minutes of downtime per year), and the medical records exchange is guaranteed at 99.9% availability (that’s 8.77 hours of downtime per year). Based on the relative risk, this information was enough to remove the identified risk.</p>
        
        <p>The corresponding changes to the architecture after this risk storming session are illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-availability-mitigation">Figure&nbsp;20-11</a>. Notice that two databases are now used, and also the SLAs are published on the architecture diagram.</p>
        <figure><div id="fig-analyzing-architecture-risk-availability-mitigation" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2011.png" alt="Availability Mitigation" width="1425" height="818">
        <h6><span class="label">Figure 20-11. </span>Architecture modifications to address availability risk</h6>
        </div></figure>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" class="pagebreak-before less_space" data-pdf-bookmark="Elasticity"><div class="sect2" id="idm45838969592864">
        <h2>Elasticity</h2>
        
        <p>On the second risk storming exercise, the architect chose to focus on elasticity—spikes <a data-type="indexterm" data-primary="elasticity" data-secondary="risks in nurse diagnostics system example" id="idm45838969591008"></a><a data-type="indexterm" data-primary="risk storming" data-secondary="examples" data-tertiary="elasticity of nurse diagnostics system" id="idm45838969589936"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming examples" data-tertiary="elasticity of nurse diagnostics system" id="idm45838969588704"></a>in user load (otherwise known as variable scalability). Although there are only 250 nurses (which provides an automatic governor for most of the services), the self-service portion of the system can access the diagnostics engine as well as nurses, significantly increasing the number of requests to the diagnostics interface. Participants were concerned about outbreaks and flu season, when anticipated load on the system would significantly increase.</p>
        
        <p>During the risk storming session, the participants all identified the diagnostics engine interface as high risk (9). With only 500 requests per second, the participants calculated that there was no way the diagnostics engine interface could keep up with the anticipated throughput, particularly with the current architecture utilizing REST as the interface protocol.</p>
        
        <p>One way to mitigate this risk is to leverage asynchronous queues (messaging) between the API gateway and the diagnostics engine<a data-type="indexterm" data-primary="mitigation of architecture risk" data-secondary="elasticity of nurse diagnostics system example" id="idm45838969585536"></a> interface to provide a back-pressure point if calls to the diagnostics engine get backed up. While this is a good practice, it still doesn’t mitigate the risk, because nurses (as well as self-service patients) would be waiting too long for responses from the diagnostics engine, and those requests would likely time out. Leveraging what is known as the <a href="https://oreil.ly/ZfLU0">Ambulance Pattern</a> would give nurses a higher priority over self-service.<a data-type="indexterm" data-primary="Ambulance pattern" id="idm45838969583360"></a> Therefore two message channels would be needed. While this technique helps mitigate the risk, it still doesn’t address the wait times. The participants decided that in addition to the queuing technique to provide back-pressure, caching the particular diagnostics questions related to an outbreak would remove outbreak and flu calls from ever having to reach the diagnostics engine interface.</p>
        
        <p>The corresponding architecture changes are illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-elasticity">Figure&nbsp;20-12</a>. Notice that in addition to two queue channels (one for the nurses and one for self-service patients), there is a new service called the <em>Diagnostics Outbreak Cache Server</em> that handles all requests related to a particular outbreak or flu-related question. With this architecture in place, the limiting factor was removed (calls to the diagnostics engine), allowing for tens of thousands of concurrent requests. Without a risk storming effort, this risk might not have been identified until an outbreak or flu season happened.</p>
        <figure><div id="fig-analyzing-architecture-risk-elasticity" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2012.png" alt="Availability Mitigation" width="1427" height="834">
        <h6><span class="label">Figure 20-12. </span>Architecture modifications to address elasticity risk</h6>
        </div></figure>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Security"><div class="sect2" id="idm45838969577712">
        <h2>Security</h2>
        
        <p>Encouraged by the results and success of the first two risk storming efforts, the architect<a data-type="indexterm" data-primary="security" data-secondary="risks in nurse diagnostics system example" id="idm45838969576096"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming examples" data-tertiary="security in nurse diagnostics system" id="idm45838969575024"></a> decides to hold a final risk storming session on another important architecture characteristic that must be supported in the system to ensure its success—security. Due to HIPAA regulatory requirements, access to medical records via the medical record exchange interface must be secure, allowing only nurses to access medical records if needed. The architect believes this is not a problem due to security checks in the API gateway (authentication and authorization) but is curious whether the participants find any other elements of security risk.</p>
        
        <p>During the risk storming, the participants all identified the Diagnostics System API gateway as a high security risk (6). <a data-type="indexterm" data-primary="API layer" data-secondary="security risks of Diagnostics System API gateway" id="idm45838969572560"></a>The rationale for this high rating was the high impact of admin staff or self-service patients accessing medical records (3) combined with medium likelihood (2). Likelihood of risk occurring was not rated high because of the security checks for each API call, but still rated medium because all calls (self-service, admin, and nurses) are going through the same API gateway. The architect, who only rated the risk as low (2), was convinced during the risk storming consensus activity that the risk was in fact high and needed mitigation.</p>
        
        <p class="pagebreak-before">The participants all agreed that having separate API gateways for each type of user (admin, self-service/diagnostics, and nurses) would prevent calls from either the admin web user interface or the self-service web user interface from ever reaching the medical records exchange interface. <a data-type="indexterm" data-primary="mitigation of architecture risk" data-secondary="security risks in nurse diagnostics system example" id="idm45838969569904"></a>The architect agreed, creating the final architecture, as illustrated in <a data-type="xref" href="#fig-analyzing-architecture-risk-security">Figure&nbsp;20-13</a>.</p>
        <figure><div id="fig-analyzing-architecture-risk-security" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492043447/files/assets/fosa_2013.png" alt="Security Mitigation" width="1425" height="909">
        <h6><span class="label">Figure 20-13. </span>Final architecture modifications to address security risk</h6>
        </div></figure>
        
        <p>The prior scenario illustrates the power of risk storming. By collaborating with other architects, developers, and key stakeholders on dimensions of risk that are vital to the success of the system, risk areas are identified that would otherwise have gone unnoticed. Compare figures <a data-type="xref" href="#fig-analyzing-architecture-risk-example">Figure&nbsp;20-9</a> and <a data-type="xref" href="#fig-analyzing-architecture-risk-security">Figure&nbsp;20-13</a> and notice the significant difference in the architecture prior to risk storming and then after risk storming. Those significant changes address availability concerns, elasticity concerns, and security concerns within the architecture.</p>
        
        <p>Risk storming is not a one-time process. Rather, it is a continuous process through the life of any system to catch and mitigate risk areas before they happen in production. How often the risk storming effort happens depends on many factors, including frequency of change, architecture refactoring efforts, and the incremental development of the architecture. It is typical to undergo a risk storming effort on some particular dimension after a major feature is added or at the end of every iteration.<a data-type="indexterm" data-primary="architecture risk, analyzing" data-secondary="risk storming examples" data-startref="ix_archrskrsex" id="idm45838969562240"></a><a data-type="indexterm" data-primary="risk storming" data-secondary="examples" data-startref="ix_rskstrmex" id="idm45838969560976"></a><a data-type="indexterm" data-primary="architecture risk, analyzing" data-startref="ix_archrsk" id="idm45838969559760"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        </div></section></div></div><link rel="stylesheet" href="/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="/api/v2/epubs/urn:orm:book:9781492043447/files/epub.css" crossorigin="anonymous"><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-svg.js"></script></div></div></section>
</div>

https://learning.oreilly.com