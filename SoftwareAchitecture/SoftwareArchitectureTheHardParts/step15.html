<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
    
</style>
<link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492092506/files/epub.css" crossorigin="anonymous">
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 15. Build Your Own Trade-Off Analysis"><div class="chapter" id="ch15-build-your-own-tradeoff-analysis">
        <h1><span class="label">Chapter 15. </span>Build Your Own Trade-Off Analysis</h1>
        
        
        <p><code>Monday, June 10, 10:01</code></p>
        <div class="story">
        
        <p>The conference room somehow seemed more brightly lit than it did on that fateful day<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="Sysops Squad saga" id="idm45978840682704"></a><a data-type="indexterm" data-primary="Sysops Squad sagas" data-secondary="trade-off analysis" id="idm45978840681728"></a> in September when the business sponsors of the Sysops Squad were about to pull the plug on the entire support contract business line. People in the conference room were chatting with each other before the meeting started, creating an energy not seen in the conference room for a long, long time.</p>
        
        <p>“Well,” said Bailey, the main business sponsor and head of the Sysops Squad ticketing application, “I suppose we should get things started. As you know, the purpose of this meeting is to discuss how the IT department was able to turn things around and repair what was nine months ago a train wreck.”</p>
        
        <p>“We call that a retrospective,” said Addison. “And it’s really useful for discovering how to do things better in the future, and to also discuss things that seemed to work well.”</p>
        
        <p>“So then, tell us, what worked really well? How did you turn this business line around from a technical standpoint?” asked Bailey.</p>
        
        <p>“It really wasn’t one single thing,” said Austen, “but rather a combination of a lot of things. First of all, we in IT learned a valuable lesson about looking at the business drivers as a way to address problems and create solutions. Before, we always used to focus only on the technical aspects of a problem, and as a result never saw the big picture.”</p>
        
        <p>“That was one part of it,” said Dana, “but one of the things that turned things around for me and the database team was starting to work together more with the application teams to solve problems. You see, before, those of us on the database side of things did our own thing, and the application development teams did their own thing. We never would have gotten to where we are now without collaborating and working together to migrate the Sysops Squad application.”</p>
        
        <p>“For me it was learning how to properly analyze trade-offs,” said Addison. “If it weren’t for Logan’s guidance, insights, and knowledge, we wouldn’t be in the shape we’re in now. It was because of Logan that we were able to justify our solutions from a business perspective.”</p>
        
        <p>“About that,” said Bailey, “I think I speak for everyone here when I say that your initial business justifications were what prompted us to give you one last shot at repairing the mess we were in. That was something we weren’t accustomed to, and, well, quite frankly it took us by surprise—in a good way.”</p>
        
        <p>“OK,” said Parker, “so now that we all agree things seem to be going well, how do we keep this pace going? How do we encourage other departments and divisions within the company from getting into the same mess we were in before?”</p>
        
        <p>“Discipline,” said Logan. “We continue our new habit of creating trade-off tables for all our decisions, continue documenting and communicating our decisions through architecture decision records, and continue collaborating with other teams on problems and solutions.”</p>
        
        <p>“But isn’t that just adding a lot of extra process and procedures to the mix?” asked Morgan, head of the marketing department.</p>
        
        <p>“No,” said Logan. “That’s <em>architecture</em>. And as you can see, it works.”</p>
        <hr>
        </div>
        
        <p>Throughout this book, the unifying example illustrates how to<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="building your own" id="ch15-coup"></a> generically perform trade-off analysis in distributed architectures. However, generic solutions rarely exist in architecture and, if they do, are generally incomplete for highly specific architectures and the unique problems they bring. Thus, we don’t think that the communication analysis covered in <a data-type="xref" href="ch02.html#ch02-discerning">Chapter&nbsp;2</a> is exhaustive, but rather a starting point for you to add more columns for the unique elements entangled with your problem space.</p>
        
        <p>To that end, this chapter provides some advice on how to build your own trade-off analysis, using many of the same techniques we used to derive the conclusions presented in this book.</p>
        
        <p>Our three-step process for modern trade-off analysis, which we introduced in <a data-type="xref" href="ch02.html#ch02-discerning">Chapter&nbsp;2</a> is as follows:</p>
        
        <ul>
        <li>
        <p>Find what parts are entangled together.</p>
        </li>
        <li>
        <p>Analyze how they are coupled to one another.</p>
        </li>
        <li>
        <p>Assess trade-offs by determining the impact of change to interdependent 
        <span class="keep-together">systems</span>.</p>
        </li>
        </ul>
        
        <p>We discuss some techniques and considerations for each step next.</p>
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Finding Entangled Dimensions"><div class="sect1" id="idm45978840662560">
        <h1>Finding Entangled Dimensions</h1>
        
        <p>An architect’s first step in this process is to discover what dimensions are entangled, or braided, together. This is unique within a particular architecture but discoverable by experienced developers, architects, operations folks, and other roles familiar with the existing overall ecosystem and its capabilities and constraints.</p>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Coupling"><div class="sect2" id="idm45978840660304">
        <h2>Coupling</h2>
        
        <p>The first part of the analysis answers this question for an<a data-type="indexterm" data-primary="coupling" data-secondary="trade-off analysis" id="ch15-coup2"></a><a data-type="indexterm" data-primary="trade-off analysis" data-secondary="coupling" id="ch15-coup3"></a> architect: how are parts within an architecture coupled to one another? The software development world has a wide variety of definitions of coupling, but we use the simplest, most intuitive version for this exercise: if someone changes <em>X</em>, will it possibly force <em>Y</em> to change?</p>
        
        <p>In <a data-type="xref" href="ch02.html#ch02-discerning">Chapter&nbsp;2</a>, we described the concept of the static<a data-type="indexterm" data-primary="static coupling" data-secondary="trade-off analysis" id="idm45978840653648"></a><a data-type="indexterm" data-primary="visualization tools" data-secondary="static coupling diagram" id="idm45978840652704"></a><a data-type="indexterm" data-primary="static coupling" data-secondary="trade-off analysis" data-tertiary="static coupling diagram" id="idm45978840651760"></a><a data-type="indexterm" data-primary="coupling" data-secondary="trade-off analysis" data-tertiary="static coupling diagram" id="idm45978840650544"></a><a data-type="indexterm" data-primary="trade-off analysis" data-secondary="coupling" data-tertiary="static coupling diagram" id="idm45978840649328"></a><a data-type="indexterm" data-primary="tools" data-secondary="visualization" data-tertiary="static coupling diagram" id="idm45978840648112"></a> coupling between architecture quanta, which provides a comprehensive structural diagram of technical coupling. No generic tool exists to build this because each architecture is unique. However, within an organization, a development team can build a static coupling diagram, either manually or via automation.</p>
        
        <p>For example, to create a static coupling diagram for a microservice within an architecture, an architect needs to gather the following details:</p>
        
        <ul>
        <li>
        <p>Operating systems/container dependencies</p>
        </li>
        <li>
        <p>Dependencies delivered via transitive dependency management (frameworks, libraries, etc.)</p>
        </li>
        <li>
        <p>Persistence dependencies on databases, search engines, cloud environments, etc.</p>
        </li>
        <li>
        <p>Architecture integration points required for the service to bootstrap itself</p>
        </li>
        <li>
        <p>Messaging infrastructure (such as a message broker) required to enable communication to other quanta</p>
        </li>
        </ul>
        
        <p>The static coupling diagram does not consider other quanta whose only coupling point is workflow communication with this quantum. For example, if an AssignTicket Service cooperates with the <code>ManageTicket</code> within a workflow but has no other coupling points, they are statically independent (but dynamically coupled during the actual workflow).</p>
        
        <p>Teams that already have most of their environments built via automation can build into that generative mechanism an extra capability to document the coupling points as the system builds.</p>
        
        <p>For this book, our goal was to measure the trade-offs in distributed architecture coupling and communication.<a data-type="indexterm" data-primary="dynamic coupling" data-secondary="about dimensions of" id="idm45978840638384"></a> To determine what became our three dimensions of dynamical quantum coupling, we looked at hundreds of examples of distributed architectures (both microservices and others) to determine the common coupling points. In other words, all the examples we looked at were sensitive to changes to the dimensions of <em>communication</em>, <em>consistency</em>, and <em>coordination</em>.</p>
        
        <p>This process highlights the importance of iterative design in architecture. No architect is so brilliant that their first draft is always perfect. Building sample topologies for workflows (much as we do in this book) allows an architect or team to build a matrix view of trade-offs, allowing quicker and more thorough analysis than ad hoc approaches.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Analyze Coupling Points"><div class="sect2" id="idm45978840634736">
        <h2>Analyze Coupling Points</h2>
        
        <p>Once an architect or team has identified the coupling points they want to analyze,<a data-type="indexterm" data-primary="coupling" data-secondary="trade-off analysis" data-tertiary="coupling points" id="idm45978840633232"></a><a data-type="indexterm" data-primary="static coupling" data-secondary="trade-off analysis" data-tertiary="coupling points" id="idm45978840631984"></a><a data-type="indexterm" data-primary="trade-off analysis" data-secondary="coupling" data-tertiary="coupling points" id="idm45978840630768"></a> the next step is to model the possible combinations in a lightweight way. Some of the combinations may not be feasible, allowing the architect to skip modeling those combinations. The goal of the analysis is to determine what forces the architect needs to study—in other words, which forces require trade-off analysis?  For example, for our architecture quantum dynamic coupling analysis, we chose coupling, complexity, responsiveness/availability, and scale/elasticity as our primary trade-off concerns, in addition to analyzing the three forces of communication, consistency, and coordination, as shown in the ratings table for the <a data-type="xref" href="ch12.html#sec-parallel-saga">“Parallel Saga<sup>(aeo)</sup> Pattern”</a>,  appearing again in <a data-type="xref" href="#tbl-parallel-saga-stars_15">Table&nbsp;15-1</a>.</p>
        <table id="tbl-parallel-saga-stars_15" style="width: 90%">
        <caption><span class="label">Table 15-1. </span>Ratings for the Parallel Saga pattern</caption>
        <thead>
        <tr>
        <th>Parallel Saga</th>
        <th>Ratings</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><p>Communication</p></td>
        <td><p>Asynchronous</p></td>
        </tr>
        <tr>
        <td><p>Consistency</p></td>
        <td><p>Eventual</p></td>
        </tr>
        <tr>
        <td><p>Coordination</p></td>
        <td><p>Centralized</p></td>
        </tr>
        <tr>
        <td><p>Coupling</p></td>
        <td><p>Low</p></td>
        </tr>
        <tr>
        <td><p>Complexity</p></td>
        <td><p>Low</p></td>
        </tr>
        <tr>
        <td><p>Responsiveness/availability</p></td>
        <td><p>High</p></td>
        </tr>
        <tr>
        <td><p>Scale/elasticity</p></td>
        <td><p>High</p></td>
        </tr>
        </tbody>
        </table>
        
        <p>When building these ratings lists, we considered each design solution (our named patterns) in isolation, combining them only at the end to see the differences, shown in <a data-type="xref" href="#tbl-tradeoff-consolidated">Table 15-2</a>.<a data-type="indexterm" data-primary="communication" data-secondary="dynamic coupling as" data-tertiary="saga pattern matrix" id="idm45978840611200"></a><a data-type="indexterm" data-primary="consistency" data-secondary="dynamic coupling relationship matrix" id="idm45978840609952"></a><a data-type="indexterm" data-primary="coordination of workflow" data-secondary="dynamic coupling relationship matrix" id="idm45978840608992"></a><a data-type="indexterm" data-primary="distributed architectures" data-secondary="dynamic coupling matrix" id="idm45978840608016"></a><a data-type="indexterm" data-primary="sagas" data-secondary="dynamic coupling matrix" id="idm45978840607056"></a><a data-type="indexterm" data-primary="transactional saga patterns" data-secondary="about" data-tertiary="pattern matrix" id="idm45978840606112"></a></p>
        <aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45978840604752">
        <h5>Trade-Offs</h5><table id="tbl-tradeoff-consolidated" class="tradeoff" style="width: 90%">
        <caption><span class="label">Table 15-2. </span>Consolidated comparison of dynamic coupling patterns</caption>
        <thead>
        <tr>
        <th>Pattern</th>
        <th>Coupling level</th>
        <th>Complexity</th>
        <th>Responsiveness/availability</th>
        <th>Scale/elasticity</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><p>Epic Saga</p></td>
        <td><p>Very high</p></td>
        <td><p>Low</p></td>
        <td><p>Low</p></td>
        <td><p>Very Low</p></td>
        </tr>
        <tr>
        <td><p>Phone Tag Saga</p></td>
        <td><p>High</p></td>
        <td><p>High</p></td>
        <td><p>Low</p></td>
        <td><p>Low</p></td>
        </tr>
        <tr>
        <td><p>Fairy Tale Saga</p></td>
        <td><p>High</p></td>
        <td><p>Very low</p></td>
        <td><p>Medium</p></td>
        <td><p>High</p></td>
        </tr>
        <tr>
        <td><p>Time Travel Saga</p></td>
        <td><p>Medium</p></td>
        <td><p>Low</p></td>
        <td><p>Medium</p></td>
        <td><p>High</p></td>
        </tr>
        <tr>
        <td><p>Fantasy Fiction Saga</p></td>
        <td><p>High</p></td>
        <td><p>High</p></td>
        <td><p>Low</p></td>
        <td><p>Low</p></td>
        </tr>
        <tr>
        <td><p>Horror Story</p></td>
        <td><p>Medium</p></td>
        <td><p>Very high</p></td>
        <td><p>Low</p></td>
        <td><p>Medium</p></td>
        </tr>
        <tr>
        <td><p>Parallel Saga</p></td>
        <td><p>Low</p></td>
        <td><p>Low</p></td>
        <td><p>High</p></td>
        <td><p>High</p></td>
        </tr>
        <tr>
        <td><p>Anthology Saga</p></td>
        <td><p>Very low</p></td>
        <td><p>High</p></td>
        <td><p>High</p></td>
        <td><p>Very high</p></td>
        </tr>
        </tbody>
        </table>
        </div></aside>
        
        <p>Once we had analyzed each pattern independently, we created a matrix to compare the characteristics, leading to interesting observations. <a data-type="indexterm" data-primary="coupling" data-secondary="scaling relationship" id="idm45978840570496"></a><a data-type="indexterm" data-primary="scalability" data-secondary="coupling relationship" id="idm45978840569520"></a>First, notice the direct inverse correlation between <em>coupling level</em> and <em>scale/elasticity</em>: the more coupling present in the pattern, the worse its scalability. This intuitively makes sense; the more services involved in a workflow, the more difficult for an architect to design for scale.</p>
        
        <p>Second, we made a similar observation around <em>responsiveness/availability</em> and <em>coupling level</em>, which<a data-type="indexterm" data-primary="availability" data-secondary="coupling relationship" id="idm45978840566000"></a><a data-type="indexterm" data-primary="coupling" data-secondary="availability relationship" id="idm45978840564992"></a> is not quite as direct as the preceding correlation but also significant: higher coupling leads to less responsiveness and availability because the more services involved in a workflow, the more likely the entire workflow will fail based on a service failure.</p>
        
        <p>This analysis technique exemplifies <em>iterative</em> architecture.<a data-type="indexterm" data-primary="architecture" data-secondary="iterative nature of analysis" id="idm45978840562880"></a><a data-type="indexterm" data-primary="trade-off analysis" data-secondary="iterative nature of" id="idm45978840561904"></a> No architect, regardless of their cleverness, can instantly understand the nuances of a truly unique situation—and these nuances constantly present themselves in complex architectures. Building a matrix of possibilities informs the modeling exercises an architect might want to do in order to study the implications of permutating one or more dimensions to see the resulting effect.<a data-type="indexterm" data-startref="ch15-coup" id="idm45978840560432"></a><a data-type="indexterm" data-startref="ch15-coup2" id="idm45978840559760"></a><a data-type="indexterm" data-startref="ch15-coup3" id="idm45978840559088"></a></p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Assess Trade-Offs"><div class="sect2" id="idm45978840558288">
        <h2>Assess Trade-Offs</h2>
        
        <p>Once you have built a platform that allows iterative “what if” scenarios,<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="assessing trade-offs" id="idm45978840557024"></a> focus on the fundamental trade-offs for a given situation. For example, we focused on synchronous versus asynchronous communication, a choice that creates a host of possibilities and restrictions—everything in software architecture is a trade-off. Thus, choosing a fundamental dimension like synchronicity first limits future choices. With that dimension now fixed, perform the same kind of iterative analysis on subsequent decisions encouraged or forced by the first. An architect team can iterate on this process until they have solved the difficult decisions—in other words, decisions with entangled dimensions. What’s left is design.</p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Trade-Off Techniques"><div class="sect1" id="idm45978840555664">
        <h1>Trade-Off Techniques</h1>
        
        <p>Over time, the authors have created a number of trade-off analyses and have built up some advice on how to approach them.</p>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Qualitative Versus Quantative Analysis"><div class="sect2" id="idm45978840553952">
        <h2>Qualitative Versus Quantative Analysis</h2>
        
        <p>You may have noticed that virtually none of our trade-off tables<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="techniques of" data-tertiary="qualitative versus quantitative analysis" id="idm45978840552480"></a> are <em>quantitative</em>—based on numbers—but are rather <em>qualitative</em>—measuring the quality of something rather than the quantity, which is necessary because two architectures will always differ enough to prevent true quantitative comparisons. However, using statistical analysis over a large data set allows reasonable qualitative analysis.</p>
        
        <p>For example, when comparing the scalability of patterns, we looked at multiple different <em>implementations</em> of communication, consistency, and coordination combinations, assessing scalability in each case, and allowing us to build the comparative scale shown in <a data-type="xref" href="#tbl-tradeoff-consolidated">Table 15-2</a>.</p>
        
        <p>Similarly, architects within a particular organization can carry out the same exercise, building a dimensional matrix of coupled concerns, and look at representative examples (either within the existing organization or localized spikes to test theories).</p>
        
        <p>We recommend you hone the skill of performing qualitative analysis, as few opportunities for true quantitative analysis exist in architecture.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="MECE Lists"><div class="sect2" id="idm45978840546544">
        <h2>MECE Lists</h2>
        
        <p>It is important for architects to be sure they are comparing the<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="techniques of" data-tertiary="MECE lists" id="idm45978840545040"></a><a data-type="indexterm" data-primary="MECE (Mutually Exclusive, Collectively Exhaustive) lists" id="idm45978840543712"></a> same things rather than wildly different ones. For example, it’s not a valid comparison to compare a simple message queue to an enterprise service bus, which contains a message queue but dozens of other components as well.</p>
        
        <p>A useful concept borrowed from the technology strategy world to help architects get the correct match of things to compare is a <em>MECE list</em>, an acronym for <em>mutually exclusive, collectively exhaustive</em>:</p>
        <dl>
        <dt>Mutually exclusive</dt>
        <dd>
        <p>None of the capabilities can overlap between the compared items. As in the preceding example, it is invalid to compare a message queue to an entire ESB because they aren’t really the same category of thing. If you want to compare just the messaging capabilities absent the other parts, that reduces the comparison to two mutually comparable things.</p>
        </dd>
        <dt>Collectively exhaustive</dt>
        <dd>
        <p>This suggests that you’ve covered all the possibilities in the decision space, and that you haven’t left out any obvious capabilities. For example, if a team of architects is evaluating high-performance message queues and consider only an ESB and simple message queue but not Kafka, they haven’t considered all the possibilities in the space.</p>
        </dd>
        </dl>
        
        <p>The goal of a MECE list is to cover a category space completely, with no holes or overlaps, as shown pictorially in <a data-type="xref" href="#fig-build-your-own-mece">Figure 15-1</a>.</p>
        
        <figure><div id="fig-build-your-own-mece" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1501.png" alt="A MECE list is mutually exclusive and combinatorially exhaustive" width="600" height="512">
        <h6><span class="label">Figure 15-1. </span>A MECE list is mutually exclusive and collectively exhaustive</h6>
        </div></figure>
        
        <p>The software development ecosystem constantly evolves, uncovering new capabilities along the way. When making a decision with long-term implications, an architect should make sure a new capability hasn’t just arrived that changes the criteria. Ensuring that comparison criteria is collectively exhaustive encourages that exploration.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="The “Out-of-Context” Trap"><div class="sect2" id="idm45978840533088">
        <h2>The “Out-of-Context” Trap</h2>
        
        <p>When assessing trade-offs, architects must make sure to keep the decision in context;<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="techniques of" data-tertiary="out-of-context trap" id="ch15-cont"></a><a data-type="indexterm" data-primary="out-of-context trap" id="ch15-cont2"></a><a data-type="indexterm" data-primary="context for trade-off analysis" id="ch15-cont3"></a> otherwise, external factors will unduly affect their analysis. Often, a solution has many beneficial aspects, but lacks critical capabilities that prevent success. Architects need to make sure they balance the <em>correct</em> set of trade-offs, not all available ones.</p>
        
        <p>For example, perhaps an architect is trying to decide whether to use a shared service or shared library for common functionality within a distributed architecture, as illustrated in <a data-type="xref" href="#fig-build-your-own-context-shared-lib">Figure 15-2</a>.</p>
        
        <figure><div id="fig-build-your-own-context-shared-lib" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1502.png" alt="Deciding between shared _service_ or _library_ in a distributed architecture" width="600" height="337">
        <h6><span class="label">Figure 15-2. </span>Deciding between shared <em>service</em> or <em>library</em> in a distributed architecture</h6>
        </div></figure>
        
        <p>The architect facing this decision will begin to study the two possible solutions, both via general characteristics discovered through research and via experimental data from within their organization. The results of that discovery process lead to a trade-off matrix such as the one shown in <a data-type="xref" href="#fig-build-your-own-context-table">Figure 15-3</a>.</p>
        
        <figure><div id="fig-build-your-own-context-table" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1503.png" alt="trade-off analysis " width="600" height="298">
        <h6><span class="label">Figure 15-3. </span>Trade-off analysis for two solutions</h6>
        </div></figure>
        
        <p class="pagebreak-before">The architect seems justified in choosing the shared library approach, as the matrix clearly favors that solution…<em>overall</em>. However, this decision exemplifies the <em>out-of-context</em> problem—when the extra context for the problem becomes clear, the decision criteria changes, as illustrated in <a data-type="xref" href="#fig-build-your-own-context-decision">Figure 15-4</a>.</p>
        
        <figure><div id="fig-build-your-own-context-decision" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1504.png" alt="Shifting decision based on additional context" width="600" height="392">
        <h6><span class="label">Figure 15-4. </span>Shifting decision based on additional context</h6>
        </div></figure>
        
        <p>The architect continued to research not only the generic problem of service versus library, but the actual context that applies in this situation. Remember, generic solutions are rarely useful in real-world architectures without applying additional situation-specific context.</p>
        
        <p>This process emphasizes two important observations. First, finding the best context for a decision allows the architect to consider fewer options, greatly simplifying the decision process. One common piece of advice from software sages is “embrace simple designs,” without ever explaining how to achieve that goal. Finding the correct <em>narrow</em> context for decisions allows architects to think about less, in many cases simplifying design.</p>
        
        <p>Second, it’s critical for architects to understand the importance of <em>iterative</em> design in architecture, diagramming sample architectural solutions to play qualitative “what-if” games to see how architecture dimensions impact one another. Using iterative design, architects can investigate possible solutions and discover the proper context in which a decision belongs.<a data-type="indexterm" data-startref="ch15-cont" id="idm45978840511568"></a><a data-type="indexterm" data-startref="ch15-cont2" id="idm45978840510864"></a><a data-type="indexterm" data-startref="ch15-cont3" id="idm45978840510192"></a></p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Model Relevant Domain Cases"><div class="sect2" id="idm45978840532496">
        <h2>Model Relevant Domain Cases</h2>
        
        <p>Architects shouldn’t make decisions in a vacuum, without<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="techniques of" data-tertiary="modeling relevant domain cases" id="ch15-modl"></a> relevant drivers that add value to the specific solution. Adding those domain drivers back to the decision process can help the architect filter the available options and focus on the really important trade-offs.</p>
        
        <p>For example, consider this decision by an architect as to whether to create a single payment service or a separate service for each payment type, as illustrated in <a data-type="xref" href="#fig-build-your-own-biz-scenario-payment-type">Figure 15-5</a>.</p>
        
        <figure><div id="fig-build-your-own-biz-scenario-payment-type" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1505.png" alt="Choosing between a single payment service or one per payment type" width="600" height="309">
        <h6><span class="label">Figure 15-5. </span>Choosing between a single payment service or one per payment type</h6>
        </div></figure>
        
        <p>As we discussed in <a data-type="xref" href="ch07.html#ch07-service-granularity">Chapter&nbsp;7</a>, architects can choose from a number of integrators and disintegrators to assist this decision. However, those forces are generic—an architect may add more nuance to the decision by modeling some likely scenarios.</p>
        
        <p>For example, consider the first scenario, illustrated in <a data-type="xref" href="#fig-build-your-own-biz-scenario-1">Figure 15-6</a>, to update a credit card processing service.</p>
        
        <p>In this scenario, having separate services provides better <em>maintainability</em>, <em>testability</em>, and <em>deployability</em>, all based on quantum-level isolation of the services. However, the downside of separate services is often duplicated code to prevent static quantum coupling between the services, which damages the benefit of having separate services.</p>
        
        <figure><div id="fig-build-your-own-biz-scenario-1" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1506.png" alt="Scenario 1: update credit card processing" width="600" height="246">
        <h6><span class="label">Figure 15-6. </span>Scenario 1: update credit card processing service</h6>
        </div></figure>
        
        <p>In the second scenario, the architect models what happens when the system adds a new payment type, as shown in <a data-type="xref" href="#fig-build-your-own-biz-scenario-2">Figure 15-7</a>.</p>
        
        <figure><div id="fig-build-your-own-biz-scenario-2" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1507.png" alt="Scenario 2: adding a payment type" width="600" height="218">
        <h6><span class="label">Figure 15-7. </span>Scenario 2: adding a payment type</h6>
        </div></figure>
        
        <p>The architect adds a <em>reward points</em> payment type to see what impact it has on the architecture characteristics of interest, highlighting <em>extensibility</em> as a benefit of separate services. So far, separate services look appealing.</p>
        
        <p>However, as in many cases, more complex workflows highlight the difficult parts of the architecture, as shown in the third scenario in <a data-type="xref" href="#fig-build-your-own-biz-scenario-3">Figure 15-8</a>.</p>
        
        <p>In this scenario, the architect starts gaining insight into the real trade-offs involved in this decision. Utilizing separate services requires coordination for this workflow, best handled by an orchestrater. However, as we discussed in <a data-type="xref" href="ch11.html#ch11-managing-workflows">Chapter&nbsp;11</a>, moving to an orchestrator likely impacts performance negatively and makes data consistency more of a challenge. The architect could avoid the orchestrator, but the workflow logic must reside somewhere—remember, semantic coupling can only be increased via implementation, never decreased.</p>
        
        <figure><div id="fig-build-your-own-biz-scenario-3" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1508.png" alt="Scenario 3: using multiple types for payment" width="600" height="325">
        <h6><span class="label">Figure 15-8. </span>Scenario 3: using multiple types for payment</h6>
        </div></figure>
        
        <p>Having modeled these three scenarios, the architect realizes that the real trade-off analysis comes down to which is more important: <em>performance and data consistency</em> (a single payment service) or <em>extensibility and agility</em> (separate services).</p>
        
        <p>Thinking about architecture problems in the generic and abstract gets an architect only so far. As architecture generally evades generic solutions, it is important for architects to build their skills in modeling relevant domain scenarios to home in on better trade-off analysis and decisions.<a data-type="indexterm" data-startref="ch15-modl" id="idm45978840483296"></a></p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Prefer Bottom Line over Overwhelming Evidence"><div class="sect2" id="idm45978840508928">
        <h2>Prefer Bottom Line over Overwhelming Evidence</h2>
        
        <p>It’s easy for architects to build up an enormous amount of<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="techniques of" data-tertiary="bottom line decision" id="idm45978840480944"></a> information in pursuit of learning all the facets of a particular trade-off analysis. Additionally, anyone who learns something new generally wants to tell others about it, especially if they think the other party will be interested. However, many of the technical details that architects uncover are arcane to nontechnical stakeholders, and the amount of detail may overwhelm their ability to add meaningful insight into the decision.</p>
        
        <p>Rather than show all the information they have gathered, an architect should reduce the trade-off analysis to a few key points, which are sometimes aggregates of individual trade-offs.</p>
        
        <p>Consider the common problem an architect might face in a microservices architecture about the choice of synchronous or asynchronous communication, illustrated in <a data-type="xref" href="#fig-build-your-own-bottom-setup">Figure 15-9</a>.</p>
        
        <figure><div id="fig-build-your-own-bottom-setup" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1509.png" alt="Deciding between communication types" width="600" height="175">
        <h6><span class="label">Figure 15-9. </span>Deciding between communication types</h6>
        </div></figure>
        
        <p>The synchronous solution orchestrator makes synchronous REST calls to communicate with workflow collaborators, whereas the asynchronous solution uses message queues to implement asynchronous communication.</p>
        
        <p>After considering the generic factors that point to one versus the other, the architect next thinks about specific domain scenarios of interest to nontechnical stakeholders. To that end, the architect will build a trade-off table that resembles <a data-type="xref" href="#totbl-sync-async">Table 15-3</a>.</p>
        <aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45978840472912">
        <h5>Trade-Offs</h5><table id="totbl-sync-async" class="tradeoff" style="width: 90%">
        <caption><span class="label">Table 15-3. </span>Trade-offs between synchronous and asynchronous communication for credit card processing</caption>
        <thead>
        <tr>
        <th>Synchronous advantage</th>
        <th>Synchronous disadvantage</th>
        <th>Asynchronous advantage</th>
        <th>Asynchronous disadvantage</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td></td>
        <td><p>Customer must wait for credit card approval process to start</p></td>
        <td><p>No wait for process to start</p></td>
        <td></td>
        </tr>
        <tr>
        <td><p>Credit approval is guaranteed to start before customer request ends</p></td>
        <td></td>
        <td></td>
        <td><p>No guarantee that the process has started</p></td>
        </tr>
        <tr>
        <td></td>
        <td><p>Customer application rejected if orchestrator is down</p></td>
        <td><p>Application submission not dependent on orchestrator</p></td>
        <td></td>
        </tr>
        </tbody>
        </table>
        </div></aside>
        
        <p>After modeling these scenarios, the architect can create a bottom-line decision for the stakeholders: which is more important, <em>a guarantee that the credit approval process starts immediately</em> or <em>responsiveness and fault-tolerance</em>? Eliminating confusing technical details allows the nontechnical domain stakeholders to focus on outcomes rather than design decisions, which help avoids drowning them in a sea of details.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Avoiding Snake Oil and Evangelism"><div class="sect2" id="idm45978840457968">
        <h2>Avoiding Snake Oil and Evangelism</h2>
        
        <p>One unfortunate side effect of enthusiasm for technology is<a data-type="indexterm" data-primary="trade-off analysis" data-secondary="techniques of" data-tertiary="snake oil and evangelism" id="idm45978840455344"></a> evangelism, which should be a luxury reserved for tech leads and developers but tends to get architects in 
        <span class="keep-together">trouble</span>.</p>
        
        <p>Trouble comes because, when someone evangelizes a tool, technique, approach, or anything else people build enthusiasm for, they start enhancing the good parts and diminishing the bad parts. Unfortunately, in software architecture, the trade-offs always eventually return to complicate things.</p>
        
        <p>An architect should also be wary of any tool or technique that promises any shocking new capabilities, which come and go on a regular basis. Always force evangelists for the tool or technique to provide an honest assessment of the good and bad—nothing in software architecture is all good—which allows a more balanced decision.</p>
        
        <p>For example, consider an architect who has had success in the past with a particular approach and becomes an evangelist for it, as illustrated in <a data-type="xref" href="#fig-build-your-own-evangelize-setup">Figure 15-10</a>.</p>
        
        <figure><div id="fig-build-your-own-evangelize-setup" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1510.png" alt="An architect evangelist who thinks they have found a silver bullet" width="600" height="362">
        <h6><span class="label">Figure 15-10. </span>An architect evangelist who thinks they have found a silver bullet</h6>
        </div></figure>
        
        <p>This architect has likely worked on problems in the past where extensibility was a key driving architecture characteristic and believes that capability will always drive the decision process. However, solutions in architecture rarely scale outside narrow confines of a particular problem space. On the other hand, anecdotal evidence is often compelling. How do you get to the real trade-off hiding behind the knee-jerk 
        <span class="keep-together">evangelism</span>?</p>
        
        <p>While experience is useful, scenario analysis is one of an architect’s most powerful tools to allow iterative design without building whole systems. By modeling likely scenarios, an architect can discover if a particular solution will, in fact, work well.</p>
        
        <p>In the example shown in <a data-type="xref" href="#fig-build-your-own-evangelize-setup">Figure 15-10</a>, an existing system uses a single topic to broadcast changes. The architect’s goal is to add <em>bid history</em> to the workflow—should the team keep the existing publish-and-subscribe approach or move to point-to-point messaging for each consumer?</p>
        
        <p>To discover the trade-offs for this specific problem, the architect should model likely domain scenarios using the two topologies. Adding bid history to the existing publish-and-subscribe design appears in <a data-type="xref" href="#fig-build-your-own-evangelize-add-topic">Figure 15-11</a>.</p>
        
        <figure><div id="fig-build-your-own-evangelize-add-topic" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1511.png" alt="Scenario 1: Adding _bid history_ to the existing topic" width="600" height="431">
        <h6><span class="label">Figure 15-11. </span>Scenario 1: Adding <em>bid history</em> to the existing topic</h6>
        </div></figure>
        
        <p>While this solution works, it has issues. First, what if the teams need different contracts for each consumer? Building a single large contract that encompasses everything implements the <a data-type="xref" href="ch13.html#sec-stamp-coupling">“Stamp Coupling for Workflow Management”</a> anti-pattern; forcing each team to unify on a single contract creates an accidental coupling point in the architecture—if one team changes its required information, all the teams must coordinate on that change. Second, what about data security? Using a single publish-and-subscribe topic, each consumer has access to all the data, which can create both security problems and PII (Personally Identifiable Information, discussed in <a data-type="xref" href="ch14.html#ch14-data-mesh">Chapter&nbsp;14</a>) issues as well. Third, the architect should consider the operational architecture characteristic differences between the different consumers. For example, if the operations team wanted to monitor queue depth and use auto-scaling for <em>bid capture</em> and <em>bid tracking</em> but not for the other two services, using a single topic prevents that capability—the consumers are now operationally coupled together.</p>
        
        <p>To mitigate these shortcomings, the architect should model the alternative solution to see if it addresses the preceding problems (and doesn’t introduce new intractable ones). The individual queue version appears in <a data-type="xref" href="#fig-build-your-own-evangelize-add-queue">Figure 15-12</a>.</p>
        
        <figure><div id="fig-build-your-own-evangelize-add-queue" class="figure">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492086888/files/assets/sahp_1512.png" alt="Using individual queues to capture bid information" width="600" height="382">
        <h6><span class="label">Figure 15-12. </span>Using individual queues to capture bid information</h6>
        </div></figure>
        
        <p>Each part of this workflow (bid capture, bid tracking, bid analytics, and bid history) utilizes its own message queues and addresses many of the preceding problems. First, each consumer can have their own contract, decoupling the consumers from each other. Second, security access and control of data resides within the contract between the producer and each consumer, allowing differences in both information and rate of change. Third, each queue can now be monitored and scaled independently.</p>
        
        <p>Of course, by this point in the book, you should realize that the point-to-point based system isn’t perfect either but offers a different set of trade-offs.</p>
        
        <p>Once the architect has modeled both approaches, it seems that the differences boil down to the choices shown in <a data-type="xref" href="#tbl-topic-queue">Table 15-4</a>.</p>
        <aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45978840429872">
        <h5>Trade-Offs</h5><table id="tbl-topic-queue" class="tradeoff" style="width: 90%">
        <caption><span class="label">Table 15-4. </span>Trade-offs between point-to-point versus publish-and-subscribe messaging</caption>
        <thead>
        <tr>
        <th>Point-to-point</th>
        <th>Publish-and-subscribe</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><p>Allows heterogeneous contracts</p></td>
        <td><p>Extensibility (easy to add new consumers)</p></td>
        </tr>
        <tr>
        <td><p>More granular security access and data control</p></td>
        <td></td>
        </tr>
        <tr>
        <td><p>Individual operational profiles per consumer</p></td>
        <td></td>
        </tr>
        </tbody>
        </table>
        </div></aside>
        
        <p>In the end, the architect should consult with interested parties (operations, enterprise architects, business analysts, and so on) to determine which of these sets of trade-offs is more important.</p>
        
        <p>Sometimes an architect doesn’t choose to evangelize something but is rather coerced into playing an opposite foil, particularly for something that has no clear advantage. Technologies develop fans, sometimes fervent ones, who tend to downplay disadvantages and enhance upsides.</p>
        
        <p>For example, recently a tech lead on a project tried to wrangle one of the authors into an argument about<a data-type="indexterm" data-primary="Monorepo" id="idm45978840418816"></a><a data-type="indexterm" data-primary="Trunk-based Development" id="idm45978840418112"></a> <a href="https://oreil.ly/PEEBC">monorepo</a> versus <a href="https://oreil.ly/HCtsh">trunk-based development</a>. Both have good and bad aspects, a classic software architecture decision. The tech lead was a fervent supporter of the monorepo approach, and tried to force the author to take the opposing position—it’s not an argument if two sides don’t exist.</p>
        
        <p>Instead, the architect pointed out that it was a trade-off, gently explaining that many of the advantages touted by the tech lead required a level of discipline that had never manifested within the team in the past, but will surely improve.</p>
        
        <p>Rather than be forced into taking the opposing position, instead the architect forced a real-world trade-off analysis, not based on generic solutions. The architect agreed to try the Monorepo approach but also gather metrics to make sure that the negative aspects of the solution didn’t manifest. For example, one of the damaging anti-patterns they wanted to avoid was accidental coupling between two projects because of repository proximity, so the architect and team built a series of fitness functions to ensure that, while technically possible to create a coupling point, the fitness function prevented it.</p>
        <div data-type="tip"><h6>Tip</h6>
        <p>Don’t allow others to force you into evangelizing something—bring it back to trade-offs.</p>
        </div>
        
        <p>We advise architects to avoid evangelizing and to try to become the objective arbiter of trade-offs. An architect adds real value to an organization not by chasing silver bullet after silver bullet but rather by honing their skills at analyzing the trade-offs as they appear.</p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" class="pagebreak-before" data-pdf-bookmark="Sysops Squad Saga: Epilogue"><div class="sect1" id="idm45978840412208">
        <h1>Sysops Squad Saga: Epilogue</h1>
        
        <p><code>Monday, June 20, 16:55</code></p>
        <div class="story">
        
        <p>“OK, I think I finally get it. We can’t really rely on generic advice<a data-type="indexterm" data-primary="Sysops Squad sagas" data-secondary="trade-off analysis" id="idm45978840409424"></a><a data-type="indexterm" data-primary="trade-off analysis" data-secondary="Sysops Squad saga" id="idm45978840408448"></a><a data-type="indexterm" data-primary="Sysops Squad sagas" data-secondary="epilogue" id="idm45978840407504"></a> for our architecture—it’s too different from all the others. We have to do the hard work of trade-off analysis 
        <span class="keep-together">constantly</span>.”</p>
        
        <p>“That’s correct. But it’s not a disadvantage—it’s an advantage. Once we all learn how to isolate dimensions and perform trade-off analysis, we’re learning concrete things about <em>our</em> architecture. Who cares about other, generic ones? If we can boil the number of trade-offs for a problem down to a small enough number to actually model and test them, we gain invaluable knowledge about our ecosystem. You know, structural engineers have built a ton of math and other predictive tools, but building their stuff is difficult and expensive. Software is a lot…well, softer. I’ve always said that <em>testing is the engineering rigor of software development</em>. While we don’t have the kind of math other engineers have, we can incrementally build and test our solutions, allowing much more flexibility and leveraging the advantage of a more flexible medium. Testing with objective outcomes allows our trade-off analyses to go from qualitative to quantitative—from speculation to engineering. The more concrete facts we can learn about our unique ecosystem, the more precise our analysis can become.”</p>
        
        <p>“Yeah, that makes sense. Want to go to the after-work gathering to celebrate the big turnaround?”</p>
        
        <p>“Sure.”</p>
        </div>
        </div></section>
        
        
        
        
        
        
        
        </div></section></div></div><link rel="stylesheet" href="/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="/api/v2/epubs/urn:orm:book:9781492086888/files/epub.css" crossorigin="anonymous"><script src="https://learning.oreilly.comhttps://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-svg.js"></script></div></div></section>
</div>

https://learning.oreilly.com