<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
</style>
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><div class="chapter" title="Chapter&nbsp;5.&nbsp;Network Devices and Traffic: How Smart is Your Network?"><div class="titlepage"><div><div><h1 class="title"><a id="network_devices_and_traffic_how_smart_is"></a>Chapter&nbsp;5.&nbsp;Network Devices and Traffic: How Smart is Your Network?</h1></div></div></div><div class="informalfigure"><a id="med_id00215a"></a><div class="mediaobject"><a id="med_id00215"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566488.png.jpg" alt="image with no caption" width="541" height="474"></div></div><p><span class="strong"><strong>A network can never be too smart.</strong></span></p><p>Networks need as much intelligence as you can pack into them, but <span class="strong"><strong>where does that intelligence come from</strong></span>? The answer is from its network devices. In this chapter, we’ll look at how <span class="strong"><strong>hubs, switches and routers</strong></span> use their innate <span class="strong"><strong>intelligence</strong></span> to move packets around a network. We’ll show you how these devices <span class="strong"><strong>think</strong></span>, why they’re so <span class="strong"><strong>useful</strong></span>, and we’ll even take a peek at what network traffic looks like using <span class="strong"><strong>packet analyzing software</strong></span>. Keep reading, and we’ll show you <span class="strong"><strong>how to super-charge your network</strong></span>.</p><div class="sect1" title="You’ve decoded the secret message..."><div class="titlepage"><div><div><h1 class="title"><a id="youapostropheve_decoded_the_secret_messa"></a>You’ve decoded the secret message...</h1></div></div></div><p>You’re a crackerjack network technician for the Head First Spy Agency. You’ve successfully decoded a secret message from the rogue signal, so what’s next?</p><div class="informalfigure"><a id="med_id00216a"></a><div class="mediaobject"><a id="med_id00216"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566490.png" alt="image with no caption" width="895" height="309"></div></div><div class="sect2" title="...but how do we know who sent it?"><div class="titlepage"><div><div><h2 class="title"><a id="hellipbut_how_do_we_know_who_sent_itques"></a>...but how do we know who sent it?</h2></div></div></div><p>Even though we’ve decoded one of the messages the mole sent, we don’t know who sent it. And if we don’t know who’s sending rogue messages, how can we prevent it from happening?</p><p>We need to somehow track down who the mole is—but how? All we have to go on is the rogue signal we used to decode the message. Can we somehow use that to help us sniff out the mole?</p><div class="informalfigure"><a id="med_id00217a"></a><div class="mediaobject"><a id="med_id00217"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566492.png.jpg" alt="image with no caption" width="309" height="388"></div></div><div class="sidebar"><a id="exercise-id00072"></a><p class="title">Exercise</p><p><a id="iddle1140" class="indexterm"></a>Label each part of the frame below and write some notes about which part of the frame might be important in catching the mole on our network.</p><div class="informalfigure"><a id="med_id00218a"></a><div class="mediaobject"><a id="med_id00218"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566494.png" alt="image with no caption" width="697" height="35"></div></div><p>Notes: _____________________________________________________________________</p><p>__________________________________________________________________________</p><p>__________________________________________________________________________</p><p>__________________________________________________________________________</p><p>__________________________________________________________________________</p></div><div class="sidebar"><a id="exercise_solution-id00073"></a><p class="title">Exercise Solution</p><p><a id="iddle1709" class="indexterm"></a>Label each part of the frame below and write some notes about which part of the frame might be important in catching the mole on our network.</p><div class="informalfigure"><a id="med_id00219a"></a><div class="mediaobject"><a id="med_id00219"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566496.png" alt="image with no caption" width="673" height="110"></div></div><p>Notes: <span class="underline">The Payload would contain the actual secret message being sent by the mole.</span></p><p><span class="underline">The Source MAC address field would tell us what hardware sent the message and help us pin down the mole’s computer.</span></p><p>__________________________________________________________________________</p><p><span class="underline">The Destination MAC address would tell us where the data was going to next.</span></p></div></div></div><div class="sect1" title="The packet information tells us where the packet came from"><div class="titlepage"><div><div><h1 class="title"><a id="packet_information_tells_us_where_the_pa"></a>The packet information tells us where the packet came from</h1></div></div></div><p>When we decoded the message earlier, we saw that each packet contains the source MAC address. In other words, it contains the MAC address of the hardware that sent the packet.</p><div class="note" title="Geek Bits"><h3 class="title"><a id="ch05note01"></a>Geek Bits</h3><p>It’s not just PCs that have MAC addresses. Many internet-capable video game systems have a console that will show you the MAC address of the device.</p></div><p>You can find a MAC address stamped on the NIC card inside a computer. MAC addresses are six bytes long, or 48 bits. Typically they are written in hexadecimal format and separated by colons or dashes, like this: 0f:2b:5d:e7:a3:eb.</p><div class="informalfigure"><a id="med_id00220a"></a><div class="mediaobject"><a id="med_id00220"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566498.png" alt="image with no caption" width="708" height="160"></div></div><p>The MAC address of the hardware that sent the rogue message is 00:1f:f3:53:fe:32. So how can we use this to tell us who the mole is?</p><div class="informalfigure"><a id="med_id00221a"></a><div class="mediaobject"><a id="med_id00221"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566500.png" alt="image with no caption" width="478" height="320"></div></div><p><span class="strong"><strong>Let’s see if this works.</strong></span></p></div><div class="sect1" title="So who’s the mole?"><div class="titlepage"><div><div><h1 class="title"><a id="so_whoapostrophes_the_molequestion_mark"></a>So who’s the mole?</h1></div></div></div><p><a id="iddle1119" class="indexterm"></a><a id="iddle1136" class="indexterm"></a><a id="iddle1205" class="indexterm"></a><a id="iddle1521" class="indexterm"></a><a id="iddle1576" class="indexterm"></a><a id="iddle1701" class="indexterm"></a>Here’s a list of all the MAC addresses at the company you’re investigating. So who uses the computer that sent the rogue signal?</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p><span class="strong"><strong>Person</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p><span class="strong"><strong>Location</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p><span class="strong"><strong>IP</strong></span></p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p><span class="strong"><strong>MAC</strong></span></p>
<div class="note" title="Note"><h3 class="title"><a id="ch05note02"></a>Note</h3><p>The MAC address that sent the rogue signal is 00:1f:f3:53:fe:32. But where is it in the list?</p></div></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Mike D.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Admin</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.100.34</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>00:1f:f3:53:fe:ae</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Sue T.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Front Desk</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.100.45</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>00:1f:f3:53:fe:28</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Ed G.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Shipping</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.100.32</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>00:1f:f3:53:f:18</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Kyle M.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>IT</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.100.2</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>00:1f:f3:54:27:d2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Debbie Y.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>IT</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.100.3</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>00:1f:f3:86:fe:2a</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Carol C.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Admin</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.100.4</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>00:1f:f3:23:4f:1a</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>Server</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>IT</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>192.168.100.100</p></td><td style="" valign="top"><p>00:1f:f3:23:4f:27</p></td></tr></tbody></table></div><p>Unfortunately, the source MAC address of the signal isn’t in the list, even though the list of computers is up to date. But why?</p><div class="informalfigure"><a id="med_id00222a"></a><div class="mediaobject"><a id="med_id00222"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566502.png" alt="image with no caption" width="445" height="362"></div></div><p><span class="strong"><strong>Other types of hardware have MAC addresses.</strong></span></p><p>Let’s take a look at the network and see if we can see what’s going on.</p></div><div class="sect1" title="There’s more to networks than computers"><div class="titlepage"><div><div><h1 class="title"><a id="thereapostrophes_more_to_networks_than_c"></a>There’s more to networks than computers</h1></div></div></div><p><a id="iddle1137" class="indexterm"></a><a id="iddle1141" class="indexterm"></a><a id="iddle1142" class="indexterm"></a><a id="iddle1147" class="indexterm"></a><a id="iddle1148" class="indexterm"></a><a id="iddle1266" class="indexterm"></a><a id="iddle1272" class="indexterm"></a><a id="iddle1339" class="indexterm"></a><a id="iddle1513" class="indexterm"></a><a id="iddle1702" class="indexterm"></a>The company network isn’t just comprised of computers and servers. There’s also network devices such as hubs, switches and routers. Hubs and switches work on the local area network (LAN) or intranet, and routers allow us to set up wide area networks (WANs) or internets.</p><div class="note" title="Watch it!"><h3 class="title"><a id="ch05note03"></a>Watch it!</h3><p><span class="strong"><strong>The Internet is not the same thing as an internet.</strong></span></p><p>The Internet refers to the big interconnected space we use to send data around the world. The term “internet” refers to at least two intranets connected together by a router.</p></div><div class="informalfigure"><a id="med_id00223a"></a><div class="mediaobject"><a id="med_id00223"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566504.png" alt="image with no caption" width="610" height="571"></div></div><div class="sidebar"><a id="hubs_up_close"></a><p class="title">Hubs Up Close</p><p>As we’ve said before, hubs allow us to connect the different machines we want on our network, like computers and printers, for example. It simply takes an incoming signal, copies it to all its other ports, and broadcasts it. A hub is sometimes called a repeater because it repeats the incoming signal using no digital intelligence such as memory or a processor.</p><p>Here’s what a hub looks like inside:</p><div class="informalfigure"><a id="med_id00224a"></a><div class="mediaobject"><a id="med_id00224"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566506.png.jpg" alt="image with no caption" width="522" height="474"></div></div><p><span class="strong"><strong>Hubs are dumb</strong></span></p><p>A hub is a dumb device because it doesn’t understand network data, and it doesn’t know about or store MAC addresses. It simply repeats incoming signals on all ports, without making any changes to the signal before broadcasting it.</p></div></div><div class="sect1" title="Hubs don’t change the MAC address"><div class="titlepage"><div><div><h1 class="title"><a id="hubs_donapostrophet_change_the_mac_addre"></a>Hubs don’t change the MAC address</h1></div></div></div><p><a id="iddle1144" class="indexterm"></a><a id="iddle1145" class="indexterm"></a><a id="iddle1150" class="indexterm"></a><a id="iddle1304" class="indexterm"></a><a id="iddle1305" class="indexterm"></a><a id="iddle1329" class="indexterm"></a><a id="iddle1835" class="indexterm"></a><a id="iddle1848" class="indexterm"></a>So how does this help us trace the rogue signal?</p><div class="note" title="Watch it!"><h3 class="title"><a id="ch05note04"></a>Watch it!</h3><p><span class="strong"><strong>There is no way to tell that a packet was broadcast from a hub.</strong></span></p><p><span class="emphasis"><em>You just have to know your network layout and what nodes are connected to hubs.</em></span></p></div><p>The last device that the packet came through before it was intercepted was a hub. As a hub simply transmits signals as it receives them and has no real understanding of network data, it doesn’t make any change to the source MAC address. It keeps the source MAC address as it was when it received the packet.</p><div class="informalfigure"><a id="med_id00225a"></a><div class="mediaobject"><a id="med_id00225"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566508.png" alt="image with no caption" width="616" height="343"></div></div><div class="sect2" title="So which device sent the packet to the hub?"><div class="titlepage"><div><div><h2 class="title"><a id="so_which_device_sent_the_packet_to_the_h"></a>So which device sent the packet to the hub?</h2></div></div></div><p>As the hub makes no changes to the source MAC address, this means that the source MAC address must belong to the device that passed the signal to the hub. We need to look beyond the hub to sniff out the mole.</p><div class="note" title="Brain Power"><h3 class="title"><a id="ch05note05"></a>Brain Power</h3><p>Hubs contain no processors. What does this tell you about how the hub processes signals?</p></div></div></div><div class="sect1" title="A hub sends signals, and sends them everywhere"><div class="titlepage"><div><div><h1 class="title"><a id="hub_sends_signalscomma_and_sends_them_ev"></a>A hub sends signals, and sends them <span class="underline">everywhere</span></h1></div></div></div><p><a id="iddle1143" class="indexterm"></a><a id="iddle1293" class="indexterm"></a><a id="iddle1295" class="indexterm"></a>A hub receives incoming signals and sends them out on all the other ports. When several devices start sending signals, the hub’s incessant repetition creates heavy traffic and collisions. A collision happens when two signals run into one another, creating an error. The sending network device has to back off and wait to send the signal again.</p><div class="informalfigure"><a id="med_id00226a"></a><div class="mediaobject"><a id="med_id00226"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566510.png.jpg" alt="image with no caption" width="673" height="317"></div></div><div class="sect2" title="Hubs think in terms of electricity"><div class="titlepage"><div><div><h2 class="title"><a id="hubs_think_in_terms_of_electricity"></a>Hubs think in terms of electricity</h2></div></div></div><p>A hub contains no processors, and this means that a hub has no real understanding of network data. It doesn’t understand MAC addresses or frames. It sees an incoming networking signal as a purely electrical signal, and passes it on.</p><p>So what next?</p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>A hub is really just an electrical repeater. It takes whatever signal comes in, and sends it out on all the other ports.</strong></span></p></blockquote></div></div></div><div class="sect1" title="So what passed the signal to the hub?"><div class="titlepage"><div><div><h1 class="title"><a id="so_what_passed_the_signal_to_the_hubques"></a>So what passed the signal to the hub?</h1></div></div></div><p><a id="iddle1834" class="indexterm"></a>So far we’ve seen that the signal passed through a hub, but we don’t know which network device passed the signal to the hub. Let’s go back to the network diagram, this time looking at what other devices are connected to the hub.</p><div class="informalfigure"><a id="med_id00227a"></a><div class="mediaobject"><a id="med_id00227"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566512.png" alt="image with no caption" width="567" height="597"></div></div><p>The hub has two devices connected to it that could have sent the signal, a computer and a switch. As the computer MAC address doesn’t match the one we’re looking for, we know the computer didn’t send the signal; it must have been the switch.</p><p>So how do switches function?</p></div><div class="sect1" title="A switch sends frames, and only sends them where they need to go"><div class="titlepage"><div><div><h1 class="title"><a id="switch_sends_framescomma_and_only_sends"></a>A switch sends frames, and only sends them where they need to go</h1></div></div></div><p><a id="iddle1192" class="indexterm"></a>Switches avoid collisions by storing and forwarding frames on the intranet. Switches are able to do this by using the MAC address of the frame. Instead of repeating the signal on all ports, it sends it on to the device that needs it.</p><div class="informalfigure"><a id="med_id00228a"></a><div class="mediaobject"><a id="med_id00228"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566514.png.jpg" alt="image with no caption" width="501" height="351"></div></div><div class="sect2" title="Switches think in terms of frames"><div class="titlepage"><div><div><h2 class="title"><a id="switches_think_in_terms_of_frames"></a>Switches think in terms of frames</h2></div></div></div><p>A switch contains processors, RAM, and ASICS, and this means that a switch can properly process network data. It understands MAC addresses and frames, which means that it can deal intelligently with any incoming networking signal. It can work out where the signal needs to go, and deals with it accordingly.</p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>A switch reads the signal as a frame and uses the frame’s information to send it where it’s supposed to go.</strong></span></p></blockquote></div><div class="sidebar"><a id="switches_up_close"></a><p class="title">Switches Up Close</p><p>Just like a hub, a switch allows us to connect the different machines we want on our network, like computers and printers, for example.</p><p>Here’s a look inside a switch:</p><div class="informalfigure"><a id="med_id00229a"></a><div class="mediaobject"><a id="med_id00229"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566516.png.jpg" alt="image with no caption" width="668" height="520"></div></div><p><span class="strong"><strong>Switches are smart</strong></span></p><p>There’s a big difference in how hubs and switches deal with signals. A switch can process signals as frames, and also understands MAC addresses. Instead of repeating incoming signals on all ports, a switch can store packets and forward them to their destinations.</p><p>Let’s take a closer look at this.</p></div></div></div><div class="sect1" title="Switches store MAC addresses in a lookup table to keep the frames flowing smoothly"><div class="titlepage"><div><div><h1 class="title"><a id="switches_store_mac_addresses_in_a_lookup"></a>Switches store MAC addresses in a lookup table to keep the frames flowing smoothly</h1></div></div></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><a id="iddle1149" class="indexterm"></a><a id="iddle1268" class="indexterm"></a><a id="iddle1720" class="indexterm"></a><a id="iddle1721" class="indexterm"></a><span class="strong"><strong>The source workstation sends a frame.</strong></span></p><p>A frame carries the payload of data and keeps track of the time sent, as well as the MAC address of the source and the MAC address of the target.</p></li><li class="listitem"><p><span class="strong"><strong>The switch updates its MAC address table with the MAC address and the port it’s on.</strong></span></p><p>Switches maintain MAC address tables. As frames come in, the switch’s knowledge of the traffic gets more descript. The switch matches ports with MAC addresses.</p><div class="informalfigure"><a id="med_id00230a"></a><div class="mediaobject"><a id="med_id00230"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566518.png" alt="image with no caption" width="691" height="673"></div></div></li><li class="listitem"><p><span class="strong"><strong>The switch forwards the frame to its target MAC address using information from its table.</strong></span></p><p>It does this by sending the frame out the port where that MAC address is located as the MAC address table indicates.</p></li></ol></div><div class="sidebar"><a id="be_the_switch"></a><p class="title">BE the Switch</p><p><a id="iddle1729" class="indexterm"></a>Your job is to play the switch and update the lookup table based on the frame information shown. Follow the arrows to match the Mac Address wth the port. We did the first one for you.</p><div class="informalfigure"><a id="med_id00231a"></a><div class="mediaobject"><a id="med_id00231"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566520.png.jpg" alt="image with no caption" width="719" height="355"></div></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>MAC address</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Port</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>00:0a:1e:55:6d:3b</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; ">&nbsp;</td><td style="">&nbsp;</td></tr></tbody></table></div></div><div class="sidebar"><a id="be_the_switch-id00074"></a><p class="title">BE the Switch</p><p><a id="iddle1344" class="indexterm"></a><a id="iddle1724" class="indexterm"></a>Your job is to play the switch and update the lookup table based on the frame information shown. Follow the arrows to match the Mac Address wth the port. We did the first one for you.</p><div class="informalfigure"><a id="med_id00232a"></a><div class="mediaobject"><a id="med_id00232"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566522.png.jpg" alt="image with no caption" width="719" height="356"></div></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>MAC address</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Port</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>00:0a:1e:55:6d:3b</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>00:23:3d:6c:4d:11</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>3</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>00:1c:21:7f:bb:23</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>4</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>00:6a:9f:31:55:3f</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>7</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>00:09:12:dd:34:5e</p></td><td style="" valign="top"><p>8</p></td></tr></tbody></table></div></div><div class="sidebar"><a id="fireside_chats-id00075"></a><p class="title">Fireside Chats</p><p>Tonight’s talk: <span class="strong"><strong>Hub vs. Switch</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Hub:</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Switch:</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Alright, Switch, I’m getting tired of you calling my intelligence into question.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Could you repeat that?</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>I’m getting tired of... are you making fun of me?</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Just a little joke on your other name.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>So they call me a repeater, so what?</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Well, that’s where all your problems lie. The fact that you repeat every little thing that comes into your ports on ALL of your other ports makes for a real slow network.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Okay, I repeat signals, other than that we’re pretty similar.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>No we’re not. You work in signals. I work in frames.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>I like power more than data. That’s why I work with electricity exclusively.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>I’m a computer. I have my own operating system.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Well, I connect computers together.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>But you don’t do it efficiently. You bombard all of your ports with unnecessary network traffic.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>I like to make sure that every device on the network gets a heads-up about traffic.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>But it’s all unnecessary noise. I send frames exactly where they need to go. I have built-in digital logic and can read information from frames and use it to send data accurately.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>But I’m cheaper. Can’t beat me at that can you?</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; ">&nbsp;</td><td style="" valign="top"><p>I’m worth every penny. Put just one of me in a network run entirely by you, and I can up the speed and the bandwidth of the network the minute someone turns me on.</p></td></tr></tbody></table></div></div></div><div class="sect1" title="The switch has the information..."><div class="titlepage"><div><div><h1 class="title"><a id="switch_has_the_informationhellip"></a>The switch has the information...</h1></div></div></div><p>Since the switch stores MAC addresses, we should be able to connect to the switch and look at its table.</p><p>Will this get us the information we need to find the mole?</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>Connect your computer to the switch with a serial cable.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch05note06"></a>Note</h3><p>Low end switches do not generally have serial ports on them.</p></div><p>You will use this to communicate with the switch.</p></li><li class="listitem"><p><span class="strong"><strong>Open a terminal program such as Hyperterminal, and get to the command prompt of the switch. Type in the commands below:</strong></span></p><div class="informalfigure"><a id="med_id00233a"></a><div class="mediaobject"><a id="med_id00233"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566524.png" alt="image with no caption" width="651" height="333"></div></div></li></ol></div><div class="note" title="Brain Power"><h3 class="title"><a id="ch05note07"></a>Brain Power</h3><p>How long do you think a switch keeps MAC addresses in its table?</p></div><div class="note" title="Watch it!"><h3 class="title"><a id="ch05note08"></a>Watch it!</h3><p><span class="strong"><strong>The command above was for a HP ProCurve Switch.</strong></span></p><p><span class="emphasis"><em>Other brands of switches may have slightly different commands to see the MAC address table.</em></span></p></div><div class="informalfigure"><a id="med_id00234a"></a><div class="mediaobject"><a id="med_id00234"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566526.png.jpg" alt="image with no caption" width="349" height="537"></div></div><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;<a id="iddle1214" class="indexterm"></a><a id="iddle1294" class="indexterm"></a><a id="iddle1728" class="indexterm"></a>So do you think the switches aren’t picking up the MAC address?</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;No, the problem is that the switches clear out those MAC address tables in about three minutes.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Clear them out?</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;Yea, if a network device stops transmitting, the switch just deletes the entry to keep the table size small.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;So where does that leave us with finding this rogue machine?</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;Well I’ve looked at all the PCs and did not find the rogue address.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;What’s next?</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;I think we need to capture the network traffic and look for traffic with that source MAC address. I can then get back into the switches to find that address and narrow it down to a port on a switch.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;That sounds like a good plan. How are you going to capture traffic?</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;I need to find some software...</p></div><div class="sect1" title="We can use software to monitor packets"><div class="titlepage"><div><div><h1 class="title"><a id="we_can_use_software_to_monitor_packets"></a>We can use software to monitor packets</h1></div></div></div><p><a id="iddle1292" class="indexterm"></a><a id="iddle1722" class="indexterm"></a><a id="iddle1833" class="indexterm"></a>If you need to monitor network traffic and capture packet information, there’s some great software out there that will do exactly what you need— software like Wireshark. To monitor traffic, you install the software on a workstation, and then plug the workstation into the network at the point you want to monitor. The software then gives you information about the packets that pass the workstation.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note09a"></a>Note</h3><p>Look in <a class="xref" href="apa.html" title="Appendix&nbsp;A.&nbsp;Leftovers: The Top Ten Things (we didn’t cover)">Appendix&nbsp;A</a> for more details about installing Wireshark.</p></div><div class="informalfigure"><a id="med_id00235a"></a><div class="mediaobject"><a id="med_id00235"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566528.png" alt="image with no caption" width="605" height="566"></div></div><p>Let’s use Wireshark to monitor traffic on the switch. That way we can pick up any more rogue signals the mole sends, and find out what network device sends them to the switch.</p></div><div class="sect1" title="Let’s hook Wireshark up to the switch"><div class="titlepage"><div><div><h1 class="title"><a id="letapostrophes_hook_wireshark_up_to_the"></a>Let’s hook Wireshark up to the switch</h1></div></div></div><p>So how do we get Wireshark to monitor network traffic going through the switch? Follow these instructions, and you’re sorted.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>Connect your computer to the switch with a serial cable.</strong></span></p><p>You will use this to communicate with the switch.</p></li><li class="listitem"><p><span class="strong"><strong>Open a terminal program such as Hyperterminal and get to the command prompt of the switch. Type in the commands below.</strong></span></p><div class="informalfigure"><a id="med_id00236a"></a><div class="mediaobject"><a id="med_id00236"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566530.png" alt="image with no caption" width="594" height="107"></div></div></li><li class="listitem"><p><span class="strong"><strong>Hook up your computer to port 1 on the switch with an Ethernet cable.</strong></span></p><p>You will use this to capture network traffic.</p><div class="informalfigure"><a id="med_id00237a"></a><div class="mediaobject"><a id="med_id00237"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566532.png.jpg" alt="image with no caption" width="349" height="116"></div></div></li><li class="listitem"><p><span class="strong"><strong>Startup Wireshark and capture some network traffic.</strong></span></p><div class="informalfigure"><a id="med_id00238a"></a><div class="mediaobject"><a id="med_id00238"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566534.png.jpg" alt="image with no caption" width="601" height="199"></div></div></li></ol></div><p><span class="strong"><strong>So what does Wireshark actually tell us?</strong></span></p></div><div class="sect1" title="Wireshark gives us traffic information"><div class="titlepage"><div><div><h1 class="title"><a id="wireshark_gives_us_traffic_information"></a>Wireshark gives us traffic information</h1></div></div></div><p><a id="iddle1101" class="indexterm"></a><a id="iddle1146" class="indexterm"></a><a id="iddle1364" class="indexterm"></a><a id="iddle1515" class="indexterm"></a><a id="iddle1871" class="indexterm"></a>Wireshark shows us all the network traffic that the computer is seeing from the switch it is connected to. We can filter the output and look for specific frames if we wish.</p><p>What would you like to use for a filter?</p><div class="informalfigure"><a id="med_id00239a"></a><div class="mediaobject"><a id="med_id00239"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566536.png" alt="image with no caption" width="842" height="535"></div></div><div class="note" title="Geek Bits"><h3 class="title"><a id="ch05note09"></a>Geek Bits</h3><p>Officially, Wireshark is known as a “Protocol Analyzer.”</p></div><div class="sidebar"><a id="sharpen_your_pencil-id00076"></a><p class="title">Sharpen your pencil</p><p>Below is a part of the packet information from Wireshark. Circle the device that sent this packet.</p><div class="informalfigure"><a id="med_id00240a"></a><div class="mediaobject"><a id="med_id00240"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566538.png" alt="image with no caption" width="674" height="693"></div></div></div><div class="sidebar"><a id="sharpen_your_pencil_solution-id00077"></a><p class="title">Sharpen your pencil Solution</p><p><a id="iddle1276" class="indexterm"></a><a id="iddle1579" class="indexterm"></a>Below is a part of the packet information from Wireshark. Circle the device that sent this packet.</p><div class="informalfigure"><a id="med_id00241a"></a><div class="mediaobject"><a id="med_id00241"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566540.png" alt="image with no caption" width="703" height="706"></div></div></div></div><div class="sect1" title="Routers have MAC addresses too"><div class="titlepage"><div><div><h1 class="title"><a id="routers_have_mac_addresses_too"></a>Routers have MAC addresses too</h1></div></div></div><p>If network traffic comes from a router, we can only see the router’s MAC address. All the workstations behind that router make up what we call an IP subnet. All a switch needs to look at to get frames to their destination is the MAC address. A router looks at the IP address from the incoming packet and forwards it if it is intended for a workstation located on the other network.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>The source workstation sends a frame to the router.</strong></span></p><p>It sends it to the router since the workstation the traffic is meant for is behind the router.</p><div class="informalfigure"><a id="med_id00242a"></a><div class="mediaobject"><a id="med_id00242"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566542.png" alt="image with no caption" width="733" height="576"></div></div></li><li class="listitem"><p><span class="strong"><strong>The router changes the source MAC address to its MAC address and changes the destination MAC address to the workstation the traffic is meant for.</strong></span></p></li></ol></div><div class="sidebar"><a id="routers_up_close"></a><p class="title">Routers Up Close</p><p>Routers are the high end networking devices of a network. They are the devices that connect the network together. The Internet is built using routers like this one.</p><p>Let’s take a look inside.</p><div class="informalfigure"><a id="med_id00243a"></a><div class="mediaobject"><a id="med_id00243"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566544.png.jpg" alt="image with no caption" width="704" height="465"></div></div><p><span class="strong"><strong>Routers are really smart</strong></span></p><p>They have to be smart because they use IP addresses to move traffic around a network. This takes some processor horsepower to accomplish.</p><p>Also, routers have far less network ports because they tend to connect to other routers or to switches. Computers are generally not connected directly to a router.</p><div class="note" title="Relax"><h3 class="title"><a id="ch05note10"></a>Relax</h3><p><span class="strong"><strong>We will be covering much more on routers in the next two chapters.</strong></span></p></div></div></div><div class="sect1" title="We’re closing in!"><div class="titlepage"><div><div><h1 class="title"><a id="weapostrophere_closing_inexclamation_mar"></a>We’re closing in!</h1></div></div></div><p><a id="iddle1343" class="indexterm"></a><a id="iddle1617" class="indexterm"></a>We’ve isolated the rogue packets to a small part of our network behind a router. So how do we find the mole?</p><div class="informalfigure"><a id="med_id00244a"></a><div class="mediaobject"><a id="med_id00244"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566546.png" alt="image with no caption" width="664" height="619"></div></div><div class="sidebar"><a id="exercise-id00078"></a><p class="title">Exercise</p><p>Write down your next step(s) to find the workstation that the rogue packets are coming from.</p><p>__________________________________________________________________________</p><p>__________________________________________________________________________</p><p>__________________________________________________________________________</p></div><div class="sidebar"><a id="exercise_solution-id00079"></a><p class="title">Exercise Solution</p><p><a id="iddle1626" class="indexterm"></a>Write down your next step(s) to find the workstation that the rogue packets are coming from.</p><p><span class="underline">Connect to the switch that is behind the router and look for the rogue MAC address in its MAC address table. It will tell us the port that the rogue is connected to and lead us to the mole’s location.</span></p></div><div class="informalfigure"><a id="med_id00245a"></a><div class="mediaobject"><a id="med_id00245"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566548.png.jpg" alt="image with no caption" width="1000" height="604"></div></div></div><div class="sect1" title="You’ve found the mole!"><div class="titlepage"><div><div><h1 class="title"><a id="youapostropheve_found_the_moleexclamatio"></a>You’ve found the mole!</h1></div></div></div><p>Thanks to your networking skills, we’ve found the mole. He’s connecting a laptop to a switch that’s sitting behind the router. Well done!</p></div></div></div></div><link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/core.css" crossorigin="anonymous"></div></div></section>
</div>

