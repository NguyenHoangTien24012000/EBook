<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
</style>
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><section class="chapter" title="Chapter&nbsp;9.&nbsp;Iterating and Testing: The Software is Still for the Customer" epub:type="chapter" id="iterating_and_testing_the_software_is_st"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;9.&nbsp;Iterating and Testing: The Software is Still for the Customer</h2></div></div></div><div class="informalfigure"><a id="med_id00588a"></a><div class="mediaobject"><a id="med_id00588"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069862.png.jpg" alt="image with no caption" width="733" height="529"></div></div><p><span class="strong"><strong>It’s time to show the customer how much you really care.</strong></span> Nagging bosses? Worried clients? Stakeholders that keep asking, “Will it be done on time?” No amount of well-designed code will please your customers; you’ve got to <span class="strong"><strong>show them something working</strong></span>. And now that you’ve got a solid OO programming toolkit, it’s time to learn how you can <span class="strong"><strong>prove to the customer</strong></span> that your software works. In this chapter, we learn about two ways to <span class="strong"><strong>dive deeper</strong></span> into your software’s functionality, and give the customer that warm feeling in their chest that makes them say, <span class="strong"><strong><span class="emphasis"><em>Yes, you’re definitely the right developer for this job!</em></span></strong></span></p><div class="sect1" title="Your toolbox is filling up"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="your_toolbox_is_filling_up">Your toolbox is filling up</h2></div></div></div><p>We’ve learned quite a bit so far, and our toolbox of analysis and design tools is getting pretty full. We even added some OO programming techniques in the last chapter:</p><div class="informalfigure"><a id="med_id00589a"></a><div class="mediaobject"><a id="med_id00589"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069864.png.jpg" alt="image with no caption" width="276" height="411"></div></div><div class="informalfigure"><a id="med_id00590a"></a><div class="mediaobject"><a id="med_id00590"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069866.png.jpg" alt="image with no caption" width="331" height="283"></div></div><div class="informalfigure"><a id="med_id00591a"></a><div class="mediaobject"><a id="med_id00591"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069868.png.jpg" alt="image with no caption" width="577" height="648"></div></div><div class="informalfigure"><a id="med_id00592a"></a><div class="mediaobject"><a id="med_id00592"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069870.png.jpg" alt="image with no caption" width="350" height="395"></div></div><div class="informalfigure"><a id="med_id00593a"></a><div class="mediaobject"><a id="med_id00593"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069872.png.jpg" alt="image with no caption" width="508" height="682"></div></div></div><div class="sect1" title="But you’re still writing your software for the CUSTOMER!"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="but_youapostrophere_still_writing_your_s">But you’re still writing your software for the <span class="underline">CUSTOMER</span>!</h2></div></div></div><p><span class="strong"><strong>All the tools and techniques you’ve been learning are terrific... but none of them matter if you don’t use them to produce great software that makes your customer happy.</strong></span></p><p><span class="strong"><strong>And most of the time, your customer won’t care about all the OO principles and diagrams you create. They just want the software to work the way that it’s supposed to.</strong></span></p><div class="informalfigure"><a id="med_id00594a"></a><div class="mediaobject"><a id="med_id00594"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069874.png.jpg" alt="image with no caption" width="453" height="454"></div></div><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Yeah, maybe we shouldn’t have spent all this time on so many diagrams, and all this architecture stuff. We’ve got nothing to show Gary except a bunch of ovals with things like “Play Game” written inside them.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Come on guys, we’ve got a lot more done than that. It’s going to be simple to finish up the Board class, because we’ve already got a start on writing a lot of that functionality.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;Well, sure, but that’s the only class we’ve written any code for. How are we supposed to show <span class="emphasis"><em>that</em></span> to Gary?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Well, I guess we could write the Unit class pretty easily, since we did that class diagram. So it wouldn’t take a lot more time to write the code for that class.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Exactly. And, really, we know how to write all of these classes. We can just take each class, or even an entire package, and apply all those OO principles and analysis and design techniques to each chunk of functionality.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;But we’ve got to work on functionality now. We don’t have time for a bunch more big-picture analysis and design.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;But that’s just the thing, Jill: we don’t need to change what we’re doing, we just need to iterate deeper.</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Iterate deeper? What does that mean?</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;It just means we keep doing analysis and design, but now on each individual part of Gary’s game system framework.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;And as we build up the application, we’ll have lots of pieces working that we can show to Gary, right?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;And we get to use all these tools we’ve got to make sure the software is well-designed, too, right?</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Exactly. But first, we’ve got a choice to make...</p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>You write great software <span class="underline">iteratively</span>.</strong></span></p><p><span class="strong"><strong>Work on the <span class="underline">big</span> <span class="underline">picture</span>, and then <span class="underline">iterate</span> over <span class="underline">pieces</span> of the app until it’s <span class="underline">complete</span>.</strong></span></p></blockquote></div></div><div class="sect1" title="Iterating deeper: two basic choices"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="iterating_deeper_two_basic_choices">Iterating deeper: two basic choices</h2></div></div></div><p><a id="iddle1265" class="indexterm"></a><a id="iddle1848" class="indexterm"></a>When it comes to developing software, there is more than one way to iterate into specific parts of your application. You’ve got to take on smaller pieces of functionality, but there are two basic approaches to figuring out which small pieces to work on—and even what a “small piece” means in terms of your application.</p><p><span class="strong"><strong>You can choose to focus on <span class="underline">specific</span> <span class="underline">features</span> of the application. This approach is all about taking <span class="underline">one</span> <span class="underline">piece</span> <span class="underline">of</span> <span class="underline">functionality</span> that the customer wants, and working on that functionality until it’s complete.</strong></span></p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Both approaches to iterating are driven by <span class="underline">good</span> <span class="underline">requirements</span>.</strong></span></p></blockquote></div><div class="note" title="Feature Ahead"><h3 class="title"><a id="ch09note01"></a>Feature Ahead</h3><div class="informalfigure"><a id="med_id00595a"></a><div class="mediaobject"><a id="med_id00595"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069876.png.jpg" alt="image with no caption" width="115" height="114"></div></div><p><span class="strong"><strong><span class="emphasis"><em>Feature driven development</em></span></strong></span></p><p><span class="emphasis"><em>...is when you pick a specific feature in your app, and plan, analyze, and develop that feature to completion.</em></span></p></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Because requirements come from the customer, both approaches focus on delivering what the <span class="underline">customer</span> <span class="underline">wants</span>.</strong></span></p></blockquote></div><p><span class="strong"><strong>You can also choose to focus on <span class="underline">specific</span> <span class="underline">flows</span> through the application. This approach takes a <span class="underline">complete</span> <span class="underline">path</span> through the application, with a <span class="underline">clear</span> <span class="underline">start</span> <span class="underline">and</span> <span class="underline">end</span>, and implements that path in your code.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note02"></a>Note</h3><div class="informalfigure"><a id="med_id00596a"></a><div class="mediaobject"><a id="med_id00596"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069878.png.jpg" alt="image with no caption" width="112" height="112"></div></div><p><span class="strong"><strong><span class="emphasis"><em>Use case driven development</em></span></strong></span></p><p><span class="emphasis"><em>...is when you pick a scenario through a use case, and write code to support that complete <span class="underline">scenario</span> through the use case.</em></span></p><div class="blockquote"><blockquote class="blockquote"><p>You’ll often see the terms “flow” and “scenario” used interchangeably.</p></blockquote></div></div></div><div class="sect1" title="Feature driven development"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="feature_driven_development">Feature driven development</h2></div></div></div><p><a id="iddle1266" class="indexterm"></a>When you’re using <span class="strong"><strong>feature driven development</strong></span>, you work on a single feature at a time, and then iterate, knocking off features one at a time until you’ve finished up the functionality of an application.</p><div class="informalfigure"><a id="med_id00597a"></a><div class="mediaobject"><a id="med_id00597"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069880.png.jpg" alt="image with no caption" width="556" height="523"></div></div><div class="informalfigure"><a id="med_id00598a"></a><div class="mediaobject"><a id="med_id00598"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069882.png.jpg" alt="image with no caption" width="677" height="297"></div></div></div><div class="sect1" title="Use case driven development"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="use_case_driven_development">Use case driven development</h2></div></div></div><p><a id="iddle1849" class="indexterm"></a>With <span class="strong"><strong>use case driven development</strong></span>, you work on completing a single scenario through a use case. Then you take another scenario and work through it, until all of the use case’s scenarios are complete. Then you iterate to the next use case, until all your use cases are working.</p><div class="informalfigure"><a id="med_id00599a"></a><div class="mediaobject"><a id="med_id00599"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069884.png.jpg" alt="image with no caption" width="682" height="470"></div></div><div class="informalfigure"><a id="med_id00600a"></a><div class="mediaobject"><a id="med_id00600"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069886.png.jpg" alt="image with no caption" width="825" height="396"></div></div></div><div class="sect1" title="Two approaches to development"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="two_approaches_to_development">Two approaches to development</h2></div></div></div><p><a id="iddle1270" class="indexterm"></a><a id="iddle1852" class="indexterm"></a>There’s just one basic way to write code, isn’t there? Well, there are actually a ton of different ways to go about iterating deeper and finishing up parts of your application. Most of these different approaches fall into the two basic categories we’ve been looking at, though. So how do you decide which to use?</p><div class="sect2" title="What’s the difference between feature driven and use case driven development?"><div class="titlepage"><div><div><h3 class="title" id="whatapostrophes_the_difference_between_f">What’s the difference between feature driven and use case driven development?</h3></div></div></div><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Feature driven development is more granular</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Use case driven development is more “big picture”</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00044"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069888.png.jpg" alt="" width="297" height="143"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00045"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069890.png.jpg" alt="" width="369" height="169"></span></p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Works well when you have a lot of different features that don’t interconnect a whole lot.</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Works well when your app has lots of processes and scenarios rather than individual pieces of functionality.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Allows you to show the customer working code faster.</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Allows you to show the customer bigger pieces of functionality at each stage of development.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Is very functionality-driven. You’re not going to forget about any features using feature driven development.</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Is very user-centric. You’ll code for all the different ways a user can use your system with use case driven development.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>Works particularly well on transactional systems, where the system is largely defined by lengthy, complicated processes.</p></td><td style="vertical-align: top; "><p>Works particularly well on systems with lots of disconnected pieces of functionality.</p></td></tr></tbody></table></div><div class="sidebar"><a id="name_that_approachexclamation_mark"></a><div class="sidebar-title">Name That Approach!</div><p>Welcome to <a class="xref" href="ch09.html#name_that_approachexclamation_mark" title="Name That Approach!">Name That Approach!</a> Below are several statements, and each one is about a particular approach to iterating over parts of your system. Your job is to figure out which approach each statement refers to. Note that sometimes, a statement might apply to both approaches.</p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Use Case Driven</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Feature Driven</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>This approach deals with really small pieces of your application at a time.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00046"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00047"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>This approach lets you focus on just a part of your application at a time.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00048"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00049"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>This approach is all about a complete process in your application.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00050"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00051"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Using this approach, you can always test to see if you’ve completed the part of the application you’re working on.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00052"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00053"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>When you use this approach, your focus is on a diagram, not a list.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00054"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td><td style="vertical-align: top; "><p><span class="inlinemediaobject"><a id="inline_id00055"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr></tbody></table></div></div><div class="sidebar"><a id="name_that_approachexclamation_mark_exerc"></a><div class="sidebar-title">Name That Approach!: Exercise Solutions</div><p>Welcome to <a class="xref" href="ch09.html#name_that_approachexclamation_mark" title="Name That Approach!">Name That Approach!</a> Below are several statements, and each one is about a particular approach to iterating over parts of your system. Your job is to figure out which approach each statement refers to. Note that sometimes, a statement might apply to both approaches.</p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Use Case Driven</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Feature Driven</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>This approach deals with really small pieces of your application at a time.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00056"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00057"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069894.png.jpg" alt="" width="44" height="34"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>This approach lets you focus on just a part of your application at a time.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00058"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069896.png.jpg" alt="" width="53" height="52"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00059"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069898.png.jpg" alt="" width="47" height="41"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>This approach is all about a complete process in your application.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00060"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069900.png.jpg" alt="" width="45" height="57"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00061"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Using this approach, you can always test to see if you’ve completed the part of the application you’re working on.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00062"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069902.png.jpg" alt="" width="42" height="43"></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00063"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069904.png.jpg" alt="" width="47" height="41"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>When you use this approach, your focus is on a diagram, not a list.</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00064"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069906.png.jpg" alt="" width="35" height="46"></span></p></td><td style="vertical-align: top; "><p><span class="inlinemediaobject"><a id="inline_id00065"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069892.png.jpg" alt="" width="23" height="23"></span></p></td></tr></tbody></table></div></div></div></div><div class="sect1" title="Let’s use feature driven development"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_use_feature_driven_develo">Let’s use feature driven development</h2></div></div></div><p><a id="iddle1267" class="indexterm"></a>Since Gary’s losing patience, let’s go with feature driven development. We can take just a single feature and work it through to completion, and it shouldn’t take as much time as it would to write the code to support an entire use case.</p><p>Anytime you’ve got a customer impatient to see results, you should consider feature driven development, and starting with a feature you’ve already done some work on.</p><div class="informalfigure"><a id="med_id00601a"></a><div class="mediaobject"><a id="med_id00601"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069908.png.jpg" alt="image with no caption" width="749" height="556"></div></div><div class="note" title="Brain Power"><h3 class="title"><a id="ch09note05"></a>Brain Power</h3><p>If you decided to go with use case driven development, what would you start working on first?</p></div></div><div class="sect1" title="Analysis of a feature"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="analysis_of_a_feature">Analysis of a feature</h2></div></div></div><p><a id="iddle1264" class="indexterm"></a>Once you’ve decided on a feature to start with, you’ve got to do some more analysis. Let’s start with what we had written down on the feature list:</p><div class="sect2" title="3. The framework supports multiple types of troops or units that are game-specific"><div class="titlepage"><div><div><h3 class="title" id="threedot_the_framework_supports_multiple">3. The framework supports multiple types of troops or units that are game-specific</h3></div></div></div><div class="note" title="Note"><h3 class="title"><a id="ch09note06"></a>Note</h3><p>Here’s what we’ve got so far... but this is still a pretty generic description of what we need to code.</p></div><p>We also have the start of a class diagram, from <a class="xref" href="ch07.html" title="Chapter&nbsp;7.&nbsp;Architecture: Bringing Order to Chaos">Chapter&nbsp;7</a>:</p><div class="informalfigure"><a id="med_id00602a"></a><div class="mediaobject"><a id="med_id00602"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069910.png.jpg" alt="image with no caption" width="445" height="185"></div></div><p>It looks like we’ve got everything we need to start coding, right? To help us make sure we haven’t forgotten anything, let’s go back to using some textual analysis.</p><p>We don’t have a use case to analyze, but we can revisit the vision statement for Gary’s games, and see if we’re covering everything that Gary wanted his units to do.</p><div class="sidebar"><a id="garyapostrophes_games_vision_sta-id00136"></a><div class="sidebar-title">Gary’s Games Vision Statement</div><p>Gary’s Games provides frameworks that game designers can use to create turn-based strategy games. Unlike arcade-style shoot-’em-up games and games that rely on audio and video features to engage the player, our games will focus on the technical details of strategy and tactics. Our framework provides the bookkeeping details to make building a particular game easy, while removing the burden of coding repetitive tasks from the game design.</p><div class="note" title="Note"><h3 class="title"><a id="ch09note07"></a>Note</h3><p>Here’s Gary’s vision statement, from way back in <a class="xref" href="ch06.html" title="Chapter&nbsp;6.&nbsp;Solving Really Big Problems: “My Name is Art Vandelay... I am an Architect”">Chapter&nbsp;6</a>.</p></div><p>The game system framework (GSF) will provide the core of all of Gary’s Games. It will be delivered as a library of classes with a well-defined API that should be usable by all board game development project teams within the company. The framework will provide standard capabilities for:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Defining and representing a board configuration</p></li><li class="listitem"><p>Defining units and configuring armies or other fighting units</p></li><li class="listitem"><p>Moving units on the board</p></li><li class="listitem"><p>Determining legal moves</p></li><li class="listitem"><p>Conducting battles</p></li><li class="listitem"><p>Providing unit information</p></li></ul></div><p>The GSF will simplify the task of developing a turn-based strategic board game so that the users of the GSF can devote their time to implementing the actual games.</p><div class="informalfigure"><a id="med_id00603a"></a><div class="mediaobject"><a id="med_id00603"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069912.png.jpg" alt="image with no caption" width="96" height="70"></div></div></div><p><span class="strong"><strong>Compare the class diagram for Unit with this vision statement. Are there things missing from our class diagram?</strong></span></p><p><span class="strong"><strong>What else might Gary expect to see when you say, “I’m done with writing code for the units in your framework?”</strong></span></p></div></div><div class="sect1" title="Fleshing out the Unit class"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="fleshing_out_the_unit_class">Fleshing out the Unit class</h2></div></div></div><p><a id="iddle1830" class="indexterm"></a>In our class diagram, all we’ve really figured out is how to represent the properties of a unit. But in Gary’s vision statement, he’s expecting his game system framework to support a lot more than just those game-specific properties.</p><div class="note" title="Note"><h3 class="title"><a id="ch09note08"></a>Note</h3><p>This makes sense, because the key feature we were focusing on in <a class="xref" href="ch07.html" title="Chapter&nbsp;7.&nbsp;Architecture: Bringing Order to Chaos">Chapter&nbsp;7</a> was not the entire Unit class, but just game-specific properties of a Unit.</p></div><p>Here are the things we came up with that Gary is expecting units in his framework to do:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="strong"><strong>Each unit should have properties, and game designers can add new properties to unit types in their own games.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note09"></a>Note</h3><p>Our class diagram is focused on this particular aspect of the Unit class right now.</p></div></li><li class="listitem"><p><span class="strong"><strong>Units have to be able to move from one tile on a board to another.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note10"></a>Note</h3><p>You should have some ideas about how to handle this from our work on a related key feature back in <a class="xref" href="ch07.html" title="Chapter&nbsp;7.&nbsp;Architecture: Bringing Order to Chaos">Chapter&nbsp;7</a>.</p></div></li><li class="listitem"><p><span class="strong"><strong>Units can be grouped together into armies.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note11"></a>Note</h3><p>These new features are all pulled straight from Gary’s vision statement.</p></div></li></ol></div><div class="informalfigure"><a id="med_id00604a"></a><div class="mediaobject"><a id="med_id00604"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069914.png.jpg" alt="image with no caption" width="502" height="413"></div></div></div><div class="sect1" title="Showing off the Unit class"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="showing_off_the_unit_class">Showing off the Unit class</h2></div></div></div><div class="informalfigure"><a id="med_id00605a"></a><div class="mediaobject"><a id="med_id00605"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><p>We worked on supporting game-specific units, and how to store the properties of a <span class="strong"><strong><code class="literal">Unit</code></strong></span>, back in <a class="xref" href="ch07.html" title="Chapter&nbsp;7.&nbsp;Architecture: Bringing Order to Chaos">Chapter&nbsp;7</a>. But Gary wants more than a class diagram before he’s convinced you’re getting any work done.</p><div class="informalfigure"><a id="med_id00606a"></a><div class="mediaobject"><a id="med_id00606"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069918.png.jpg" alt="image with no caption" width="510" height="213"></div></div><div class="informalfigure"><a id="med_id00607a"></a><div class="mediaobject"><a id="med_id00607"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069920.png.jpg" alt="image with no caption" width="548" height="471"></div></div><p><span class="strong"><strong>Your customers want to see something that makes sense to <span class="underline">them</span></strong></span></p><p>Your customers are used to seeing computer programs run on a computer. All those diagrams and lists may help you get on the same page with them in terms of requirements and what you’re supposed to build, but you’re going to need more than that before they think you’ve built anything useful.</p><p>You need to come up with some test scenarios that you can show to your customer, which will prove that your code works, and that it behaves like your customer expects it to.</p></div><div class="sect1" title="Writing test scenarios"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="writing_test_scenarios">Writing test scenarios</h2></div></div></div><div class="note" title="Note"><h3 class="title"><a id="ch09note13"></a>Note</h3><p><a id="iddle1062" class="indexterm"></a><a id="iddle1746" class="indexterm"></a><a id="iddle1834" class="indexterm"></a>Be careful... this “scenario” isn’t the same as the “scenario” we’ve been talking about in a use case scenario.</p></div><p>Test cases don’t have to be very complex; they just provide a way to show your customer that the functionality in your classes is working correctly.</p><p>For the properties of a unit, we can start out with a simple test scenario that creates a new <span class="strong"><strong><code class="literal">Unit</code></strong></span>, and adds a property to the unit. We could just show our customer a running program that displays output like this:</p><div class="informalfigure"><a id="med_id00608a"></a><div class="mediaobject"><a id="med_id00608"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069922.png.jpg" alt="image with no caption" width="755" height="337"></div></div><div class="sidebar"><a id="be_the_customer"></a><div class="sidebar-title">BE the Customer</div><p><span class="strong"><strong>We’ve already got one test scenario. It’s your job to play Gary, and think of two more test scenarios that we can use to prove that the Unit class is working like it should. Write the output of each scenario in the code windows on the right.</strong></span></p><div class="informalfigure"><a id="med_id00609a"></a><div class="mediaobject"><a id="med_id00609"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069924.png.jpg" alt="image with no caption" width="431" height="448"></div></div></div><div class="sidebar"><a id="be_the_customer_solutions"></a><div class="sidebar-title">BE the Customer Solutions</div><p><a id="iddle1063" class="indexterm"></a><span class="strong"><strong>Your job was to think of two more test scenarios that we can use to prove that the Unit class is working like it should. Here are the two scenarios we came up with:</strong></span></p><div class="informalfigure"><a id="med_id00610a"></a><div class="mediaobject"><a id="med_id00610"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="informalfigure"><a id="med_id00611a"></a><div class="mediaobject"><a id="med_id00611"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069926.png.jpg" alt="image with no caption" width="372" height="283"></div></div></div><div class="sect2" title="Scenario #2: Changing property values"><div class="titlepage"><div><div><h3 class="title" id="scenario_hash2_changing_property_values"><span class="underline">Scenario #2</span>: <span class="underline">Changing property values</span></h3></div></div></div><p>We decided to test setting, and then changing, the value of a property. If the <span class="strong"><strong><code class="literal">hitPoints</code></strong></span> property is set, for example, and then set again, getting the value of <span class="strong"><strong><code class="literal">hitPoints</code></strong></span> should return the most recent value for that property:</p><div class="informalfigure"><a id="med_id00612a"></a><div class="mediaobject"><a id="med_id00612"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069928.png.jpg" alt="image with no caption" width="736" height="472"></div></div></div><div class="sect2" title="Scenario #3: Getting non-existent property values"><div class="titlepage"><div><div><h3 class="title" id="scenario_hash3_getting_non-existent_prop"><span class="underline">Scenario #3</span>: <span class="underline">Getting non-existent property values</span></h3></div></div></div><p>For our third scenario, we decided to test what would happen when you tried to retrieve the value of a property that had never been set. Error conditions like this crop up all the time, and we don’t want our program crashing every time a game designer makes a small typo or mistake in their code. Here’s what we did to test this:</p><div class="informalfigure"><a id="med_id00613a"></a><div class="mediaobject"><a id="med_id00613"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069930.png.jpg" alt="image with no caption" width="805" height="471"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>You should test your software for <span class="underline">every</span> <span class="underline">possible</span> <span class="underline">usage</span> you can think of. <span class="underline">Be</span> <span class="underline">creative</span>!</strong></span></p><p><span class="strong"><strong>Don’t forget to test for <span class="underline">incorrect</span> <span class="underline">usage</span> of the software, too. You’ll <span class="underline">catch</span> <span class="underline">errors</span> <span class="underline">early</span>, and make your customers very happy.</strong></span></p></blockquote></div><div class="informalfigure"><a id="med_id00614a"></a><div class="mediaobject"><a id="med_id00614"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00137"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe1"></a><a id="ch09qa1q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1741" class="indexterm"></a><a id="iddle1804" class="indexterm"></a><span class="strong"><strong>Q: We don’t have any code written yet. Aren’t we doing things a bit backwards by worrying about tests right now?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Not at all. In fact, if you know what tests you’re going to use before you write your code, it’s easy to figure out what code you’re going to need to pass those tests. With the three test scenarios we just developed, it should be pretty simple to write the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class, and the tests tell us exactly how our code should behave.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe2"></a><a id="ch09qa1q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Isn’t this just test driven development?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> For the most part, yes. Formally, test driven development focuses on automated tests, and usually involves a testing framework like JUnit. But the idea of writing test cases, and then writing the code that will pass the test, is the core idea behind test driven development.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe3"></a><a id="ch09qa1q3"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: So are we using test driven development or feature driven development? I’m confused...</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q3a3"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Both. In fact, most good software analysis and design mixes lots of different approaches. You might start with a use case (use case driven development), and then choose just a small feature in that use case to start working on (which is really a form of feature driven development). Finally, you might use tests to figure out how to implement that feature (feature driven development).</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe4"></a><a id="ch09qa1q4"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Why are the tests so simple? I expected something a little fancier.</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q4a4"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> You want to keep your tests simple, and have them test just a small piece of functionality at a time. If you start testing multiple things at once, it’s hard to tell what might have caused a particular test to fail. You may need a lot more tests, but keep each one focused on a very specific piece of functionality.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe5"></a><a id="ch09qa1q5"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: And each test makes sure a single method in the class works correctly, right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q5a5"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> No, each test really focuses on a single piece of <span class="emphasis"><em>functionality</em></span>. That might involve one method, or several methods. For example, you can’t test setting a property’s value (which uses <span class="strong"><strong><code class="literal">setProperty()</code></strong></span>) without getting that property’s value as well (using <span class="strong"><strong><code class="literal">getProperty()</code></strong></span>). So it’s one piece of functionality—setting a property—but it takes two methods.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe6"></a><a id="ch09qa1q6"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Can you explain why you tested getting a property that you didn’t set? Isn’t that testing the wrong way to use the Unit class?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q6a6"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Testing incorrect usage of your software is usually at least as important as testing it when it’s used properly. Game designers could easily mistype a property name, or write code that expects some other piece of a game to set a property and asks for a property that doesn’t exist. It’s your job to know what will happen in these situations.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1qe7"></a><a id="ch09qa1q7"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Now that we’ve got our tests planned out, we can finally start coding the Unit class, right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa1q7a7"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Well, there’s one more bit of design we need to think about first...</p></td></tr></tbody></table></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Test driven development focuses on getting the behavior of your classes right.</strong></span></p></blockquote></div></div><div class="informalfigure"><a id="med_id00615a"></a><div class="mediaobject"><a id="med_id00615"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069932.png.jpg" alt="image with no caption" width="472" height="521"></div></div><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;<a id="iddle1113" class="indexterm"></a><a id="iddle1831" class="indexterm"></a>What do you mean? We figured out that all properties in a Unit have a name and a value. So we decided to use a Map to store them all.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;And game designers can add any new properties they want by just creating new property names, and sticking name/value pairs in the Map with the setProperty() method.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;Right. But then, we also added a type property, since all units will have a type. And that’s something common for all units...</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Sure. See, we did do the commonality analysis right.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;...but we also now know that units can be assembled into groups, like armies or fleets or whatever. So what happens if we have two units of the same type in the same group... how can we tell the difference between them?</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;You think we need some sort of ID, don’t you?</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;Yeah, maybe. Or at least a name... but even then, you can’t really prevent duplication with a name property, can you?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;OK, but that still doesn’t mean we need to change our design. We can just add the ID property into our property Map. So we’ve got a nice, uniform way to access all those properties, using the getProperty() method.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;He’s right, Jill. And since we encapsulate away the details about property names into the properties Map, we could even change from using an ID to a name, or something totally different, and code using the Unit class wouldn’t have to change much... you’d just need to use the new property name in getProperty(). That’s a pretty slick design!</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;But what about commonality? If ID is really common to all types of Unit, shouldn’t it be moved out of the Map, sort of like we did with the type property?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Whoa... encapsulation <span class="emphasis"><em>or</em></span> commonality. That’s tough... it seems like we can’t do one without screwing up the other.</p><div class="informalfigure"><a id="med_id00616a"></a><div class="mediaobject"><a id="med_id00616"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069934.png.jpg" alt="image with no caption" width="247" height="289"></div></div><div class="sidebar"><a id="sharpen_your_pencil-id00138"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1658" class="indexterm"></a><a id="iddle1891" class="indexterm"></a>Refine your commonality analysis.</p><p>Before we close the book on dealing with Unit properties, there are a few things you still need to think through. Below are several properties that different units might have, and two sheets of paper. Write down on the Commonality sheet the properties that you think all units, regardless of their type, would have; on the Variability sheet, write down properties you think only specific types of units might have.</p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"><col class="c3"><col class="c4"></colgroup><thead><tr><td style="vertical-align: top; border-bottom: 0.5pt solid ; " colspan="4"><p><span class="underline">Potential Unit Properties</span></p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>name</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>weapon</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>allegiance</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>gear</strong></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>type</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>hitPoints</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>wingspan</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>lastName</strong></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>strength</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>weight</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>landSpeed</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>id</strong></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>speed</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>intelligence</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>experience</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>groundSpeed</strong></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="strong"><strong>stamina</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="strong"><strong>firstName</strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="strong"><strong>weapons</strong></span></p></td><td style="vertical-align: top; "><p><span class="strong"><strong>hunger</strong></span></p></td></tr></tbody></table></div><div class="informalfigure"><a id="med_id00617a"></a><div class="mediaobject"><a id="med_id00617"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069936.png.jpg" alt="image with no caption" width="700" height="494"></div></div><p>Now update the Unit class diagram.</p><p>With the details from your revised commonality analysis in <a class="xref" href="ch09.html#sharpen_your_pencil-id00138" title="Sharpen your pencil">Sharpen your pencil</a>, you (might) need to update the Unit class diagram, shown below. Make any changes that might improve the design of the Unit class below, and add notes to remind yourself what the purpose of any additions you’ve made are going to be used for.</p><div class="informalfigure"><a id="med_id00618a"></a><div class="mediaobject"><a id="med_id00618"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069938.png.jpg" alt="image with no caption" width="632" height="528"></div></div></div><div class="informalfigure"><a id="med_id00619a"></a><div class="mediaobject"><a id="med_id00619"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="sharpen_your_pencil_answers-id00139"></a><div class="sidebar-title">Sharpen your pencil answers</div><p><a id="iddle1659" class="indexterm"></a><a id="iddle1892" class="indexterm"></a>Refine your commonality analysis.</p><p>In <a class="xref" href="ch09.html#sharpen_your_pencil-id00138" title="Sharpen your pencil">Sharpen your pencil</a>, we showed you several properties that different units might have. Your job was to write down on the Commonality sheet the properties that you think all units, regardless of their type, would have; on the Variability sheet, you should have written down properties you think only specific types of units might have.</p><div class="informalfigure"><a id="med_id00620a"></a><div class="mediaobject"><a id="med_id00620"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069940.png.jpg" alt="image with no caption" width="735" height="487"></div></div><div class="note" title="Relax"><h3 class="title"><a id="ch09note17"></a>Relax</h3><p><span class="strong"><strong>You may have a different idea about what makes a good game.</strong></span></p><p>You might have played different games than we have, and come up with different common properties. That’s OK—just focus on <span class="emphasis"><em>how</em></span> and <span class="emphasis"><em>why</em></span> you made your own decisions. We’re going to use our choices in the rest of the chapter, so you should be comfortable with how we made our choices, too.</p></div></div><div class="informalfigure"><a id="med_id00621a"></a><div class="mediaobject"><a id="med_id00621"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069942.png.jpg" alt="image with no caption" width="697" height="524"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00140"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa2qe1"></a><a id="ch09qa2q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1763" class="indexterm"></a><a id="iddle1893" class="indexterm"></a><span class="strong"><strong>Q: I didn’t have anything on the Commonality list except for “type”. Where did I go wrong?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa2q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> You didn’t go wrong at all. Analysis and design are all about making choices, and sometimes you’re going to make a different choice than another programmer. There’s nothing wrong with that, as long as you have good, well thought out reasons for the decision you made.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa2qe2"></a><a id="ch09qa2q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: But won’t different choices at least result in different code and design implementations?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa2q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Yes, they sure will. But OOA&amp;D, and software development, aren’t about making a particular decision, since many times there isn’t an exactly “right” or exactly “wrong” choice. They’re about writing well-designed software, and that can happen in a lot of different ways.</p><p>In fact, even if two programmers made the <span class="emphasis"><em>same</em></span> decision about commonality and variability in this exercise, it can lead to totally different design decisions when it comes to actually writing your classes. Let’s assume for a moment that two developers both came up with the answers for commonality and variability shown here, and then tried to revise the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class to reflect what they figured out...</p></td></tr></tbody></table></div></blockquote></div></div><div class="informalfigure"><a id="med_id00622a"></a><div class="mediaobject"><a id="med_id00622"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div></div></div><div class="sect1" title="Solution #1: Emphasizing Commonality"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="solution_hash1_emphasizing_commonality">Solution #1: Emphasizing Commonality</h2></div></div></div><div class="informalfigure"><a id="med_id00623a"></a><div class="mediaobject"><a id="med_id00623"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069944.png.jpg" alt="image with no caption" width="425" height="548"></div></div><div class="informalfigure"><a id="med_id00624a"></a><div class="mediaobject"><a id="med_id00624"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069946.png.jpg" alt="image with no caption" width="441" height="428"></div></div><p><a id="iddle1115" class="indexterm"></a>In this solution, all game designers can directly access the <span class="strong"><strong><code class="literal">id</code></strong></span>, <span class="strong"><strong><code class="literal">name</code></strong></span>, and <span class="strong"><strong><code class="literal">weapons</code></strong></span> properties, instead of having to use <span class="strong"><strong><code class="literal">getProperty()</code></strong></span> and work through the more generic properties <span class="strong"><strong><code class="literal">Map</code></strong></span>.</p><p>The emphasis is on keeping the <span class="strong"><strong><span class="emphasis"><em><span class="underline">common</span></em></span></strong></span> properties of a <span class="strong"><strong><code class="literal">Unit</code> <span class="underline">outside</span></strong></span> of the <span class="strong"><strong><code class="literal">properties Map</code></strong></span>, and leaving properties that <span class="strong"><strong><span class="emphasis"><em><span class="underline">vary</span></em></span> <span class="underline">inside</span></strong></span> the <span class="strong"><strong><code class="literal">properties Map</code></strong></span>.</p><div class="informalfigure"><a id="med_id00625a"></a><div class="mediaobject"><a id="med_id00625"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069948.png.jpg" alt="image with no caption" width="403" height="535"></div></div><div class="sect2" title="Design decisions are always a tradeoff"><div class="titlepage"><div><div><h3 class="title" id="design_decisions_are_always_a_tradeoff">Design decisions are always a tradeoff</h3></div></div></div><p>Sam chose to emphasize the things that are common across all types of <span class="strong"><strong><code class="literal">Unit</code></strong></span>s. But there are some negatives to Sam’s design, too:</p><div class="note" title="Note"><h3 class="title"><a id="ch09note18"></a>Note</h3><p><span class="strong"><strong>We’re repeating ourselves</strong></span></p><p>Now there are two different ways to access properties: through the <span class="strong"><strong><code class="literal">getId()</code></strong></span>, <span class="strong"><strong><code class="literal">getName()</code></strong></span>, and property-specific methods, and the <span class="strong"><strong><code class="literal">getProperty()</code></strong></span> method. Two ways to access properties is almost certainly going to mean duplicate code somewhere.</p><div class="informalfigure"><a id="med_id00626a"></a><div class="mediaobject"><a id="med_id00626"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069950.png.jpg" alt="image with no caption" width="141" height="121"></div></div></div><p><span class="strong"><strong>Maintenance is a problem</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note19"></a>Note</h3><p>When you see the potential for duplicate code, you’ll almost always find maintenance and flexibility issues, as well.</p></div><p>Now you’ve got property names, like <span class="strong"><strong><code class="literal">id</code></strong></span> and <span class="strong"><strong><code class="literal">name</code></strong></span>, hard-coded into the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class. If a game designer doesn’t want to use those, or wants to change them, it’s going to be a real hassle, and require changes to the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class. This is usually where encapsulation would help, and that leads us to Randy’s design choice...</p><div class="informalfigure"><a id="med_id00627a"></a><div class="mediaobject"><a id="med_id00627"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069952.png.jpg" alt="image with no caption" width="158" height="186"></div></div><div class="informalfigure"><a id="med_id00628a"></a><div class="mediaobject"><a id="med_id00628"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div></div></div><div class="sect1" title="Solution #2: Emphasizing Encapsulation"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="solution_hash2_emphasizing_encapsulation">Solution #2: Emphasizing Encapsulation</h2></div></div></div><div class="informalfigure"><a id="med_id00629a"></a><div class="mediaobject"><a id="med_id00629"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069954.png.jpg" alt="image with no caption" width="483" height="371"></div></div><div class="informalfigure"><a id="med_id00630a"></a><div class="mediaobject"><a id="med_id00630"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069956.png.jpg" alt="image with no caption" width="404" height="229"></div></div><p><a id="iddle1247" class="indexterm"></a>This solution focuses on encapsulating <span class="underline">all</span> the properties for a <span class="strong"><strong><code class="literal">Unit</code></strong></span> into the <span class="strong"><strong><code class="literal">properties Map</code></strong></span>, and providing a standard interface—the <span class="strong"><strong><code class="literal">getProperty()</code></strong></span> method—for accessing all properties. Even properties that apply to all units, like <span class="strong"><strong><code class="literal">type</code></strong></span> and <span class="strong"><strong><code class="literal">id</code></strong></span>, are accessed through the <span class="strong"><strong><code class="literal">properties Map</code></strong></span> in this solution.</p><p>The emphasis is on <span class="strong"><strong><span class="emphasis"><em><span class="underline">encapsulation</span></em></span></strong></span>, and a <span class="strong"><strong><span class="emphasis"><em><span class="underline">flexible</span> <span class="underline">design</span></em></span></strong></span>. Even if the names of common properties change, the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class can stay the same, since no property names are hardcoded into the class itself.</p><div class="informalfigure"><a id="med_id00631a"></a><div class="mediaobject"><a id="med_id00631"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069958.png.jpg" alt="image with no caption" width="412" height="440"></div></div><div class="sect2" title="Tradeoffs with this decision, too..."><div class="titlepage"><div><div><h3 class="title" id="tradeoffs_with_this_decisioncomma_toohel">Tradeoffs with this decision, too...</h3></div></div></div><p>Randy’s solution is more resistant to changes, and uses a lot more encapsulation, but there are tradeoffs with this design, as well. Here are a few of the downsides to Randy’s design:</p><p><span class="strong"><strong>We’re ignoring commonality</strong></span> Randy encapsulated all of the properties into the <span class="strong"><strong><code class="literal">properties Map</code></strong></span>, but now there’s nothing to indicate that <span class="strong"><strong><code class="literal">type</code></strong></span>, <span class="strong"><strong><code class="literal">name</code></strong></span>, <span class="strong"><strong><code class="literal">id</code></strong></span>, and <span class="strong"><strong><code class="literal">weapons</code></strong></span> are intended to be properties common to all <span class="strong"><strong><code class="literal">Unit</code></strong></span> types.</p><div class="informalfigure"><a id="med_id00632a"></a><div class="mediaobject"><a id="med_id00632"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069960.png.jpg" alt="image with no caption" width="158" height="87"></div></div><p><span class="strong"><strong>Lots of work at runtime <code class="literal">getProperty()</code></strong></span> returns an <span class="strong"><strong><code class="literal">Object</code></strong></span>, and you’re going to have to cast that into the right value type for each different property, all at runtime. That’s a lot of casting, and a lot of extra work that your code has to do at runtime, even for the properties that are common to all <span class="strong"><strong><code class="literal">Unit</code></strong></span> types.</p><div class="informalfigure"><a id="med_id00633a"></a><div class="mediaobject"><a id="med_id00633"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069962.png.jpg" alt="image with no caption" width="91" height="191"></div></div><div class="note" title="Brain Power"><h3 class="title"><a id="ch09note20"></a>Brain Power</h3><p>Which developer’s solution do you think is best? Are there times where you think one solution might be the best choice, and other times where the other might work better?</p></div></div></div><div class="sect1" title="Let’s go with the commonality-focused solution"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_go_with_the_commonality-f">Let’s go with the commonality-focused solution</h2></div></div></div><p><a id="iddle1114" class="indexterm"></a>For Gary’s game system framework, let’s use Sam’s solution, which pulls the common properties of a <span class="strong"><strong><code class="literal">Unit</code></strong></span> out into their own properties and methods, and leaves unit-specific properties in a separate <span class="strong"><strong><code class="literal">Map</code></strong></span>.</p><div class="informalfigure"><a id="med_id00634a"></a><div class="mediaobject"><a id="med_id00634"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069964.png.jpg" alt="image with no caption" width="299" height="135"></div></div><div class="informalfigure"><a id="med_id00635a"></a><div class="mediaobject"><a id="med_id00635"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069966.png.jpg" alt="image with no caption" width="451" height="427"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00141"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa3qe1"></a><a id="ch09qa3q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1766" class="indexterm"></a><span class="strong"><strong>Q: I thought the other design, that focused on encapsulation, was better. Is that OK?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa3q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Absolutely. Both design choices have positives, and either one might work well. The only thing you <span class="strong"><strong><span class="underline">cannot</span></strong></span> do is be unwilling to change your design—whichever one you start with—if it turns out to not work well down the line. At each stage of iterating through your app, you need to reevaluate your design decisions, and make sure they’re still solid.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa3qe2"></a><a id="ch09qa3q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: So how do I know when I need to change my design? My code won’t just stop working, so what should I look out for?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa3q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Iteration is really the key point here. Lots of design decisions look great at one stage of your development, but then turn out to be a problem as you get deeper into a particular part of your app. So once you make a decision, stick with it, and iterate deeper into your application. As long as your design is working, and you’re able to use good OO principles and apply design patterns, you’re in good shape. If you start running into trouble with a decision, though, don’t ever be afraid to change designs and rework things.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa3qe3"></a><a id="ch09qa3q3"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: What happens when I can’t decide between a couple of good design choices?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa3q3a3"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> You always have to make a choice, even if you’re not 100% sure if it’s the right one. It’s always better to take your best guess, and see how things work out, rather than spend endless hours debating one choice or another. That’s called <span class="bolditalic">analysis paralysis</span>, and it’s a sure way to not get anything done. It’s much better to start down one path, even if you’re not totally sure it’s the right one, and get some work done, than to not make a choice at all.</p></td></tr></tbody></table></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Good software is built <span class="underline">iteratively</span>. Analyze, design, and then <span class="underline">iterate</span> <span class="underline">again</span>, working on smaller and smaller parts of your app.</strong></span></p><p><span class="strong"><strong>Each time you iterate, <span class="underline">reevaluate</span> your design decisions, and don’t be afraid to <span class="underline">CHANGE</span> something if it makes sense for your design.</strong></span></p></blockquote></div></div><div class="informalfigure"><a id="med_id00636a"></a><div class="mediaobject"><a id="med_id00636"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div></div><div class="sect1" title="Match your tests to your design"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="match_your_tests_to_your_design">Match your tests to your design</h2></div></div></div><p><a id="iddle1832" class="indexterm"></a>We’ve got test scenarios we want to show Gary, and a design for the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class. The last thing we need to do before coding is to make sure our design for <span class="strong"><strong><code class="literal">Unit</code></strong></span> will allow us to code a solution that passes all the tests.</p><div class="informalfigure"><a id="med_id00637a"></a><div class="mediaobject"><a id="med_id00637"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069968.png.jpg" alt="image with no caption" width="801" height="812"></div></div></div><div class="sect1" title="Let’s write the Unit class"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_write_the_unit_class">Let’s write the Unit class</h2></div></div></div><p><a id="iddle1835" class="indexterm"></a>It’s been two chapters in coming, but we’re finally ready to write the code for the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class. Here’s how we did it:</p><div class="informalfigure"><a id="med_id00638a"></a><div class="mediaobject"><a id="med_id00638"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069970.png.jpg" alt="image with no caption" width="65" height="105"></div></div><div class="informalfigure"><a id="med_id00639a"></a><div class="mediaobject"><a id="med_id00639"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069972.png.jpg" alt="image with no caption" width="747" height="807"></div></div><div class="informalfigure"><a id="med_id00640a"></a><div class="mediaobject"><a id="med_id00640"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div></div><div class="sect1" title="Test cases dissected..."><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="test_cases_dissectedhellip">Test cases dissected...</h2></div></div></div><p><a id="iddle1738" class="indexterm"></a><span class="strong"><strong>We’ve talked a lot about test cases, but so far, you haven’t seen how to actually write one. Let’s examine a test case up close, and see exactly what makes up a good test.</strong></span></p><div class="informalfigure"><a id="med_id00641a"></a><div class="mediaobject"><a id="med_id00641"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069203.png.jpg" alt="image with no caption" width="86" height="136"></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="strong"><strong>Each test case should have an ID and a name.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note21"></a>Note</h3><p>Try not to refer to tests as test1, test2, etc. Use descriptive names whenever possible.</p></div><p>The names of your test cases should describe what is being tested. Test names with nothing but a number at the end aren’t nearly as helpful as names like <span class="strong"><strong><code class="literal">testProperty()</code></strong></span> or <span class="strong"><strong><code class="literal">testCreation()</code></strong></span>. You should also use a numeric ID, so you can easily list your tests cases out (something we’ll do on the next page).</p></li><li class="listitem"><p><span class="strong"><strong>Each test case should have <span class="underline">one</span> <span class="underline">specific</span> <span class="underline">thing</span> that it tests.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note22"></a>Note</h3><p>One piece of functionality may involve one method, two methods, or even multiple classes... but to start with, focus on very simple pieces of functionality, one at a time.</p></div><p>Each of your test cases should be <span class="emphasis"><em>atomic</em></span>: each should test <span class="underline">only one</span> piece of functionality at time. This allows you to isolate exactly what piece of functionality might not be working in your application.</p></li><li class="listitem"><p><span class="strong"><strong>Each test case should have an input you supply.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note23"></a>Note</h3><p>If you’re setting hitPoints to 15, then “15” becomes the input you supply to your test case.</p></div><p>You’re going to give the test case a value, or a set of values, that it uses as the test data. This data is usually then used to execute some specific piece of functionality or behavior.</p></li><li class="listitem"><p><span class="strong"><strong>Each test case should have an output that you expect.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note24"></a>Note</h3><p>This is what you <span class="underline">want</span> the program to output. So if you set
type to “infantry”, and then call getType(), your expected output is
“infantry”.</p></div><p>Given your input, what should the program, class, or method output? You’ll compare the actual output of the program with your expected output, and if they match, then you’ve got a successful test, and your software works.</p></li><li class="listitem"><p><span class="strong"><strong>Most test cases have a starting state.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note25"></a>Note</h3><p>There’s not much starting state for the Unit class. We do need to create a new Unit, but that’s about it.</p></div><p>Do you need to open a database connection, or create a certain object, or set some values before running your test? If so, that’s all part of the starting state of the test case, and needs to be handled before you run the actual test.</p></li></ol></div><div class="sidebar"><a id="sharpen_your_pencil-id00142"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1629" class="indexterm"></a>Design your test cases.</p><p>Below is a table with 5 columns, one for each of the 5 important parts of a test case. Your job is to fill in the table with information for the test cases we’ve laid out in this chapter already. We’ve even done the first one to help get you started, and filled in a few empty spots on the rest of the tests.</p><div class="informalfigure"><a id="med_id00642a"></a><div class="mediaobject"><a id="med_id00642"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069974.png.jpg" alt="image with no caption" width="789" height="770"></div></div></div><div class="informalfigure"><a id="med_id00643a"></a><div class="mediaobject"><a id="med_id00643"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="sharpen_your_pencil_answers-id00143"></a><div class="sidebar-title">Sharpen your pencil answers</div><p><a id="iddle1630" class="indexterm"></a><a id="iddle1803" class="indexterm"></a>Design your test cases.</p><p>Below is a table with 5 columns, one for each of the 5 important parts of a test case. Your job was to fill in the table with information for the test cases we’ve laid out in this chapter already.</p><div class="informalfigure"><a id="med_id00644a"></a><div class="mediaobject"><a id="med_id00644"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069976.png.jpg" alt="image with no caption" width="855" height="458"></div></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00144"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa4qe1"></a><a id="ch09qa4q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: How did our three test scenarios turn into four test cases?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa4q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Because the first test case really tested <span class="emphasis"><em>two</em></span> things: setting and retrieving a common property, which has its own variable and access method (like <span class="strong"><strong><code class="literal">getType()</code></strong></span>), and setting a retrieving a unit- or game-specific property, which is accessed through <span class="strong"><strong><code class="literal">getProperty()</code></strong></span> (like <span class="strong"><strong><code class="literal">hitPoints</code></strong></span>). That’s two pieces of functionality, so two different test cases are required.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa4qe2"></a><a id="ch09qa4q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: And all these tests will let us know that our software works like it should, right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa4q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> It’s a good start on that, yes, but remember, we started out writing the tests so that we could prove to the customer that the software we’ve been writing actually will work. Our test cases let the customer see some code actually running, as well as help us find bugs in our code before we get too far along in our development cycle.</p></td></tr></tbody></table></div></blockquote></div></div><div class="sidebar"><a id="test_puzzle"></a><div class="sidebar-title">Test Puzzle</div><p><a id="iddle1742" class="indexterm"></a>Now that you know what test cases are, and have several written up in table form, you’re ready to code a test class to show your customer that your software works, and prove to yourself that there aren’t any bugs in the code that you’ve written.</p><p><span class="strong"><strong>The problem:</strong></span></p><p>Gary wants to know that you’re making progress on supporting units in his game system framework, and you want to be sure that the code you’ve written for <span class="strong"><strong><code class="literal">Unit.java</code></strong></span> works properly.</p><p><span class="strong"><strong>Your task:</strong></span></p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a new class called <span class="strong"><strong><code class="literal">UnitTester.java</code></strong></span>, and import the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class and any related classes into it.</p></li><li class="listitem"><p>Add a new method for each test case you figured out from the table in <a class="xref" href="ch09.html#sharpen_your_pencil_answers-id00143" title="Sharpen your pencil answers">Sharpen your pencil answers</a>. Be sure to use descriptive names for the test methods.</p></li><li class="listitem"><p>Each test method should take in an instance of <span class="strong"><strong><code class="literal">Unit</code></strong></span> with any starting state already set, and any other parameters you think you’ll need to run the test and compare an input value with an expected output value.</p></li><li class="listitem"><p>The test method should set the supplied property name and property value on the provided <span class="strong"><strong><code class="literal">Unit</code></strong></span>, and then retrieve the expected output property value using the expected output property name.</p></li><li class="listitem"><p>If the provided input value and expected output value match, the method should print out “Test passed”; if they don’t match, the method should print “Test failed”, along with the mismatched values.</p></li><li class="listitem"><p>Write a <span class="strong"><strong><code class="literal">main()</code></strong></span> method that sets up the starting state for each test, and then runs each test.</p></li></ol></div><p><span class="strong"><strong>Bonus Credit:</strong></span></p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>There are several things in <span class="strong"><strong><code class="literal">Unit.java</code></strong></span> that are not being tested by the scenarios in <a class="xref" href="ch09.html#sharpen_your_pencil_answers-id00143" title="Sharpen your pencil answers">Sharpen your pencil answers</a>. Identify what each of these are, and create a test method for each.</p></li><li class="listitem"><p>Run these tests from your <span class="strong"><strong><code class="literal">main()</code></strong></span> method as well.</p></li></ol></div></div><div class="informalfigure"><a id="med_id00645a"></a><div class="mediaobject"><a id="med_id00645"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="test_puzzle_solutions"></a><div class="sidebar-title">Test Puzzle Solutions</div><div class="informalfigure"><a id="med_id00646a"></a><div class="mediaobject"><a id="med_id00646"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069978.png.jpg" alt="image with no caption" width="813" height="895"></div></div><div class="informalfigure"><a id="med_id00647a"></a><div class="mediaobject"><a id="med_id00647"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069980.png.jpg" alt="image with no caption" width="836" height="508"></div></div></div><p><a id="iddle1745" class="indexterm"></a><span class="strong"><strong>And now for some bonus credit...</strong></span></p><p>We added three new test cases to our table, to handle the three properties common to all units that aren’t tested in UnitTester. You should be able to write three additional test methods based on this table. Did you figure these out on your own?</p><div class="informalfigure"><a id="med_id00648a"></a><div class="mediaobject"><a id="med_id00648"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069982.png.jpg" alt="image with no caption" width="708" height="318"></div></div><div class="informalfigure"><a id="med_id00649a"></a><div class="mediaobject"><a id="med_id00649"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div></div><div class="sect1" title="Prove yourself to the customer"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="prove_yourself_to_the_customer">Prove yourself to the customer</h2></div></div></div><p>With a <span class="strong"><strong><code class="literal">Unit</code></strong></span> class and a set of test cases, you’re ready to show Gary some working code, and prove that you’re on the right track to building his game system framework just the way he wants it. Let’s show him the test class running:</p><div class="informalfigure"><a id="med_id00650a"></a><div class="mediaobject"><a id="med_id00650"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069984.png.jpg" alt="image with no caption" width="609" height="282"></div></div><div class="informalfigure"><a id="med_id00651a"></a><div class="mediaobject"><a id="med_id00651"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069986.png.jpg" alt="image with no caption" width="433" height="399"></div></div><div class="informalfigure"><a id="med_id00652a"></a><div class="mediaobject"><a id="med_id00652"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069988.png.jpg" alt="image with no caption" width="574" height="646"></div></div><p><a id="iddle1130" class="indexterm"></a><a id="iddle1503" class="indexterm"></a><span class="strong"><strong>Let’s change the <span class="underline">programming</span> <span class="underline">contract</span> for the game system</strong></span></p><p>When you’re writing software, you’re also creating a contract between that software and the people that use it. The contract details how the software will work when certain actions are taken—like requesting a non-existent property on a unit.</p><p>If the customer wants an action to result in different behavior, then you’re changing the contract. So if Gary’s framework should throw an exception when a non-existent property is queried, that’s fine; it just means that the contract between game designers and the framework has changed.</p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>When you <span class="underline">program by contract</span>, <span class="underline">you</span> and your <span class="underline">software’s users</span> are agreeing that your software will <span class="underline">behave</span> in a certain way.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note26"></a>Note</h3><p>Want to know more about what this means? Turn the page to find out more...</p></div></blockquote></div></div><div class="sect1" title="We’ve been programming by contract so far"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="weapostropheve_been_programming_by_contr">We’ve been <span class="underline">programming by contract</span> so far</h2></div></div></div><p><a id="iddle1833" class="indexterm"></a>You probably didn’t notice, but we’ve been doing something called <span class="strong"><strong><span class="emphasis"><em>programming by contract</em></span></strong></span> in the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class so far. In the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class, if someone asks for a property that doesn’t exist, we’ve just returned null. We’ve been doing the same thing in <span class="strong"><strong><code class="literal">getWeapons()</code></strong></span>; if the <span class="strong"><strong><code class="literal">weapons</code></strong></span> list isn’t initialized, we just return null there, too:</p><div class="informalfigure"><a id="med_id00653a"></a><div class="mediaobject"><a id="med_id00653"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069990.png.jpg" alt="image with no caption" width="299" height="180"></div></div><div class="informalfigure"><a id="med_id00654a"></a><div class="mediaobject"><a id="med_id00654"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069992.png.jpg" alt="image with no caption" width="735" height="307"></div></div><div class="sect2" title="This is the contract for Unit"><div class="titlepage"><div><div><h3 class="title" id="this_is_the_contract_for_unit">This is the <span class="underline">contract</span> for Unit</h3></div></div></div><p>The <span class="strong"><strong><code class="literal">Unit</code></strong></span> class assumes that people using it are competent programmers, and that they can handle null return values. So our contract states something like this:</p><div class="informalfigure"><a id="med_id00655a"></a><div class="mediaobject"><a id="med_id00655"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069994.png.jpg" alt="image with no caption" width="389" height="154"></div></div></div></div><div class="sect1" title="Programming by contract is really all about trust"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="programming_by_contract_is_really_all_ab">Programming by contract is really all about <span class="underline">trust</span></h2></div></div></div><p>When you return null, you’re <span class="strong"><strong>trusting</strong></span> programmers to be able to deal with null return values. Programmers are basically saying that they’ve coded things well enough that they won’t ask for non-existent properties or weapons, so their code just doesn’t worry about getting null values back from the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class:</p><div class="informalfigure"><a id="med_id00656a"></a><div class="mediaobject"><a id="med_id00656"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069996.png.jpg" alt="image with no caption" width="401" height="167"></div></div></div><div class="sect1" title="And we can always change the contract if we need to..."><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="and_we_can_always_change_the_contract_if">And we can always <span class="underline">change</span> the contract if we need to...</h2></div></div></div><p>Back in <a class="xref" href="ch09.html#ch09note26" title="Note">Note</a>, we were asked to stop returning null, and throw an exception instead. This really isn’t a big change to the contract; it just means that now game designers are going to have big problems if they ask for non-existent properties or weapons.</p><div class="informalfigure"><a id="med_id00657a"></a><div class="mediaobject"><a id="med_id00657"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069998.png.jpg" alt="image with no caption" width="601" height="425"></div></div><div class="informalfigure"><a id="med_id00658a"></a><div class="mediaobject"><a id="med_id00658"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070000.png.jpg" alt="image with no caption" width="428" height="168"></div></div><div class="informalfigure"><a id="med_id00659a"></a><div class="mediaobject"><a id="med_id00659"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div></div><div class="sect1" title="But if you don’t trust your users..."><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="but_if_you_donapostrophet_trust_your_use">But if you don’t trust your users...</h2></div></div></div><p><a id="iddle1149" class="indexterm"></a><a id="iddle1506" class="indexterm"></a>But what happens if you don’t think your code will be used correctly? Or if you think that certain actions are such a bad idea that you don’t want to let users deal with them in their own way? In these cases, you may want to consider <span class="strong"><strong>defensive programming</strong></span>.</p><p>Suppose you were really worried that game designers using the Unit class, and asking for non-existent properties, were getting null values and not handling them properly. You might rewrite the <span class="strong"><strong><code class="literal">getProperty()</code></strong></span> method like this:</p><div class="informalfigure"><a id="med_id00660a"></a><div class="mediaobject"><a id="med_id00660"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070002.png.jpg" alt="image with no caption" width="221" height="232"></div></div><div class="informalfigure"><a id="med_id00661a"></a><div class="mediaobject"><a id="med_id00661"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070004.png.jpg" alt="image with no caption" width="746" height="411"></div></div><p>I’m sure you’re great code and all, but I just don’t trust you. I could send you null, and you could totally blow up. So let’s just be safe, and I’ll send you a checked exception that you’ll have to catch, to make sure you don’t get a null value back and do something stupid with it.</p><div class="informalfigure"><a id="med_id00662a"></a><div class="mediaobject"><a id="med_id00662"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070006.png.jpg" alt="image with no caption" width="402" height="142"></div></div></div><div class="sect1" title="-or if they don’t trust you..."><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="or_if_they_donapostrophet_trust_youhelli">-or if they don’t trust you...</h2></div></div></div><p><a id="iddle1767" class="indexterm"></a>Of course, when programmers use your code, they might not trust you either... they can program defensively as well. What if they don’t believe that you’ll only return non-null values from <span class="strong"><strong><code class="literal">getProperty()</code></strong></span>? Then they’re going to protect their code, and use defensive programming, as well:</p><div class="informalfigure"><a id="med_id00663a"></a><div class="mediaobject"><a id="med_id00663"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070008.png.jpg" alt="image with no caption" width="780" height="501"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00145"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa5qe1"></a><a id="ch09qa5q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: You said in <a class="xref" href="ch09.html#programming_by_contract_is_really_all_ab" title="Programming by contract is really all about trust">Programming by contract is really all about <span class="underline">trust</span></a> that we could change the contract to throw an exception, but then you said here that throwing an exception is defensive programming. I’m confused...</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa5q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> It’s really not that important what kind of exception is thrown. What’s important is how your customers and clients are <span class="emphasis"><em>involved</em></span> in that decision. In programming by contract, you work with the client to agree on how you’re going to handle problems; in defensive programming, you make that decision in a way that ensures your code doesn’t crash, regardless of what the client wants to have happen.</p><p>When we decided to switch from returning null to throwing an exception, we did that by listening to the client, and agreeing on that particular action as a response to a request for non-existent properties. And we made the exception a <span class="strong"><strong><code class="literal">RuntimeException</code></strong></span>, again because the client didn’t want to add lots of <span class="strong"><strong><code class="literal">try</code></strong></span>/<span class="strong"><strong><code class="literal">catch</code></strong></span> blocks to their code. They could have just as easily asked for a checked exception, and we could have agreed—and <span class="emphasis"><em>still</em></span> been programming by contract.</p><p>Compare that to defensive programming, where we’re not really that interested in what the client wants. In defensive programming, we’re making sure that we aren’t responsible for crashing a program, and we even go out of our way to try and prevent the client from crashing their program.</p></td></tr></tbody></table></div></blockquote></div></div><div class="sidebar"><a id="fireside_chats"></a><div class="sidebar-title"><code class="literal">Fireside Chats</code></div><p><a id="iddle1505" class="indexterm"></a>Tonight’s talk: <span class="strong"><strong>Programming by Contract and Defensive Programming duke it out over trust issues with programmers.</strong></span></p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Programming by Contract</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Defensive Programming</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>It’s nice to sit down with you and meet face to face, we really don’t see each other like this very often.</p></td><td style="vertical-align: bottom; border-bottom: 0.5pt solid ; "><p>Yeah, I really don’t like to get out much There’s just so much that can go wrong.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>What do you mean?</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Well, I could be crossing the street, and slip on some Banana.peel() that hadn’t been garbage collected, or some for loop without a good termination condition could come screaming through the intersection... there’s a lot of bad code out there, you know?</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Well, sure, I guess... but you can’t live your whole life in fear of bad code. At some point, you have to just commit to how you’re going to behave, and trust other programmers to use you right.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Are you kidding me? Have you met most of the programmers writing the code you’re talking about trusting? They’re too busy watching <span class="emphasis"><em>Lost</em></span> to worry about checking for bugs in their software. If they’d stop gawking at that Kate and her freckles, maybe I wouldn’t have to double-check their work so much.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Boy, it sounds like you have trust issues.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>And you don’t?</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>No. I trust programmers understand the contract that I provide them.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Contract? Oh, you still think that if you explain what you’ll do in a certain situation, that a “good” programmer will use you correctly? Boy, what naivete!</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Look, my contract explicitly states what I have to do, and what people that use me have to do.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Haven’t you heard? Over 50% of contracts today end in divorce... or maybe that was a different stat, I’m not sure... anyway, do you really think programmers are paying attention to your little contract?</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Look, if programmers and users don’t keep their end of the bargain, I can’t be held responsible for that. If they violate the contract, they deserve what they get. I can’t be held liable.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Sounds pretty callous to me. I try and help my users, and even protect them from themselves.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>With tons of extra code, little “if (value == null)” checks everywhere? What a beating. Sounds like you slow things down more than anything.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Sure, sometimes I’m not the best performer, but I sure keep everyone safe from disaster. I often like to think of myself... a bit like Superman.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Superman? You did <span class="strong"><strong><span class="emphasis"><em>not</em></span></strong></span> just say that...</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>It’s true! Besides, how many times has your code gone up in smoke because of a lazy programmer who ignored your contract?</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>But that’s the point! I may not be great for lazy programmers, but I’m <span class="emphasis"><em>terrific</em></span> for programmers who do check their work. They get a performance bump, and their code is shorter when they use me.</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Short code, humph. I’d much rather have good code. Code that keeps programmers and users safe.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>And that’s what I provide, just without all the trust issues and baggage you bring along...</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Hey, I’ve got a trust issue for you right here...</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>I’ll show you safe code, you little...</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="vertical-align: top; " colspan="2"><p><span class="strong"><strong><span class="emphasis"><em>...transmission ended... Veuillez nous aider! ... 4 8 15 ...</em></span></strong></span></p></td></tr></tbody></table></div></div><div class="sidebar"><a id="who_am_iquestion_mark-id00146"></a><div class="sidebar-title">Who Am I?</div><p><a id="iddle1901" class="indexterm"></a><span class="strong"><strong>Feature Driven Development, Use Case Driven Development</strong></span>, <span class="strong"><strong>Programming by Contract</strong></span>, and <span class="strong"><strong>Defensive Programming</strong></span> have all showed up for a masquerade party, but none of them bothered to wear name tags. They’re all a chatty bunch, though, so it’s up to you to listen to what they’re saying, and try and figure out who’s behind the masks. Be careful.... sometimes more than one masked guest could be saying the same thing.</p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"></colgroup><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>I’m very well-ordered. I prefer to take things one step at a time, until I’ve made it from start to finish.</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Well, sure, she said she would call, but how can you really believe anyone anymore?</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Oh, absolutely, requirements really get me motivated.</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>I’m very well-behaved. In fact, I’ve been focusing on all of my own behavior before moving on to anything else.</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Really, it’s all about my customer. I just want to satisfy them, after all.</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Hey, you’re a big boy. You can deal with that on your own... it’s really not my problem anymore, is it?</strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="strong"><strong>As long as you’re good with it, so am I. Who am I to tell you what to do, so long as you know what you can expect from me.</strong></span></p></td><td style="vertical-align: top; "><p>_____________________________</p></td></tr></tbody></table></div><p><span class="inlinemediaobject"><a id="inline_id00066"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2068819.png.jpg" alt="" width="99" height="9"></span> <span class="strong"><strong>Figure out who is who in <a class="xref" href="ch09.html#who_am_iquestion_mark_solutions-id00155" title="Who Am I? Solutions">Who Am I? Solutions</a>.</strong></span></p></div><div class="informalfigure"><a id="med_id00664a"></a><div class="mediaobject"><a id="med_id00664"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="sharpen_your_pencil-id00147"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1678" class="indexterm"></a>Change the programming contract for Unit.</p><p>Gary’s clients want Unit to assume they’re using it correctly. That means that if a non-existent property is being queried, then something has truly gone wrong in the game, and an exception needs to be thrown. Your job is to:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Update Unit.java so that requests for a non-existent property result in an exception being thrown. Figuring out the type of exception to use is up to you.</p></li><li class="listitem"><p>Update UnitTester and the test cases that this contract change affects to reflect this new contract.</p></li><li class="listitem"><p>Re-run UnitTester and make sure Unit.java still passes all of the tests.</p></li></ol></div><div class="note" title="Note"><h3 class="title"><a id="ch09note27"></a>Note</h3><p>Our answers are on the next page.</p></div></div><div class="informalfigure"><a id="med_id00665a"></a><div class="mediaobject"><a id="med_id00665"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="sharpen_your_pencil_answers-id00148"></a><div class="sidebar-title">Sharpen your pencil answers</div><p><a id="iddle1087" class="indexterm"></a><a id="iddle1604" class="indexterm"></a><a id="iddle1679" class="indexterm"></a><a id="iddle1797" class="indexterm"></a>Change the programming contract for Unit.</p><p>Gary’s clients want Unit to assume they’re using it correctly. That means that if a non-existent property is being queried, then something has truly gone wrong in the game, and an exception needs to be thrown.</p><div class="informalfigure"><a id="med_id00666a"></a><div class="mediaobject"><a id="med_id00666"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070010.png.jpg" alt="image with no caption" width="829" height="455"></div></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00149"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa6qe1"></a><a id="ch09qa6q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Why are you throwing a RuntimeException, and not a checked exception, like IllegalAccessException?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa6q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> If you used a checked exception, code that calls <span class="strong"><strong><code class="literal">getProperty()</code></strong></span> would have to check for that exception, in <span class="strong"><strong><code class="literal">try</code></strong></span>/<span class="strong"><strong><code class="literal">catch</code></strong></span> blocks. That’s not what the client wanted; we agreed to a contract that would let them code without having to catch for any exceptions. So by using a <span class="strong"><strong><code class="literal">RuntimeException</code></strong></span>, no extra worked is required for their client code to use the <span class="strong"><strong><code class="literal">Unit</code></strong></span> class.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa6qe2"></a><a id="ch09qa6q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: What about the get methods for other properties, like weapons, name, and id?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa6q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> <span class="strong"><strong><code class="literal">id</code></strong></span> and <span class="strong"><strong><code class="literal">name</code></strong></span> are an <span class="strong"><strong><code class="literal">int</code></strong></span> and <span class="strong"><strong><code class="literal">String</code></strong></span>, respectively, so those aren’t a problem (<span class="strong"><strong><code class="literal">id</code></strong></span> is required to create a new <span class="strong"><strong><code class="literal">Unit</code></strong></span>, and name will either be null or a <span class="strong"><strong><code class="literal">String</code></strong></span> with a value). The <span class="strong"><strong><code class="literal">weapons</code></strong></span> property is a <span class="strong"><strong><code class="literal">List</code></strong></span>, so if you call <span class="strong"><strong><code class="literal">getWeapons()</code></strong></span> when there aren’t any it’s going to result in a null list being returned. You could change that method to throw an exception if the weapons list was empty, although that wasn’t specifically asked for by the clients.</p></td></tr></tbody></table></div></blockquote></div></div><div class="blockquote"><blockquote class="blockquote"><p><a id="iddle1504" class="indexterm"></a><a id="iddle1507" class="indexterm"></a><a id="iddle1793" class="indexterm"></a><span class="strong"><strong>When you are <span class="underline">programming by contract</span>, you’re working with client code to <span class="underline">agree</span> on how you’ll handle problem situations.</strong></span></p><p><span class="strong"><strong>When you’re <span class="underline">programming defensively</span>, you’re making sure the client gets a “safe” response, <span class="underline">no matter what</span> the client wants to have happen.</strong></span></p></blockquote></div><div class="informalfigure"><a id="med_id00667a"></a><div class="mediaobject"><a id="med_id00667"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070012.png.jpg" alt="image with no caption" width="862" height="436"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00150"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa7qe1"></a><a id="ch09qa7q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: You said that programming by contract resulted in less code, but it seems like we just added a lot of code to Unit.java.</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa7q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> That’s because instead of directly returning null, we throw a new <span class="strong"><strong><code class="literal">RuntimeException</code></strong></span>. But that’s more of a special case here than the rule. Most of the time, you’ll not have much extra code on the service side, because you’re simply returning objects and values without checking to see if they’re non-null, or within a particular data range.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch09qa7qe2"></a><a id="ch09qa7q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: I still don’t see why we’re switching to programming by contract here. Why is it so much better?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch09qa7q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> It’s not a matter of being better or worse; it’s a matter of what your customer wants. In fact, you’ll rarely decide on your own if you want to do programming by contract or defensive programming. That’s something that’s usually determined by what your customer wants, and the types of users that will be using the software that you’re writing.</p></td></tr></tbody></table></div></blockquote></div></div></div><div class="sect1" title="Moving units"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="moving_units">Moving units</h2></div></div></div><div class="informalfigure"><a id="med_id00668a"></a><div class="mediaobject"><a id="med_id00668"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070014.png.jpg" alt="image with no caption" width="335" height="133"></div></div><p><a id="iddle1840" class="indexterm"></a>We’ve finally finished up unit properties, and can move on to the next item on our list:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="strong"><strong>Each unit should have properties, and game designers can add new properties to unit types in their own games.</strong></span></p></li><li class="listitem"><p><span class="strong"><strong>Units have to be able to move from one tile on a board to another.</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch09note28"></a>Note</h3><p>We’re on to dealing with movement, now.</p></div></li><li class="listitem"><p><span class="strong"><strong>Units can be grouped together into armies.</strong></span></p></li></ol></div><div class="sect2" title="Haven’t we been here before?"><div class="titlepage"><div><div><h3 class="title" id="havenapostrophet_we_been_here_beforeques">Haven’t we been here before?</h3></div></div></div><p>This should sound pretty familiar... we already dealt with movement in <a class="xref" href="ch07.html" title="Chapter&nbsp;7.&nbsp;Architecture: Bringing Order to Chaos">Chapter&nbsp;7</a>:</p><div class="informalfigure"><a id="med_id00669a"></a><div class="mediaobject"><a id="med_id00669"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070016.png.jpg" alt="image with no caption" width="614" height="468"></div></div></div></div><div class="sect1" title="Break your apps up into smaller chunks of functionality"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="break_your_apps_up_into_smaller_chunks_o">Break your apps up into smaller chunks of functionality</h2></div></div></div><p><a id="iddle1311" class="indexterm"></a>We’ve been talking a lot about iterating deeper into your application, and at each stage, doing more analysis and design. So you’re taking each problem, and then breaking it up (either into use cases or features), and then solving a part of the problem, over and over. This is what we’ve been doing in this chapter: taking a single feature, and working on that feature until it’s complete.</p><div class="informalfigure"><a id="med_id00670a"></a><div class="mediaobject"><a id="med_id00670"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070018.png.jpg" alt="image with no caption" width="365" height="205"></div></div><div class="sect2" title="But you can still break things up further..."><div class="titlepage"><div><div><h3 class="title" id="but_you_can_still_break_things_up_furthe">But you can still break things up further...</h3></div></div></div><p>But once you choose a single feature or use case, you can usually break that feature up into even smaller pieces of behavior. For example, a unit has properties and we have to deal with unit movement. And we also need to support groupings of units. So each of these individual pieces of behavior has to be dealt with.</p><div class="informalfigure"><a id="med_id00671a"></a><div class="mediaobject"><a id="med_id00671"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070020.png.jpg" alt="image with no caption" width="371" height="207"></div></div><p>Just like when you broke your app up and began to iterate, you’ll have to do more analysis and design at each step. Always make sure your earlier decisions make sense, and change or rework those decisions if they don’t.</p></div><div class="sect2" title="Your decisions can iterate down, too"><div class="titlepage"><div><div><h3 class="title" id="your_decisions_can_iterate_downcomma_too">Your decisions can iterate down, too</h3></div></div></div><p>Lots of times you’ll find that decisions you made earlier save you work down the line. In Gary’s system, we decided that game designers would deal with movement on their own. So now that we’re talking about how to handle unit movement, we can take that decision we made earlier, and apply it here. Since it still seems sensible—there’s no reason to change that decision—we can have game designers worry about handling unit movement, and move on to the next piece of behavior.</p><div class="informalfigure"><a id="med_id00672a"></a><div class="mediaobject"><a id="med_id00672"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070022.png.jpg" alt="image with no caption" width="391" height="268"></div></div><div class="note" title="Note"><h3 class="title"><a id="ch09note29"></a>Note</h3><p>Just add a note to your docs for the game designers that movement is up to them.</p></div><div class="informalfigure"><a id="med_id00673a"></a><div class="mediaobject"><a id="med_id00673"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070024.png.jpg" alt="image with no caption" width="397" height="112"></div></div><div class="informalfigure"><a id="med_id00674a"></a><div class="mediaobject"><a id="med_id00674"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070026.png.jpg" alt="image with no caption" width="326" height="165"></div></div><div class="sidebar"><a id="feature_puzzle"></a><div class="sidebar-title">Feature Puzzle</div><p><a id="iddle1274" class="indexterm"></a>By now, you should have feature driven development, iteration, analysis, and design down pretty solid. We’re going to leave it up to you to handle the last bit of behavior and finish off the <span class="strong"><strong><code class="literal">Unit</code></strong></span> feature of Gary’s game system framework.</p><p><span class="strong"><strong>The problem:</strong></span></p><p>Gary’s framework needs to support groups of units.</p><p><span class="strong"><strong>Your task:</strong></span></p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a new class that can group units together, and both add and remove units to the group.</p></li><li class="listitem"><p>Fill out the table below with test case scenarios that will test your software, and prove to Gary that the grouping of units works.</p></li><li class="listitem"><p>Add methods to <span class="strong"><strong><code class="literal">UnitTester</code></strong></span> to implement the test scenarios in the table, and make sure all your tests pass.</p></li></ol></div><div class="informalfigure"><a id="med_id00675a"></a><div class="mediaobject"><a id="med_id00675"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070028.png.jpg" alt="image with no caption" width="715" height="327"></div></div><p><span class="inlinemediaobject"><a id="inline_id00067"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2068819.png.jpg" alt="" width="99" height="9"></span> <span class="strong"><strong>See how we solved the puzzle in <a class="xref" href="ch09.html#feature_puzzle_solutions" title="Feature Puzzle Solutions">Feature Puzzle Solutions</a>.</strong></span></p></div><div class="sidebar"><a id="bullet_points-id00151"></a><div class="sidebar-title">Bullet Points</div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><a id="iddle1080" class="indexterm"></a><a id="iddle1268" class="indexterm"></a><a id="iddle1405" class="indexterm"></a><a id="iddle1850" class="indexterm"></a>The first step in writing good software is to make sure your application works like the customer expects and wants it to.</p></li><li class="listitem"><p>Customers don’t usually care about diagrams and lists; they want to see your software actually do something.</p></li><li class="listitem"><p>Use case driven development focuses on one scenario in a use case in your application at a time.</p></li><li class="listitem"><p>In use case driven development, you focus on a single scenario at a time, but you also usually code all the scenarios in a single use case before moving on to any other scenarios, in other use cases.</p></li><li class="listitem"><p>Feature driven development allows you to code a complete feature before moving on to anything else.</p></li><li class="listitem"><p>You can choose to work on either big or small features in feature-driven development, as long as you take each feature one at a time.</p></li><li class="listitem"><p>Software development is always iterative. You look at the big picture, and then iterate down to smaller pieces of functionality.</p></li><li class="listitem"><p>You have to do analysis and design at each step of your development cycle, including when you start working on a new feature or use case.</p></li><li class="listitem"><p>Tests allow you to make sure your software doesn’t have any bugs, and let you prove to your customer that your software works.</p></li><li class="listitem"><p>A good test case only tests one specific piece of functionality.</p></li><li class="listitem"><p>Test cases may involve only one, or several, methods in a single class, or may involve multiple classes.</p></li><li class="listitem"><p>Test driven development is based on the idea that you write your tests first, and then develop software that passes those tests. The result is fully functional, working software.</p></li><li class="listitem"><p>Programming by contract assumes both sides in a transaction understand what actions generate what behavior, and will abide by that contract.</p></li><li class="listitem"><p>Methods usually return null or unchecked exceptions when errors occur in programming by contract environments.</p></li><li class="listitem"><p>Defensive programming looks for things to go wrong, and tests extensively to avoid problem situations.</p></li><li class="listitem"><p>Methods usually return “empty” objects or throw checked exceptions in defensive programming environments.</p></li></ul></div></div><div class="informalfigure"><a id="med_id00676a"></a><div class="mediaobject"><a id="med_id00676"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069916.png.jpg" alt="image with no caption" width="324" height="44"></div></div><div class="sidebar"><a id="feature_puzzle_solutions"></a><div class="sidebar-title">Feature Puzzle Solutions</div><p><a id="iddle1275" class="indexterm"></a><a id="iddle1836" class="indexterm"></a>Gary’s framework needs to support groups of units, and should also allow groups of those groups (in as many nestings as the game designer wants to allow).</p><div class="informalfigure"><a id="med_id00677a"></a><div class="mediaobject"><a id="med_id00677"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070030.png.jpg" alt="image with no caption" width="800" height="764"></div></div></div><p><a id="iddle1739" class="indexterm"></a><span class="strong"><strong>And now for the test cases:</strong></span></p><div class="informalfigure"><a id="med_id00678a"></a><div class="mediaobject"><a id="med_id00678"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070032.png.jpg" alt="image with no caption" width="781" height="530"></div></div><div class="note" title="Get online"><h3 class="title"><a id="ch09note31"></a>Get online</h3><p>You should be able to write the code for UnitTester using the test case table shown here. If you want to see how your code compares with ours, visit <a class="ulink" href="http://www.headfirstlabs.com" target="_top">http://www.headfirstlabs.com</a>, click on Head First OOA&amp;D, and look for “UnitGroup Test Cases.”</p></div><div class="sidebar"><a id="tools_for_your_ooaampersandd_too-id00152"></a><div class="sidebar-title">Tools for your OOA&amp;D Toolbox</div><p><a id="iddle1269" class="indexterm"></a><a id="iddle1477" class="indexterm"></a><a id="iddle1851" class="indexterm"></a><span class="strong"><strong>We learned about several approaches to iterating through your project, and even a bit about two common programming practices in this chapter. Add all these to your toolbox:</strong></span></p><div class="informalfigure"><a id="med_id00679a"></a><div class="mediaobject"><a id="med_id00679"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070034.png.jpg" alt="image with no caption" width="749" height="738"></div></div></div><div class="sidebar"><a id="ooaampersandd_cross-id00153"></a><div class="sidebar-title">OOA&amp;D Cross</div><p><a id="iddle1469" class="indexterm"></a>Lots of new terms in this chapter, so lots of little square boxes to fill in for this chapter’s crossword. Review the chapter and see if you can get them all!</p><div class="informalfigure"><a id="med_id00680a"></a><div class="mediaobject"><a id="med_id00680"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070036.png.jpg" alt="image with no caption" width="589" height="423"></div></div><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Across</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Down</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>3. Never be afraid to do this in design.</p>
<p>4. This type of programming protects you and focuses on preventing errors and invalid data.</p>
<p>6. You should test your software for this kind of usage.</p>
<p>11. Iterating your development based on specific pieces of functionality.</p>
<p>12. Feature driven development is very __________.</p>
<p>15. Good development is driven by these.</p>
<p>16. Customers just want their software to do this.</p>
<p>17. Developing your software based on scenarios through a system.</p>
<p>18. Getting stuck trying to decide on one design decision or another.</p></td><td style="vertical-align: top; "><p>1. This is what you use to prove to the customer that your software works.</p>
<p>2. Program this way when you trust your users, and they trust you.</p>
<p>5. Testing weird and strange usages your code will help you catch errors __________.</p>
<p>7. Use case diagrams and feature lists don’t make sense to the ___________.</p>
<p>8. Design decisions are always a __________.</p>
<p>9. A single test case can focus on this many pieces of functionality</p>
<p>10. Great software is written like this.</p>
<p>13. You write software for the __________.</p>
<p>14. Once you choose a feature or use case, you need to do this again.</p></td></tr></tbody></table></div></div><div class="sidebar"><a id="exercise_solutions-id00154"></a><div class="sidebar-title">Exercise Solutions</div><div class="informalfigure"><a id="med_id00681a"></a><div class="mediaobject"><a id="med_id00681"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070038.png.jpg" alt="image with no caption" width="538" height="370"></div></div></div><div class="sidebar"><a id="who_am_iquestion_mark_solutions-id00155"></a><div class="sidebar-title">Who Am I? Solutions</div><p><a id="iddle1903" class="indexterm"></a><span class="strong"><strong>Feature Driven Development</strong></span>, <span class="strong"><strong>Use Case Driven Development</strong></span>, <span class="strong"><strong>Programming by Contract</strong></span>, and <span class="strong"><strong>Defensive Programming</strong></span> have all showed up for a masquerade party, but none of them bothered to wear name tags. They’re all a chatty bunch, though, so it’s up to you to listen to what they’re saying, and try and figure out who’s behind the masks. Be careful.... sometimes more than one masked guest could be saying the same thing.</p><div class="informalfigure"><a id="med_id00682a"></a><div class="mediaobject"><a id="med_id00682"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2070040.png.jpg" alt="image with no caption" width="667" height="479"></div></div></div></div></div></section></div></div><link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/core.css" crossorigin="anonymous"></div></div></section>
</div>

