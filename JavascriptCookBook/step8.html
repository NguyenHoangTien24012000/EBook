<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
    
</style>
<link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492092506/files/epub.css" crossorigin="anonymous">
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 8. Classes"><div class="chapter" id="ch08">
        <h1><span class="label">Chapter 8. </span>Classes</h1>
        
        
        <p><a data-type="indexterm" data-primary="object-oriented programming" id="idm45475160942392"></a><a data-type="indexterm" data-primary="classes" id="ix_classes_ch8"></a>Is JavaScript an object-oriented programming language? The answer depends on who you ask (and how you phrase the question). But the general consensus is <em>yes</em>, with some caveats.</p>
        
        <p><a data-type="indexterm" data-primary="prototypes" id="idm45475160939768"></a>Outside of academic circles, object-oriented programming languages usually revolve around concepts like classes, interfaces, and inheritance. But until recently, JavaScript was an outlier—an object-oriented programming language built on functions and <em>prototypes</em>. Then, along came ES6, and all of sudden classes were available as a native language construct, muddying the waters. Was it just syntactic sugar or a major language evolution?</p>
        
        <p><a data-type="indexterm" data-primary="ES6 (ECMAScript 2015)" data-secondary="classes in JavaScript and" id="idm45475160937800"></a>The answer lies somewhere in between. Overall, ES6 classes are a higher-level language feature built on the familiar foundation of JavaScript prototypes. But the mapping isn’t exact, and the class model introduces some new subtleties that aren’t completely captured in the prototype model. Furthermore, it’s likely that classes will support new object-oriented features in the future, pushing the two overlapping models farther apart.</p>
        
        <p>The bottom line is this: today new development favors using classes, but prototype-based code is still common (and far from obsolete). This chapter focuses on common patterns using classes, but also explores prototypes.</p>
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Creating a Reusable Class"><div class="sect1" id="using_es6_classes">
        <h1>Creating a Reusable Class</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475160933992">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="reusable class, creating" id="ix_reusable_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="reusable class" id="ix_class_reusable"></a>You want to create a reusable template for custom objects.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475160930248">
        <h2>Solution</h2>
        
        <p><a data-type="indexterm" data-primary="class keyword" id="ix_class_keyword"></a><a data-type="indexterm" data-primary="classes" data-secondary="constructors and" id="idm45475160927864"></a><a data-type="indexterm" data-primary="constructors" data-secondary="classes and" id="idm45475160926920"></a>Use the <code>class</code> keyword, and give your class a name. Inside, add a constructor function that initializes your object. Here’s a complete <code>Person</code> class example:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Test the Person class by creating an object</code>
        <code class="c1">// The constructor is invoked when you use the new keyword with the class</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">firstName</code><code class="p">);</code>  <code class="c1">// 'Luke'</code></pre>
        
        <p><a data-type="indexterm" data-primary="methods" data-secondary="adding new" id="idm45475160829496"></a>In this example, the <code>Person</code> class is a simple package that bundles together two public fields (<code>firstName</code> and <code>lastName</code>). But it’s easy enough to add methods to your class, which work like functions but don’t include the <code>function</code> keyword. Here’s how you would code a <code>Person.swapNames()</code> method:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">,</code> <code class="nx">dateOfBirth</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="o">=</code> <code class="nx">dateOfBirth</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="c1">// This is a method</code>
          <code class="nx">swapNames</code><code class="p">()</code> <code class="p">{</code>
            <code class="c1">// Use a handy shortcut (destructuring assignment) to assign both</code>
            <code class="c1">// properties at once</code>
            <code class="p">[</code><code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="p">];</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Test the Person class</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">1990</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">22</code><code class="p">));</code>
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">swapNames</code><code class="p">();</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">firstName</code><code class="p">);</code>   <code class="c1">// 'Takei'</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475160789752">
        <h2>Discussion</h2>
        
        <p><a data-type="indexterm" data-primary="prototypes" id="idm45475160788632"></a>In essence of a JavaScript class is the constructor function. In fact, behind the scenes a JavaScript class <em>is</em> a constructor function, and all methods are attached to that function’s <em>prototype</em>. That means that a method like <code>Person.swapNames()</code> is shared between all the instances of the <code>Person</code> class, because they share the same prototype. (To dig deeper into this behind-the-scenes reality, check out the constructor pattern in <a data-type="xref" href="#constructor_pattern">“Using the Constructor Pattern to Make a Custom Class”</a>.)</p>
        
        <p>Classes have their own syntax requirements that you must follow:</p>
        
        <ul>
        <li>
        <p>Constructor functions are always named <code>constructor</code>.</p>
        </li>
        <li>
        <p>Neither constructors nor methods use the keyword <code>function</code>, although they are declared like functions in every other respect.</p>
        </li>
        </ul>
        
        <p><a data-type="indexterm" data-primary="functions" data-secondary="constructors and" id="idm45475160653000"></a><a data-type="indexterm" data-primary="this keyword" data-secondary="constructors" id="idm45475160652024"></a>When you write a constructor, you use <code>this</code> to create new public fields on the current object. You can then refer to these fields wherever you need them in your class methods, as long as you remember to always prefix the variable name with <code>this</code>. You can also access these fields outside of the class code, using the familiar dot syntax.</p>
        
        <p><a data-type="indexterm" data-primary="constructors" data-secondary="public versus private fields in" id="idm45475160649544"></a><a data-type="indexterm" data-primary="accessibility" data-secondary="public versus private fields in constructor" id="idm45475160648600"></a>You might wonder how you can change this accessibility—say, make your fields private and wrap them with public properties. The answer is that currently you can’t—at least, not without a home brew solution that introduces complications of its own. For a full discussion of the subject, see <a data-type="xref" href="#custom_class_properties">“Adding Properties to a Class”</a>.</p>
        
        <p><a data-type="indexterm" data-primary="class expression" id="idm45475160646072"></a>As with functions, JavaScript allows you to create classes in an <em>expression</em>. Here’s an example:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">personExpression</code> <code class="o">=</code> <code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// This won't work, because there is no Person class to be found in scope</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        
        <code class="c1">// This works because you can create a new instance of the variable that holds</code>
        <code class="c1">// the class expression</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">personExpression</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code></pre>
        
        <p>This is a specialized—but not rare—technique. It allows you to avoid adding a class to the current scope. For example, that might be useful in this example if you were worried that there might already be a definition for another <code>Person</code> class. (Another way to solve the problem of name collisions is by using modules, as described in <a data-type="xref" href="#using_es6_modules">“Organizing Your JavaScript Classes with Modules”</a>.)<a data-type="indexterm" data-primary="" data-startref="ix_class_keyword" id="idm45475160594392"></a></p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45475160593320">
        <h2>See Also</h2>
        
        <p>For the old-fashioned constructor pattern for object creation, see <a data-type="xref" href="#constructor_pattern">“Using the Constructor Pattern to Make a Custom Class”</a>. To see how to create class properties, refer to <a data-type="xref" href="#custom_class_properties">“Adding Properties to a Class”</a>. To learn how to connect classes in an inheritance relationship, see <a data-type="xref" href="#custom_class_inheritance">“Inheriting Functionality from Another Class”</a>.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Extra: Multiple Constructors"><div class="sect2" id="idm45475160537784">
        <h2>Extra: Multiple Constructors</h2>
        
        <p><a data-type="indexterm" data-primary="multiple constructors" id="ix_multiple_construct"></a><a data-type="indexterm" data-primary="constructors" data-secondary="classes and" id="ix_construct_class2"></a><a data-type="indexterm" data-primary="constructors" data-secondary="multiple" id="ix_construct_multi"></a><a data-type="indexterm" data-primary="classes" data-secondary="constructors and" id="ix_class_construct2"></a>In most object-oriented languages it’s possible to create multiple constructors, so the code that creates the class has a choice of what parameters to specify. But JavaScript doesn’t support constructor overloading or method overloading.</p>
        
        <p>This isn’t quite as limiting as it seems, because JavaScript is notoriously loose with function arguments and never forces you to supply them. So even though <code>Person</code> has a single three-argument constructor, these are all valid ways to create an instance without supplying every argument:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">noDatePerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        <code class="kr">const</code> <code class="nx">firstNamePerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">);</code>
        <code class="kr">const</code> <code class="nx">noDataPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">();</code></pre>
        
        <p>Every class has exactly one constructor, and it always runs. Even if you don’t specify any arguments when you create a <code>Person</code> object, the three-argument constructor still runs and sets <code>this.firstName</code>, <code>this.lastName</code>, and <code>this.birthDate</code> (all of which will be set to <code>undefined</code>). If this isn’t acceptable, you can set default parameter values, just as you do with ordinary functions (see <a data-type="xref" href="ch06.html#provide_default_parameter">“Providing a Default Parameter Value”</a>).</p>
        <div data-type="note" epub:type="note"><h6>Note</h6>
        <p>If you create a class without a constructor, JavaScript automatically gives it a blank no-argument constructor. This detail becomes significant if you decide to use class inheritance (<a data-type="xref" href="#custom_class_inheritance">“Inheriting Functionality from Another Class”</a>).</p>
        </div>
        
        <p><a data-type="indexterm" data-primary="object literal" id="idm45475160499896"></a><a data-type="indexterm" data-primary="objects (Object type)" data-secondary="literal" id="idm45475160499192"></a>Another way to deal with optional arguments is using an object literal that gets passed to the constructor. That way the caller can choose to set only the named properties they want to use:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">partialInfoPerson1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">({</code>
          <code class="nx">lastName</code><code class="o">:</code> <code class="s2">"Takei"</code><code class="p">,</code>
          <code class="nx">birthDate</code><code class="o">:</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">1990</code><code class="p">,</code> <code class="mi">04</code><code class="p">,</code> <code class="mi">23</code><code class="p">)</code>
        <code class="p">});</code>
        <code class="kr">const</code> <code class="nx">partialInfoPerson2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">({</code><code class="nx">firstName</code><code class="o">:</code> <code class="s1">'Luke'</code><code class="p">,</code> <code class="nx">lastName</code><code class="o">:</code> <code class="s1">'Takei'</code><code class="p">});</code></pre>
        
        <p>This is a common JavaScript design pattern that’s described in detail in <a data-type="xref" href="ch06.html#named_parameters">“Using Named Function Parameters”</a>. One advantage it provides is that you don’t need to worry about the order of properties in the object literal. A disadvantage is that there’s nothing to prevent you from accidentally creating incorrectly named parameters that will be silently ignored:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// The Person class will look for a firstName property in this object literal</code>
        <code class="c1">// It will quietly ignore the firstname property</code>
        <code class="kr">const</code> <code class="nx">partialInfoPerson2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">({</code><code class="nx">firstname</code><code class="o">:</code> <code class="s1">'Luke'</code><code class="p">});</code></pre>
        
        <p><a data-type="indexterm" data-primary="factory methods" id="idm45475160380504"></a><a data-type="indexterm" data-primary="methods" data-secondary="factory" id="idm45475160379672"></a>Another possible approach is to create a single constructor for your class, but add static methods that create differently configured instances of the object. Depending on the implementation, this is sometimes called the <em>builder pattern</em> or <em>factory pattern</em>. It’s described in <a data-type="xref" href="#factory_method">“Using a Static Method to Create Objects”</a>.<a data-type="indexterm" data-primary="" data-startref="ix_class_reusable" id="idm45475160390408"></a><a data-type="indexterm" data-primary="" data-startref="ix_reusable_class" id="idm45475160389432"></a><a data-type="indexterm" data-primary="" data-startref="ix_class_construct2" id="idm45475160388488"></a><a data-type="indexterm" data-primary="" data-startref="ix_construct_class2" id="idm45475160387544"></a><a data-type="indexterm" data-primary="" data-startref="ix_construct_multi" id="idm45475160386600"></a><a data-type="indexterm" data-primary="" data-startref="ix_multiple_construct" id="idm45475160385656"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Adding Properties to a Class"><div class="sect1" id="custom_class_properties">
        <h1>Adding Properties to a Class</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475160376216">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="properties" data-secondary="adding to class" id="ix_properties_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="adding properties to" id="ix_class_properties"></a>You want to add property getters and setters to wrap your class data.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475160372168">
        <h2>Solution</h2>
        
        <p>First, consider if properties are the best solution for your use case. (As explained in the discussion, they have well-known limitations and are slightly controversial.) If you decide to use properties, you can create <code>get</code> and <code>set</code> methods for each one. Here’s an example with a computed property, called <code>age</code>, which is calculated from the date stored in <code>this.dateOfBirth</code>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">,</code> <code class="nx">dateOfBirth</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="o">=</code> <code class="nx">dateOfBirth</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="c1">// This is a getter for the age property</code>
          <code class="nx">get</code> <code class="nx">age</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">if</code> <code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="k">instanceof</code> <code class="nb">Date</code><code class="p">)</code> <code class="p">{</code>
              <code class="c1">// Calculate the difference in years</code>
              <code class="kr">const</code> <code class="nx">today</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">();</code>
              <code class="kd">let</code> <code class="nx">age</code> <code class="o">=</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getFullYear</code><code class="p">()</code> <code class="o">-</code> <code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code><code class="p">.</code><code class="nx">getFullYear</code><code class="p">();</code>
        
              <code class="c1">// Adjust if the bithday hasn't happened yet this year</code>
              <code class="kr">const</code> <code class="nx">monthDiff</code> <code class="o">=</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getMonth</code><code class="p">()</code> <code class="o">-</code> <code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code><code class="p">.</code><code class="nx">getMonth</code><code class="p">();</code>
              <code class="k">if</code> <code class="p">(</code><code class="nx">monthDiff</code> <code class="o">&lt;</code> <code class="mi">0</code> <code class="o">||</code>
                 <code class="p">(</code><code class="nx">monthDiff</code> <code class="o">===</code> <code class="mi">0</code> <code class="o">&amp;&amp;</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getDate</code><code class="p">()</code> <code class="o">&lt;</code> <code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code><code class="p">.</code><code class="nx">getDate</code><code class="p">()))</code> <code class="p">{</code>
                <code class="nx">age</code> <code class="o">-=</code> <code class="mi">1</code><code class="p">;</code>
              <code class="p">}</code>
        
              <code class="k">return</code> <code class="nx">age</code><code class="p">;</code>
            <code class="p">}</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Test the Person class</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">1990</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">22</code><code class="p">));</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">age</code><code class="p">);</code></pre>
        
        <p>It’s up to you whether you include only a getter, only a setter, or both. Here’s an example that uses the property pattern to apply basic validation to the date of birth:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">,</code> <code class="nx">date</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
        
            <code class="c1">// Set the date using the property setter so a Person</code>
            <code class="c1">// can't be created in an invalid state</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="o">=</code> <code class="nx">date</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="c1">// Just return the date with no extra processing</code>
          <code class="nx">get</code> <code class="nx">dateOfBirth</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_dateOfBirth</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="c1">// Don't allow dates in the future</code>
          <code class="nx">set</code> <code class="nx">dateOfBirth</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">if</code> <code class="p">(</code><code class="nx">value</code> <code class="k">instanceof</code> <code class="nb">Date</code> <code class="o">&amp;&amp;</code> <code class="nx">value</code> <code class="o">&lt;</code> <code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">())</code> <code class="p">{</code>
              <code class="c1">// This is a valid date</code>
              <code class="k">this</code><code class="p">.</code><code class="nx">_dateOfBirth</code> <code class="o">=</code> <code class="nx">value</code><code class="p">;</code>
            <code class="p">}</code>
            <code class="k">else</code> <code class="p">{</code>
              <code class="k">throw</code> <code class="k">new</code> <code class="nx">TypeError</code><code class="p">(</code><code class="s1">'Birthdate needs to be a valid date in the past'</code><code class="p">);</code>
            <code class="p">}</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Test the date restrictions</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">1990</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">22</code><code class="p">));</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">dateOfBirth</code><code class="p">);</code>
        
        <code class="c1">// This change is allowed</code>
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2010</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">10</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">dateOfBirth</code><code class="p">);</code>
        
        <code class="c1">// This change causes an error</code>
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2035</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">10</code><code class="p">);</code></pre>
        <div data-type="note" epub:type="note"><h6>Note</h6>
        <p>This example throws an exception (<a data-type="xref" href="ch10.html#throwing_errors">“Throwing a Standard Error”</a>) to notify the caller when they attempt to set an invalid value. This is a reasonable design decision, but it’s not always the best choice. Having an error occur when setting a property (or even worse, when attempting to create a <code>Person</code> with an invalid date) is not expected behavior in JavaScript, and the potential error may not be anticipated by the calling code. (The alternative—silently ignoring the offending error—is also risky.) In the end, a better approach may be to use methods to supply potentially problematic data instead of properties.</p>
        </div>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475159930472">
        <h2>Discussion</h2>
        
        <p>There are many reasons you might consider creating property procedures. Some examples include:</p>
        
        <ul>
        <li>
        <p>To calculate a value (like <code>Person.age</code>)</p>
        </li>
        <li>
        <p>To transform a field into another representation</p>
        </li>
        <li>
        <p>To perform validation before updating a field</p>
        </li>
        <li>
        <p>To add hooks for some other service (like logging or testing) that should happen every time a field is read or set</p>
        </li>
        <li>
        <p>To use some kind of lazy initialization, which only creates or calculates a property value when it’s needed</p>
        </li>
        <li>
        <p>To expose a single property of an object that’s stored in a field</p>
        </li>
        </ul>
        
        <p>This recipe presents two examples. The <code>Person.age</code> property is a read-only computed property. The <code>Person.dateOfBirth</code> property is a settable property with <span class="keep-together">validation</span>.</p>
        
        <p>When you use properties, you must be careful to avoid name collisions. The field that stores the value cannot have the same name as the property or the constructor parameter. To understand why, let’s take a closer look at the <code>dateOfBirth</code> example. The constructor accepts a <code>date</code> parameter, which it sets like this:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="k">this</code><code class="p">.</code><code class="nx">dateOfBirth</code> <code class="o">=</code> <code class="nx">date</code><code class="p">;</code></pre>
        
        <p>At first glance, you might assume this statement stores the date in a public field named <code>this.dateOfBirth</code> (which is the usual pattern). But in this case, <code>this.dateOfBirth</code> refers to the <code>dateOfBirth</code> property. Its setter takes over:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="nx">set</code> <code class="nx">dateOfBirth</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">if</code> <code class="p">(</code><code class="nx">value</code> <code class="k">instanceof</code> <code class="nb">Date</code> <code class="o">&amp;&amp;</code> <code class="nx">value</code> <code class="o">&lt;</code> <code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">())</code> <code class="p">{</code>
          <code class="c1">// This is a valid date</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">_dateOfBirth</code> <code class="o">=</code> <code class="nx">value</code><code class="p">;</code>
        <code class="p">}</code>
        <code class="k">else</code> <code class="p">{</code>
          <code class="k">throw</code> <code class="k">new</code> <code class="nx">TypeError</code><code class="p">(</code><code class="s1">'Birthdate needs to be a valid date in the past'</code><code class="p">);</code>
        <code class="p">}</code></pre>
        
        <p>If the new value passes the test, it’s stored in a public field named <code>this._dateOfBirth</code>. The awkward naming is necessary, because both <code>this.dateOfBirth</code> (the property) and <code>this._dateOfBirth</code> (the field) have the same scope. If you use the same name for both, you’ll end up calling the wrong one (and triggering an infinite sequences of calls that will eventually overflow the stack).</p>
        
        <p><a data-type="indexterm" data-primary="_ (underscore character)" id="idm45475159842920"></a><a data-type="indexterm" data-primary="properties" data-secondary="keeping private" id="idm45475159842248"></a>The leading underscore in a variable name like <code>_dateOfBirth</code> has another purpose. Currently, JavaScript doesn’t have any way to create private fields. But the underscore signals that a field is <em>supposed</em> to be private to the class. Then, you trust that the calling code will avoid using this field. If you don’t follow this convention, you’re almost certain to run into a problem where the calling code accidentally uses the field instead of the property. And even if you <em>do</em> observe this pattern, there’s no guarantee that the calling code will follow it.</p>
        
        <p><a data-type="indexterm" data-primary="properties" data-secondary="versus methods" data-secondary-sortas="methods" id="idm45475159839160"></a><a data-type="indexterm" data-primary="methods" data-secondary="versus properties" data-secondary-sortas="properties" id="ix_method_property"></a>Many JavaScript developers argue that a more natural pattern in JavaScript is to use <code>setXxx()</code> and <code>getXxx()</code> methods:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">,</code> <code class="nx">date</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">setDateOfBirth</code><code class="p">(</code><code class="nx">date</code><code class="p">);</code>
          <code class="p">}</code>
        
          <code class="nx">getDateOfBirth</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_dateOfBirth</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">setDateOfBirth</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">if</code> <code class="p">(</code><code class="nx">value</code> <code class="k">instanceof</code> <code class="nb">Date</code> <code class="o">&amp;&amp;</code> <code class="nx">value</code> <code class="o">&lt;</code> <code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">())</code> <code class="p">{</code>
              <code class="c1">// This is a valid date</code>
              <code class="k">this</code><code class="p">.</code><code class="nx">_dateOfBirth</code> <code class="o">=</code> <code class="nx">value</code><code class="p">;</code>
            <code class="p">}</code>
            <code class="k">else</code> <code class="p">{</code>
              <code class="k">throw</code> <code class="k">new</code> <code class="nx">TypeError</code><code class="p">(</code><code class="s1">'Birthdate cannot be in the future'</code><code class="p">);</code>
            <code class="p">}</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">1990</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">22</code><code class="p">));</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">getDateOfBirth</code><code class="p">());</code>
        
        <code class="c1">// This change is allowed</code>
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">setDateOfBirth</code> <code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2010</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">10</code><code class="p">));</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">getDateOfBirth</code><code class="p">());</code>
        
        <code class="c1">// This change causes an error</code>
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">setDateOfBirth</code> <code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2035</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">10</code><code class="p">));</code></pre>
        
        <p>This approach is a bit more cumbersome, but it has some advantages. It makes it obvious that you’re calling a method and running code, not simply setting a variable. As a result, the calling code can expect exceptions from type-checking or other side effects. Methods also prevent problems like this:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// This isn't the property you want (that's dateOfBirth) but JavaScript</code>
        <code class="c1">//  creates it anyway, and you won't notice the mistake</code>
        <code class="nx">person</code><code class="p">.</code><code class="nx">DateOfBirth</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2035</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">10</code><code class="p">);</code>
        
        <code class="c1">// You can't call a function that doesn't exist, so this typo</code>
        <code class="c1">// ("Data" instead of "Date") always fails and won't be ignored</code>
        <code class="nx">person</code><code class="p">.</code><code class="nx">setDataOfBirth</code><code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2035</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">10</code><code class="p">));</code></pre>
        <div data-type="note" epub:type="note"><h6>Note</h6>
        <p>Both the <a href="https://google.github.io/styleguide/jsguide.html">Google JavaScript Style Guide</a> and the often-consulted <a href="https://github.com/airbnb/javascript">Airbnb JavaScript Style Guide</a> discourage the usage of property getters and setters but allow <code>setXxx()</code> and <code>getXxx()</code> methods.</p>
        </div>
        
        <p><a data-type="indexterm" data-primary="defineProperty() method" id="idm45475159489176"></a>There’s one more wrinkle to consider with properties. Behind the scenes, JavaScript uses the <code>Object.defineProperty()</code> method to implement your property getters and setters. Most of the time, that works perfectly well. However, there are specialized cases when you may decide to use <code>defineProperty()</code> because it allows you to configure metadata details you can’t otherwise set. For example, if you want to make a property nonconfigurable (so its implementation can’t be altered) or nonenumerable (so it won’t show up in a <code>for...in</code> loop), you need to explicitly call <code>defineProperty()</code>. In this situation, the usual approach is to call <code>defineProperty</code> in the constructor.<a data-type="indexterm" data-primary="" data-startref="ix_method_property" id="idm45475159485544"></a><a data-type="indexterm" data-primary="" data-startref="ix_property_method" id="idm45475159484536"></a></p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45475159929848">
        <h2>See Also</h2>
        
        <p>If you want to use property procedures to react to property changes and trigger other actions (like logging), consider using proxies instead (<a data-type="xref" href="ch07.html#modifications_with_proxies">“Intercepting and Changing Actions on an Object <span class="keep-together">with a Proxy</span>”</a>). For more about creating properties with <code>Object.defineProperty()</code>, see <a data-type="xref" href="ch07.html#creating_properties_with_define_property">“Customizing the Way a Property Is Defined”</a>.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Extra: Private Fields"><div class="sect2" id="private_fields">
        <h2>Extra: Private Fields</h2>
        
        <p><a data-type="indexterm" data-primary="private class fields" id="idm45475159478088"></a>Currently, JavaScript does not have a way to make member variables (those created with <code>this</code>) private. Many workarounds are used, and many of them are dangerously creative. The most popular implementation uses a <code>WeakMap</code> to store internal data. It works, but it adds a dangerous layer of extra homemade complexity.</p>
        
        <p><a data-type="indexterm" data-primary="_ (underscore character)" id="idm45475159475912"></a>A better approach is to use the underscore convention (like <code>_firstName</code>) to name fields that should not be accessed outside a class. In the future, JavaScript will patch this gap and adopt some version of the <a href="https://github.com/tc39/proposal-class-fields"><em>private class fields</em> proposal</a>. <a data-type="indexterm" data-primary="# (private field)" id="idm45475159473576"></a>Right now, the private field syntax uses a <code>#</code> to identify private fields, which can be declared at the beginning of your class block, making your class self documenting. Here’s what that looks like:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// A likely implementation of private field syntax in the near future</code>
        <code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="err">#</code><code class="nx">firstName</code><code class="p">;</code>
          <code class="err">#</code><code class="nx">lastName</code><code class="p">;</code>
        
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="err">#</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="err">#</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="c1">// Wrap the fields in properties</code>
            <code class="nx">get</code> <code class="nx">firstName</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="err">#</code><code class="nx">firstName</code><code class="p">;</code>
          <code class="p">}</code>
          <code class="nx">set</code> <code class="nx">firstName</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="err">#</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">get</code> <code class="nx">lastName</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="err">#</code><code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
          <code class="nx">set</code> <code class="nx">lastName</code><code class="p">(</code><code class="nx">name</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="err">#</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p><a data-type="indexterm" data-primary="Babel" id="idm45475159575672"></a>If you want to experiment with these features today, you can use <a href="https://babeljs.io">Babel</a> to transpile your code, although be aware that the syntax may change.</p>
        
        <p>Interestingly, this is one case where JavaScript classes have <em>less</em> functionality than the old-fashioned constructor pattern (<a data-type="xref" href="#constructor_pattern">“Using the Constructor Pattern to Make a Custom Class”</a>). That’s because the constructor pattern can use closures to store private variables, as explained in <a data-type="xref" href="ch06.html#create_a_function_that_remembers_its_sta">“Creating a Function That Stores its State <span class="keep-together">with a Closure</span>”</a>.<a data-type="indexterm" data-primary="" data-startref="ix_class_properties" id="idm45475159427912"></a><a data-type="indexterm" data-primary="" data-startref="ix_properties_class" id="idm45475159426936"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Giving a Class a Better String Representation"><div class="sect1" id="better_object_string_representation">
        <h1>Giving a Class a Better String Representation</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475159424472">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="strings (String object)" data-seealso="regular expressions" id="idm45475159423272"></a><a data-type="indexterm" data-primary="classes" data-secondary="string representation" id="idm45475159422296"></a><a data-type="indexterm" data-primary="strings (String object)" data-secondary="providing better representation for class" id="idm45475159421352"></a>You want to choose a suitable text representation that will be used for your object when it’s converted to a string.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475159419800">
        <h2>Solution</h2>
        
        <p><a data-type="indexterm" data-primary="toString() method" data-secondary="classes and" id="idm45475159418632"></a>Add a method named <code>toString()</code> to your class and return the string you want to use:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">toString</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="sb">`</code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="si">}</code><code class="sb">, </code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="si">}</code><code class="sb">`</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">toString</code><code class="p">());</code>   <code class="c1">// 'Takei, Luke'</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475159414472">
        <h2>Discussion</h2>
        
        <p>The default implementation of <code>toString()</code> for all objects displays the unhelpful text <code>[object Object]</code>. You can set your own text by adding a <code>toString()</code> method.</p>
        
        <p>The <code>toString()</code> method can be called explicitly (as in this example), or it can be called implicitly when your object is converted to a string. For example, if you concatenate your object with a string, <code>toString()</code> is called automatically:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        <code class="kr">const</code> <code class="nx">message</code> <code class="o">=</code> <code class="s1">'The name is '</code> <code class="o">+</code> <code class="nx">newPerson</code><code class="p">;</code>
        
        <code class="c1">// Now message = 'The name is Takei, Luke'</code>
        <code class="c1">// which is much better than 'The name is [object Object]'</code></pre>
        
        <p><a data-type="indexterm" data-primary="console.log() method" id="idm45475159274072"></a>However, calling <code>console.log()</code> on an object, on its own, does not trigger your <code>toString()</code>. That’s because <code>console.log()</code> has an extra bit of logic that iterates over the properties of your object and uses that to build its own custom string. You can get around this by calling <code>toString()</code> yourself, or using a template literal (<a data-type="xref" href="ch02.html#using_template_literals">“Using Template Literals for Clearer String Concatenation”</a>). Here’s a comparison:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">);</code>       <code class="c1">// 'Person {firstName: "Luke", lastName: "Takei"}'</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">newPerson</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>  <code class="c1">// 'Takei, Luke'</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="o">+</code><code class="s1">''</code><code class="p">);</code>    <code class="c1">// 'Takei, Luke'</code></pre>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Using the Constructor Pattern to Make a Custom Class"><div class="sect1" id="constructor_pattern">
        <h1>Using the Constructor Pattern to Make a Custom Class</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475159163160">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="custom classes, constructor pattern in making" id="ix_custom_class_construct"></a><a data-type="indexterm" data-primary="constructors" data-secondary="classes and" id="ix_construct_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="constructors and" id="ix_class_construct"></a>You want to create a reusable, class-like entity in your code. You want to use the traditional constructor pattern because it matches your existing code.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475159157960">
        <h2>Solution</h2>
        
        <p>The constructor pattern is a slightly dated but still acceptable pattern for object creation. Even if you plan to use formal classes (<a data-type="xref" href="#using_es6_classes">“Creating a Reusable Class”</a>), it’s worth knowing the constructor pattern, because you’re likely to encounter it out in the wild. It can also help you understand how JavaScript classes work.</p>
        
        <p><a data-type="indexterm" data-primary="function constructor" id="ix_function_construct"></a>Here’s one of the <code>Person</code> class examples from <a data-type="xref" href="#using_es6_classes">“Creating a Reusable Class”</a>, but written as a function with the constructor pattern:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
          <code class="c1">// Store public data using 'this'</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
        
          <code class="c1">// Add a nested function to represent a method</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">swapNames</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
            <code class="p">[</code><code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="p">];</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Create a Person object</code>
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">firstName</code><code class="p">);</code>  <code class="c1">// 'Luke'</code>
        
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">swapNames</code><code class="p">();</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">firstName</code><code class="p">);</code>  <code class="c1">// 'Takei'</code></pre>
        
        <p><a data-type="indexterm" data-primary="function objects" id="ix_function_object"></a>Notice that the code for using a function-based object is the same as the code for using a class-based with an identical constructor. As a result, you can usually migrate code from the constructor pattern to formal classes without disrupting the rest of your application.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475159149112">
        <h2>Discussion</h2>
        
        <p><a data-type="indexterm" data-primary="new keyword" id="idm45475159021672"></a>Classes were a relative latecomer to the JavaScript language. Before they existed, developers used functions in their place. This works because JavaScript allows you to create new <em>instances</em> of a function (function objects) using the <code>new</code> keyword. <a data-type="indexterm" data-primary="scope" id="idm45475159019848"></a>Every function gets its own scope, with its own local data.</p>
        
        <p>The constructor pattern exists in several variants. The most common approach is to create a function with the name of your “class” and accept all the constructor parameters you need to create an instance. Inside your function, you use <code>this</code> to create public fields. You can also create ordinary variables, which won’t be visible to outside code, and are only usable by the constructor and any nested functions.</p>
        
        <p><a data-type="indexterm" data-primary="functions" data-secondary="method-like" id="idm45475159017448"></a><a data-type="indexterm" data-primary="methods" data-secondary="creating method-like functions" id="idm45475159016472"></a>There are two common ways to create method-like functions. The approach shown here creates each method using a function expression, and makes them publicly accessible with <code>this</code>. Because the method functions are wrapped inside the constructor function, they have the same scope as the constructor, and they have access to all the same variables and local variables. (Technically, the constructor function creates a closure, as explained in <a data-type="xref" href="ch06.html#create_a_function_that_remembers_its_sta">“Creating a Function That Stores its State <span class="keep-together">with a Closure</span>”</a>.)</p>
        
        <p><a data-type="indexterm" data-primary="prototypes" id="ix_prototype1"></a>The other way to create methods is to explicitly add them to the <em>prototype</em> of your constructor function. If you haven’t encountered prototypes yet, they’re a basic (but mostly hidden) ingredient that allows objects to share functionality. When you attempt to call a method (like <code>Person.swapNames()</code>), JavaScript looks for the <code>swapNames()</code> function in the <code>Person</code> constructor. <a data-type="indexterm" data-primary="prototype chain" id="idm45475159010216"></a>If it doesn’t find it, JavaScript looks for a <code>swapNames()</code> function in the prototype. The process gets a bit more involved when inheritance is involved, because JavaScript will search an entire <em>prototype chain</em> looking for a function, as explained in <a data-type="xref" href="#custom_class_inheritance">“Inheriting Functionality from Another Class”</a>.</p>
        
        <p>So how do you add a function to a prototype? You can do it directly, using the <code>prototype</code> property:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
        <code class="p">}</code>
        
        <code class="c1">// Add function to the Person prototype to represent a method</code>
        <code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">swapNames</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
          <code class="p">[</code><code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code><code class="p">];</code>
        <code class="p">}</code>
        
        <code class="kr">const</code> <code class="nx">newPerson</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">);</code>
        <code class="nx">newPerson</code><code class="p">.</code><code class="nx">swapNames</code><code class="p">();</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">newPerson</code><code class="p">.</code><code class="nx">firstName</code><code class="p">);</code>  <code class="c1">// 'Takei'</code></pre>
        
        <p>This example behaves mostly the same as the version with the nested constructor functions. But there is a difference. Before, the <code>swapNames()</code> existed independently in each <code>Person</code> object. Now, there is a single <code>swapNames()</code> function set in the prototype and shared among all <code>Person</code> instances. This is important if you plan to create an inheritance relationship linking prototypes together (see <a data-type="xref" href="#prototype_chains">“Extra: Prototype Chains”</a>). It’s also significant if you attempt to use private variables with a closure (<a data-type="xref" href="ch06.html#create_a_function_that_remembers_its_sta">“Creating a Function That Stores its State <span class="keep-together">with a Closure</span>”</a>), because functions attached to the prototype don’t exist in the same context as the constructor function, and won’t have access to private variables defined in the constructor.</p>
        <div data-type="caution"><h6>Caution</h6>
        <p><a data-type="indexterm" data-primary="objects (Object type)" data-secondary="altering behavior with prototypes" id="idm45475158899032"></a>Using prototypes, you can alter the behavior of built-in JavaScript objects. For example, you can add functionality to the base <code>Array</code> or <code>String</code> types. This sounds like a nifty feature, but it’s rife with complications and is strongly discouraged (except perhaps for building frameworks). Blurring the distinction between standard and custom code invites confusion, and creates the possibility for nonstandard patterns, poorly optimized code, and hidden mistakes. It can also fail outright if more than one person attempts to extend a built-in object with the same name.</p>
        </div>
        
        <p><a data-type="indexterm" data-primary="this keyword" data-secondary="classes" id="idm45475158896120"></a><a data-type="indexterm" data-primary="new keyword" id="idm45475158895144"></a>It’s interesting to compare the constructor pattern to the <code>class</code> keyword shown in <a data-type="xref" href="#using_es6_classes">“Creating a Reusable Class”</a>. Most of the code is exactly the same in both examples:</p>
        
        <ul>
        <li>
        <p>You write a constructor function that accepts parameters and initializes your object.</p>
        </li>
        <li>
        <p>You use the <code>this</code> keyword to create publicly accessible fields.</p>
        </li>
        <li>
        <p>You use the <code>new</code> keyword when creating the object (only now it’s technically an instance of a function, not a class).</p>
        </li>
        </ul>
        
        <p>But there are also some subtle differences, most obviously in syntax. In the constructor pattern there are no dedicated properties, and methods are declared separately, not nested in the constructor or explicitly attached to the constructor’s prototype (although that’s exactly what happens at runtime).</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45475159022360">
        <h2>See Also</h2>
        
        <p><a data-type="xref" href="#using_es6_classes">“Creating a Reusable Class”</a> demonstrates the preferred way to create a custom object template in modern JavaScript, which is using the <code>class</code> keyword.<a data-type="indexterm" data-primary="" data-startref="ix_class_construct" id="idm45475158885832"></a><a data-type="indexterm" data-primary="" data-startref="ix_construct_class" id="idm45475158884824"></a><a data-type="indexterm" data-primary="" data-startref="ix_custom_class_construct" id="idm45475158883880"></a><a data-type="indexterm" data-primary="" data-startref="ix_function_construct" id="idm45475158882968"></a><a data-type="indexterm" data-primary="" data-startref="ix_function_object" id="idm45475158882024"></a><a data-type="indexterm" data-primary="" data-startref="ix_prototype1" id="idm45475158881080"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Supporting Method Chaining in Your Class"><div class="sect1" id="chaining_object_methods">
        <h1>Supporting Method Chaining in Your Class</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475158878392">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="method chaining" id="ix_method_chaining"></a><a data-type="indexterm" data-primary="chaining, method" id="ix_chain_method"></a><a data-type="indexterm" data-primary="classes" data-secondary="method chaining support" id="ix_class_chaining"></a>You want to define your class methods in such a way that several methods can be called in quick succession, in a single statement.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475158873528">
        <h2>Solution</h2>
        
        <p>Make sure to return the current object at the end of each method that should support method chaining. In a custom class, this is usually as simple as adding a <code>return this</code> statement.</p>
        
        <p>Here’s an example of a custom <code>Book</code> object with two methods, <code>raisePrice()</code> and <code>releaseNewEdition()</code>, both of which use method chaining:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">price</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">price</code> <code class="o">=</code> <code class="nx">price</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="nx">publishedDate</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">raisePrice</code><code class="p">(</code><code class="nx">percent</code><code class="p">)</code> <code class="p">{</code>
            <code class="kr">const</code> <code class="nx">increase</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">price</code><code class="o">*</code><code class="nx">percent</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">price</code> <code class="o">+=</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">round</code><code class="p">(</code><code class="nx">increase</code><code class="p">)</code><code class="o">/</code><code class="mi">100</code><code class="p">;</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">releaseNewEdition</code><code class="p">()</code> <code class="p">{</code>
            <code class="c1">// Set the pulishedDate to today</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">();</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">const</code> <code class="nx">book</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="s1">'I Love Mathematics'</code><code class="p">,</code> <code class="s1">'Adam Up'</code><code class="p">,</code> <code class="mf">15.99</code><code class="p">,</code>
         <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2010</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>
        
        <code class="c1">// Raise the price 15% and then change the edition, using method chaining</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">book</code><code class="p">.</code><code class="nx">raisePrice</code><code class="p">(</code><code class="mi">15</code><code class="p">).</code><code class="nx">releaseNewEdition</code><code class="p">());</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475158867592">
        <h2>Discussion</h2>
        
        <p>The ability to directly call one method on the result of another method, in a single code statement, is known as <em>method chaining</em>. Here’s an example with a string and the <code>replaceAll()</code> method. Because <code>replaceAll()</code> returns a new string, you can call <code>replaceAll()</code> again on that string, and get a <em>third</em> string:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">safePieceOfHtml</code> <code class="o">=</code>
         <code class="nx">originalPieceOfHtml</code><code class="p">.</code><code class="nx">replaceAll</code><code class="p">(</code><code class="s1">'&lt;'</code><code class="p">,</code> <code class="s1">'&amp;lt;'</code><code class="p">).</code><code class="nx">replaceAll</code><code class="p">(</code><code class="s1">'&gt;'</code><code class="p">,</code> <code class="s1">'&amp;gt;'</code><code class="p">);</code></pre>
        
        <p><a data-type="indexterm" data-primary="arrays (Array object)" data-secondary="joining" id="idm45475158634552"></a><a data-type="indexterm" data-primary="joining arrays" id="idm45475158670600"></a>Method chaining doesn’t have to be with the same method. It works with any method that returns an object. Consider how this code joins two arrays and then sorts the resulting array by chaining a call to <code>concat()</code> with one to <code>sort()</code>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">evens</code> <code class="o">=</code> <code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">8</code><code class="p">];</code>
        <code class="kr">const</code> <code class="nx">odds</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">7</code><code class="p">,</code> <code class="mi">9</code><code class="p">];</code>
        
        <code class="kr">const</code> <code class="nx">evensAndOdds</code> <code class="o">=</code> <code class="nx">evens</code><code class="p">.</code><code class="nx">concat</code><code class="p">(</code><code class="nx">odds</code><code class="p">).</code><code class="nx">sort</code><code class="p">();</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">evensAndOdds</code><code class="p">);</code>  <code class="c1">// [1, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>
        
        <p>Chaining is used extensively in built-in JavaScript objects and in many JavaScript libraries and frameworks. To use this pattern in your own classes, you simply return a reference to <code>this</code> at the end of your method. The calling code can then ignore this reference, or use it to perform method chaining.</p>
        
        <p>In the current example, calling a method on <code>Book</code> changes the object and returns a reference to the changed object. The caller can ignore the return value, because they already have a reference to the <code>Book</code> object. However, many functional programming purists do something different. They write methods that return a changed object <em>copy</em>, while keeping the original object unchanged. Here’s how you’d implement this pattern:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">price</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">price</code> <code class="o">=</code> <code class="nx">price</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="nx">publishedDate</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">getRaisedPriceBook</code><code class="p">(</code><code class="nx">percent</code><code class="p">)</code> <code class="p">{</code>
            <code class="kr">const</code> <code class="nx">increase</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">price</code><code class="o">*</code><code class="nx">percent</code><code class="p">;</code>
            <code class="k">return</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">title</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">author</code><code class="p">,</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">round</code><code class="p">(</code><code class="nx">increase</code><code class="p">)</code><code class="o">/</code><code class="mi">100</code><code class="p">,</code>
             <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code><code class="p">);</code>
          <code class="p">}</code>
        
          <code class="nx">getNewEdition</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">title</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">author</code><code class="p">,</code> <code class="k">this</code><code class="p">.</code><code class="nx">price</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">());</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>This pattern doesn’t affect the way method chaining works, but it does mean the caller needs to take the return value, or they won’t see the changes.<a data-type="indexterm" data-primary="" data-startref="ix_class_chaining" id="idm45475158552408"></a><a data-type="indexterm" data-primary="" data-startref="ix_method_chaining" id="idm45475158426808"></a><a data-type="indexterm" data-primary="" data-startref="ix_chain_method" id="idm45475158425896"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Adding Static Methods to a Class"><div class="sect1" id="creating_static_methods">
        <h1>Adding Static Methods to a Class</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475158423400">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="methods" data-secondary="adding to class" id="ix_methods_class"></a><a data-type="indexterm" data-primary="static methods" data-secondary="adding to class" id="ix_static_meth_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="adding static methods to" id="ix_class_static_meth"></a>You want to create a utility method that’s tied to your class, but can be called without creating an object.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475158418040">
        <h2>Solution</h2>
        
        <p><a data-type="indexterm" data-primary="static keyword" id="idm45475158416632"></a>Place the <code>static</code> keyword before the method. Make sure your method doesn’t attempt to use any instance fields, properties, or methods. Here’s an example with a static method named <code>Book.isEqual()</code>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">isbn</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">isbn</code> <code class="o">=</code> <code class="nx">isbn</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="nx">publishedDate</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="kr">static</code> <code class="nx">isEqual</code><code class="p">(</code><code class="nx">book</code><code class="p">,</code> <code class="nx">otherBook</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">if</code> <code class="p">(</code><code class="nx">book</code> <code class="k">instanceof</code> <code class="nx">Book</code> <code class="o">&amp;&amp;</code> <code class="nx">otherBook</code> <code class="k">instanceof</code> <code class="nx">Book</code><code class="p">)</code> <code class="p">{</code>
              <code class="c1">// Books are deemed equal if their ISBNs match,</code>
              <code class="c1">// irrespective of dashes</code>
              <code class="k">return</code> <code class="p">(</code><code class="nx">book</code><code class="p">.</code><code class="nx">isbn</code><code class="p">.</code><code class="nx">replaceAll</code><code class="p">(</code><code class="s1">'-'</code><code class="p">,</code><code class="s1">''</code><code class="p">)</code> <code class="o">===</code> <code class="nx">otherBook</code><code class="p">.</code><code class="nx">isbn</code><code class="p">.</code><code class="nx">replaceAll</code><code class="p">(</code><code class="s1">'-'</code><code class="p">,</code><code class="s1">''</code><code class="p">));</code>
            <code class="p">}</code>
            <code class="k">else</code> <code class="p">{</code>
              <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>
            <code class="p">}</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>You access a static method through the class name (as in <code>Book.isEqual()</code>). You can’t access it through an object variable.</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">firstPrinting</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="s1">'978-3-16-148410-0'</code><code class="p">,</code> <code class="s1">'A.I. Is Not a Threat'</code><code class="p">,</code>
         <code class="s1">'Anne Droid'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2019</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">2</code><code class="p">));</code>
        <code class="kr">const</code> <code class="nx">secondPrinting</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="s1">'978-3-16-148410-0'</code><code class="p">,</code> <code class="s1">'A.I. Is Not a Threat'</code><code class="p">,</code>
         <code class="s1">'A. Droid'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">2021</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">10</code><code class="p">));</code>
        
        <code class="c1">// Compare the books with the static method</code>
        <code class="kr">const</code> <code class="nx">sameBook</code> <code class="o">=</code> <code class="nx">Book</code><code class="p">.</code><code class="nx">isEqual</code><code class="p">(</code><code class="nx">firstPrinting</code><code class="p">,</code> <code class="nx">secondPrinting</code><code class="p">);</code>
        <code class="c1">// sameBook = true</code>
        
        <code class="c1">// This doesn't work, because isEqual isn't available in Book instances</code>
        <code class="nx">sameBook</code> <code class="o">=</code> <code class="nx">firstPrinting</code><code class="p">.</code><code class="nx">isEqual</code><code class="p">(</code><code class="nx">firstPrinting</code><code class="p">,</code> <code class="nx">secondPrinting</code><code class="p">);</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475158270376">
        <h2>Discussion</h2>
        
        <p>Static methods have functionality that’s logically related to a class, but not tied to a specific instance. The <code>Array.isArray()</code> method is a good example—it lets you test whether any object is an array, without forcing you to create an array object first. Occasionally, classes are made up entirely of static methods. JavaScript’s <code>Math</code> class is a good example.</p>
        
        <p>In the current example, you might want to give the <code>Book</code> class static methods related to processing or verifying ISBNs. You can also use static methods to make decisions about how objects of a certain class should be copied or compared. The solution demonstrates this principle with a static <code>isEqual()</code> method. You could also add a <code>compare()</code> method that would let you sort your objects in array (as shown in <a data-type="xref" href="ch05.html#sorting_array">“Sorting an Array of Objects by a Property Value”</a>).</p>
        
        <p><a data-type="indexterm" data-primary="this keyword" data-secondary="classes" id="idm45475158146216"></a><a data-type="indexterm" data-primary="this keyword" data-secondary="static methods" id="idm45475158145240"></a>In a static method, <code>this</code> refers to the current class, not an object instance. This can lead to problems, because your code will still be allowed to store data in <code>this</code> (or retrieve it). It just might not have the effect you expect. Essentially, everything in the static <code>this</code> acts like a class-scoped global variable, which is best avoided.</p>
        <div data-type="tip"><h6>Tip</h6>
        <p>If you want one static method to call another static method, you can use the <code>this</code> keyword. For example, if you want to call the static <code>isEqual()</code> from another static method in the <code>Book</code> class, you can refer to it as <code>Book.isEqual()</code> or <code>this.isEqual()</code>, which may be clearer.</p>
        </div>
        
        <p>Property <code>set</code> and <code>get</code> methods can also be static, although their usage is sometimes controversial. For example, you can use a static getter to store a constant, like this:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">isbn</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">isbn</code> <code class="o">=</code> <code class="nx">isbn</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="nx">publishedDate</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="c1">// Create a static, read-only Books.isnbnPrefix property</code>
          <code class="kr">static</code> <code class="nx">get</code> <code class="nx">isbnPrefix</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="s1">'978-1'</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>You can write a static setter, which acts like a global variable in your application. However, because there’s no static constructor, you’ll be forced to run code somewhere to assign the initial value. This isn’t particularly clear, so a <a href="https://oreil.ly/7O28H">new static property syntax is under development</a>, and currently supported by more modern browser versions. It allows you to set a public static property using a variable-like syntax:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="c1">// Create a static Book.isbnPrefix property</code>
          <code class="kr">static</code> <code class="nx">isbnPrefix</code> <code class="o">=</code> <code class="s1">'978-1'</code><code class="p">;</code>
        
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">isbn</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">isbn</code> <code class="o">=</code> <code class="nx">isbn</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="nx">publishedDate</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>However, it’s best to avoid this language feature altogether—or at least until some future data when its use in JavaScript is more normative.<a data-type="indexterm" data-primary="" data-startref="ix_class_static_meth" id="idm45475158021688"></a><a data-type="indexterm" data-primary="" data-startref="ix_static_meth_class" id="idm45475157966392"></a><a data-type="indexterm" data-primary="" data-startref="ix_methods_class" id="idm45475157965480"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Using a Static Method to Create Objects"><div class="sect1" id="factory_method">
        <h1>Using a Static Method to Create Objects</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475157963112">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="methods" data-secondary="creating objects" id="ix_methods_object"></a><a data-type="indexterm" data-primary="classes" data-secondary="creating objects with static method" id="ix_class_obj_static_meth"></a><a data-type="indexterm" data-primary="objects (Object type)" data-secondary="creating with static method" id="ix_object_static_meth"></a><a data-type="indexterm" data-primary="static methods" data-secondary="creating objects" id="ix_static_meth_object"></a>You want to create a method that generates a preconfigured object, possibly to get around JavaScript’s single-constructor limitation.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475157956584">
        <h2>Solution</h2>
        
        <p>Add a static method to your class that creates and returns the object you want. Here’s an example with a <code>Book</code> class that you can create through the constructor or through the static <code>Book.createSequel()</code> method:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="kr">static</code> <code class="nx">createSequel</code><code class="p">(</code><code class="nx">prevBook</code><code class="p">,</code> <code class="nx">title</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">prevBook</code><code class="p">.</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">prevBook</code><code class="p">.</code><code class="nx">lastName</code><code class="p">);</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>Here’s how you use the static method:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// Create a Book with the usual constructor</code>
        <code class="kr">const</code> <code class="nx">book</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="s1">'Good Design'</code><code class="p">,</code> <code class="s1">'Polly'</code><code class="p">,</code> <code class="s1">'Morfissim'</code><code class="p">);</code>
        
        <code class="c1">// Create a sequel with the static method</code>
        <code class="kr">const</code> <code class="nx">sequel</code> <code class="o">=</code> <code class="nx">Book</code><code class="p">.</code><code class="nx">createSequel</code><code class="p">(</code><code class="nx">book</code><code class="p">,</code> <code class="s1">'Even Gooder Design'</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sequel</code><code class="p">);</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475157865896">
        <h2>Discussion</h2>
        
        <p><a data-type="indexterm" data-primary="now() property" id="idm45475157832296"></a><a data-type="indexterm" data-primary="patterns" data-secondary="building creational" id="idm45475157831368"></a>Using static methods, you can implement different types of <em>creational</em> patterns—basically, patterns that help you create preconfigured instances of a class. For example, the JavaScript <code>Date</code> class has a <code>now()</code> property that returns a new <code>Date</code> object that’s automatically set to the current date and time.</p>
        
        <p>This approach is particularly suited to creating more complex combinations of objects. For example, you could extend the previous example with a <code>Book.createTrilogy()</code> method to get an array of three <code>Book</code> objects. In this example, the <code>Book</code> objects share a single <code>Author</code> object, which means that if you update the <code>Author</code> object, all the <code>Book</code> instances that link to it see the change:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Author</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="kr">static</code> <code class="nx">createSequel</code><code class="p">(</code><code class="nx">prevBook</code><code class="p">,</code> <code class="nx">title</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">prevBook</code><code class="p">.</code><code class="nx">author</code><code class="p">);</code>
          <code class="p">}</code>
        
          <code class="kr">static</code> <code class="nx">createTrilogy</code><code class="p">(</code><code class="nx">author</code><code class="p">,</code> <code class="nx">title1</code><code class="p">,</code> <code class="nx">title2</code><code class="p">,</code> <code class="nx">title3</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">return</code> <code class="p">[</code><code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="nx">title1</code><code class="p">,</code> <code class="nx">author</code><code class="p">),</code>
              <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="nx">title2</code><code class="p">,</code> <code class="nx">author</code><code class="p">),</code>
              <code class="k">new</code> <code class="nx">Book</code><code class="p">(</code><code class="nx">title3</code><code class="p">,</code> <code class="nx">author</code><code class="p">)];</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Create a trilogy of three books with a factory method</code>
        <code class="kr">const</code> <code class="nx">author</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Author</code><code class="p">(</code><code class="s1">'Koh'</code><code class="p">,</code><code class="s1">'Der'</code><code class="p">);</code>
        <code class="kr">const</code> <code class="nx">books</code> <code class="o">=</code> <code class="nx">Book</code><code class="p">.</code><code class="nx">createTrilogy</code><code class="p">(</code><code class="nx">author</code><code class="p">,</code> <code class="s1">'A Sea of Fire'</code><code class="p">,</code> <code class="s1">'A Sea of Ice'</code><code class="p">,</code>
         <code class="s1">'A Sea of Water'</code><code class="p">);</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">books</code><code class="p">);</code></pre>
        
        <p>Unlike constructors, there’s no limit to how many static methods you can add to support different object-creation scenarios.</p>
        <div data-type="note" epub:type="note"><h6>Note</h6>
        <p>Sometimes these static methods are called <em>factory methods</em>, although that description isn’t technically precise. In object-oriented design theory, the factory pattern is used when you don’t know the exact type of object you’re creating. For example, you might write a <code>createBook()</code> method that examines the arguments you supply and returns an instance of either the <code>TechBook</code> class or the <code>FictionBook</code> class, both of which inherit from a base <code>Book</code> class. It’s possible to implement this design in JavaScript, too, but opinions are mixed about how well the language handles the heavier weight of this sort of classical OOP abstraction.<a data-type="indexterm" data-primary="" data-startref="ix_static_meth_object" id="idm45475157592616"></a><a data-type="indexterm" data-primary="" data-startref="ix_object_static_meth" id="idm45475157591640"></a><a data-type="indexterm" data-primary="" data-startref="ix_class_obj_static_meth" id="idm45475157590696"></a><a data-type="indexterm" data-primary="" data-startref="ix_methods_object" id="idm45475157589736"></a></p>
        </div>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Inheriting Functionality from Another Class"><div class="sect1" id="custom_class_inheritance">
        <h1>Inheriting Functionality from Another Class</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475157587208">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="inheritance" id="ix_inherit_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="inheriting functionality from another class" id="ix_class_inherit"></a>You want to create a custom class that inherits the functionality of another class.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475157583336">
        <h2>Solution</h2>
        
        <p><a data-type="indexterm" data-primary="extends keyword" id="idm45475157581896"></a><a data-type="indexterm" data-primary="parent and child classes" id="ix_par_child_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="parent and child" id="ix_class_par_child"></a>With inheritance, one or more <em>child</em> classes derive from a <em>parent</em> class. To model this in code, you use the <code>extends</code> keyword when you declare the child class:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">public</code> <code class="kr">class</code> <code class="nx">SomeChild</code> <code class="kr">extends</code> <code class="nx">SomeParent</code> <code class="p">{</code>
        
        <code class="p">}</code></pre>
        
        <p>Here’s an example with a <code>Triangle</code> class that inherits from a more basic parent class named <code>Shape</code>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// This is the parent class</code>
        <code class="kr">class</code> <code class="nx">Shape</code> <code class="p">{</code>
          <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// This is a child class</code>
        <code class="kr">class</code> <code class="nx">Triangle</code> <code class="kr">extends</code> <code class="nx">Shape</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">base</code><code class="p">,</code> <code class="nx">height</code><code class="p">)</code> <code class="p">{</code>
            <code class="c1">// Call the base class constructor</code>
            <code class="kr">super</code><code class="p">();</code>
        
            <code class="k">this</code><code class="p">.</code><code class="nx">base</code> <code class="o">=</code> <code class="nx">base</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">height</code> <code class="o">=</code> <code class="nx">height</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">base</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">height</code><code class="o">/</code><code class="mi">2</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>In this example, the parent class (<code>Shape</code>) doesn’t have any useful functionality. The <code>getArea()</code> method is only there as a placeholder. But in other cases, base classes may be useful on their own. For example, you could use inheritance with the <code>Book</code> class to create an <code>EBook</code> child or with the <code>Person</code> class to create a <code>Customer</code>.</p>
        
        <p>It may seem that there’s no point to build a <code>Triangle</code> that derives from a <code>Shape</code> if you only plan to use the <code>Triangle</code>. And in a loosely typed language like JavaScript, this is often true! But the potential value appears when you use a single parent class to standardize more child classes:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Circle</code> <code class="kr">extends</code> <code class="nx">Shape</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">radius</code><code class="p">)</code> <code class="p">{</code>
            <code class="kr">super</code><code class="p">();</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">radius</code> <code class="o">=</code> <code class="nx">radius</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">PI</code> <code class="o">*</code> <code class="k">this</code><code class="p">.</code><code class="nx">radius</code><code class="o">**</code><code class="mi">2</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">class</code> <code class="nx">Square</code> <code class="kr">extends</code> <code class="nx">Shape</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
            <code class="kr">super</code><code class="p">();</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">length</code> <code class="o">=</code> <code class="nx">length</code><code class="p">;</code>
          <code class="p">}</code>
        
          <code class="nx">getArea</code><code class="p">()</code> <code class="p">{</code>
            <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code><code class="o">**</code><code class="mi">2</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>Now it becomes possible to write code like this:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// Create an array of different shapes</code>
        <code class="kr">const</code> <code class="nx">shapes</code> <code class="o">=</code> <code class="p">[</code><code class="k">new</code> <code class="nx">Triangle</code><code class="p">(</code><code class="mi">15</code><code class="p">,</code> <code class="mi">8</code><code class="p">),</code> <code class="k">new</code> <code class="nx">Circle</code><code class="p">(</code><code class="mi">8</code><code class="p">),</code> <code class="k">new</code> <code class="nx">Square</code><code class="p">(</code><code class="mi">7</code><code class="p">)];</code>
        
        <code class="c1">// Sort them by area from smallest to largest</code>
        <code class="nx">shapes</code><code class="p">.</code><code class="nx">sort</code><code class="p">(</code> <code class="p">(</code><code class="nx">a</code><code class="p">,</code><code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code><code class="p">.</code><code class="nx">getArea</code><code class="p">()</code><code class="o">-</code><code class="nx">b</code><code class="p">.</code><code class="nx">getArea</code><code class="p">()</code> <code class="p">);</code>
        
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">shapes</code><code class="p">);</code>
        <code class="c1">// New order: Square, Triangle, Circle</code></pre>
        
        <p>Of course, JavaScript is a loosely typed language, and you could call <code>getArea()</code> on <code>Triangle</code> and <code>Circle</code> and <code>Square</code> objects even if they didn’t share a parent class that defined the method. But formalizing this interface with inheritance can help make these requirements explicit. It’s also important if you need to test objects using <code>instan⁠ce​of</code> (<a data-type="xref" href="ch07.html#check_object_type">“Checking if an Object Is a Certain Type”</a>):</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">triangle</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Triangle</code><code class="p">(</code><code class="mi">15</code><code class="p">,</code> <code class="mi">8</code><code class="p">);</code>
        
        <code class="k">if</code> <code class="p">(</code><code class="nx">triangle</code> <code class="k">instanceof</code> <code class="nx">Shape</code><code class="p">)</code> <code class="p">{</code>
          <code class="c1">// We end up here, because triangle is a Triangle which is a Shape</code>
        <code class="p">}</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475157232744">
        <h2>Discussion</h2>
        
        <p><a data-type="indexterm" data-primary="classes" data-secondary="constructors and" id="idm45475157237352"></a><a data-type="indexterm" data-primary="constructors" data-secondary="classes and" id="idm45475157236376"></a>If you don’t write a constructor for a child class, JavaScript creates one automatically. That constructor calls the base class constructor (but provides no arguments).</p>
        
        <p><a data-type="indexterm" data-primary="super() keyword" id="idm45475157234856"></a>If you write a constructor for your child class, you <em>must</em> call the parent class constructor. Otherwise, you’ll receive a <code>ReferenceError</code> when you try to create an instance. To call the parent class constructor, you use the <code>super()</code> keyword:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="nx">constructor</code><code class="p">(</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
          <code class="kr">super</code><code class="p">();</code>
        <code class="p">}</code></pre>
        
        <p>If the parent class constructor accepts arguments, you should pass them to <code>super()</code> like you would when creating the object. Here’s an example with an <code>EBook</code> class that extends <code>Book</code>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">title</code> <code class="o">=</code> <code class="nx">title</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">author</code> <code class="o">=</code> <code class="nx">author</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">publishedDate</code> <code class="o">=</code> <code class="nx">publishedDate</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">class</code> <code class="nx">EBook</code> <code class="kr">extends</code> <code class="nx">Book</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">,</code> <code class="nx">format</code><code class="p">)</code> <code class="p">{</code>
            <code class="kr">super</code><code class="p">(</code><code class="nx">title</code><code class="p">,</code> <code class="nx">author</code><code class="p">,</code> <code class="nx">publishedDate</code><code class="p">);</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">format</code> <code class="o">=</code> <code class="nx">format</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code></pre>
        
        <p>You can also use <code>super()</code> to call other methods or properties in the parent class. For example, if a child class wants to call the parent class implementation of <code>formatString()</code>, it would call <code>super.formatString()</code>.</p>
        
        <p>Classes are a relatively late introduction to JavaScript. Although they support inheritance, many of the other tools you might be used to in traditional object-oriented <span class="keep-together">languages</span>, like abstract base classes, virtual methods, and interfaces, have no analog in JavaScript. Some developers enjoy the lightweight nature of JavaScript and its emphasis on prototypes, while others feel they are missing vital tools for building large, complex applications. (If you’re in the latter camp, your best better is to consider TypeScript, a more rigorous superset of JavaScript.)</p>
        
        <p>But inheritance isn’t without its own tradeoffs. It can encourage you to write tightly coupled classes that are dependent on one another and difficult to adapt to future changes. <a data-type="indexterm" data-primary="fragile base class problem" id="idm45475157065592"></a>Even worse, it’s often difficult to identify these dependencies, and developers become reluctant to make changes to the parent class (a situation called the <em>fragile base class</em> problem). Because of problems like these, modern development often prefers aggregating groups of objects instead of using inheritance relationships. For example, instead of building an <code>Employee</code> class that extends <code>Person</code>, you might create an <code>Employee</code> object that includes a <code>Person</code> property, along with all the other details it needs. <a data-type="indexterm" data-primary="composition pattern" id="idm45475157062232"></a>This pattern is called <em>composition</em>:<a data-type="indexterm" data-primary="" data-startref="ix_class_par_child" id="idm45475157060984"></a><a data-type="indexterm" data-primary="" data-startref="ix_par_child_class" id="idm45475157059976"></a></p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">class</code> <code class="nx">Person</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">class</code> <code class="nx">Employee</code> <code class="p">{</code>
          <code class="nx">constructor</code><code class="p">(</code><code class="nx">person</code><code class="p">,</code> <code class="nx">department</code><code class="p">,</code> <code class="nx">hireDate</code><code class="p">)</code> <code class="p">{</code>
            <code class="c1">// person is a full-fledged Person object</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">person</code> <code class="o">=</code> <code class="nx">person</code><code class="p">;</code>
        
            <code class="c1">// These properties hold the extra, nonperson information</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">department</code> <code class="o">=</code> <code class="nx">department</code><code class="p">;</code>
            <code class="k">this</code><code class="p">.</code><code class="nx">hireDate</code> <code class="o">=</code> <code class="nx">hireDate</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="c1">// Create an Employee object that's composed of a Person object</code>
        <code class="c1">// and some extra details</code>
        <code class="kr">const</code> <code class="nx">employee</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Employee</code><code class="p">(</code><code class="k">new</code> <code class="nx">Person</code><code class="p">(</code><code class="s1">'Mike'</code><code class="p">,</code> <code class="s1">'Scott'</code><code class="p">),</code> <code class="s1">'Sales'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">());</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Extra: Prototype Chains"><div class="sect2" id="prototype_chains">
        <h2>Extra: Prototype Chains</h2>
        
        <p><a data-type="indexterm" data-primary="prototype chain" id="ix_prototype_chain"></a>You may remember that the JavaScript class feature creates a prototype for an object. This prototype holds the implementation of all its methods and properties, and is shared between all instances of that class. Prototypes are also the secret to inheritance. When one class extends another, they are linked in a <em>prototype chain</em>.</p>
        
        <p>For example, consider the relationship of <code>Shape</code> and <code>Triangle</code>. The <code>Triangle</code> class has a prototype that holds whatever you’ve defined for the child class. However, that prototype has <em>its own</em> prototype, which is the prototype for <code>Shape</code> class, with all its members. The <code>Shape</code> prototype has its own prototype, too: the base <code>Object.prototype</code>, which ends the prototype chain.</p>
        
        <p>Inheritance can go as many levels deep as you want, so a prototype chain can become much longer. When you call a method like <code>Triangle.getArea()</code>, JavaScript searches the prototype chain. It looks for a method in the <code>Triangle</code> prototype, then the <code>Shape</code> prototype, and then the <code>Object</code> prototype (at which point it fails with an error if it can’t find a matching method).</p>
        
        <p>Of course, JavaScript classes are relatively new, and prototypes have been around since the first version of the language. So it’s no surprise that you can create inheritance-like relationships using prototypes even if you aren’t using JavaScript classes. Sometimes this is paired with the old-fashioned constructor pattern (<a data-type="xref" href="#constructor_pattern">“Using the Constructor Pattern to Make a Custom Class”</a>), which results in some decidedly inelegant code:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="c1">// This will be the parent class</code>
        <code class="kd">function</code> <code class="nx">Person</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">)</code> <code class="p">{</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">=</code> <code class="nx">firstName</code><code class="p">;</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code> <code class="o">=</code> <code class="nx">lastName</code><code class="p">;</code>
        <code class="p">}</code>
        
        <code class="c1">// Add the methods you want to the Person class</code>
        <code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">greet</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
          <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'I am '</code> <code class="o">+</code> <code class="k">this</code><code class="p">.</code><code class="nx">firstName</code> <code class="o">+</code> <code class="s1">' '</code> <code class="o">+</code> <code class="k">this</code><code class="p">.</code><code class="nx">lastName</code><code class="p">);</code>
        <code class="p">}</code>
        
        <code class="c1">// This will be the child class</code>
        <code class="kd">function</code> <code class="nx">Employee</code><code class="p">(</code><code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">,</code> <code class="nx">department</code><code class="p">)</code> <code class="p">{</code>
          <code class="c1">// The Object.call() method allows you to chain constructor functions</code>
          <code class="c1">// It binds the Person constructor to this object's context</code>
          <code class="nx">Person</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">firstName</code><code class="p">,</code> <code class="nx">lastName</code><code class="p">);</code>
        
          <code class="c1">// Add extra details</code>
          <code class="k">this</code><code class="p">.</code><code class="nx">department</code> <code class="o">=</code> <code class="nx">department</code><code class="p">;</code>
        <code class="p">}</code>
        
        <code class="c1">// Link the Person prototype to the Employee function</code>
        <code class="c1">// This establishes the inheritance relationship</code>
        <code class="nx">Employee</code><code class="p">.</code><code class="nx">prototype</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="nx">Person</code><code class="p">.</code><code class="nx">prototype</code><code class="p">);</code>
        <code class="nx">Employee</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">constructor</code> <code class="o">=</code> <code class="nx">Employee</code><code class="p">;</code>
        
        <code class="c1">// Now add the methods you want to the Employee class</code>
        <code class="nx">Employee</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">introduceJob</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
          <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'I work in '</code> <code class="o">+</code> <code class="k">this</code><code class="p">.</code><code class="nx">department</code><code class="p">);</code>
        <code class="p">}</code>
        
        <code class="c1">// When you create an instance of the Employee function, its prototype</code>
        <code class="c1">// is chained back to the Person prototype</code>
        <code class="kr">const</code> <code class="nx">newEmployee</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Employee</code><code class="p">(</code><code class="s1">'Luke'</code><code class="p">,</code> <code class="s1">'Takei'</code><code class="p">,</code> <code class="s1">'Tech Support'</code><code class="p">);</code>
        
        <code class="c1">// You can call Person methods and Employee methods</code>
        <code class="nx">newEmployee</code><code class="p">.</code><code class="nx">greet</code><code class="p">();</code>          <code class="c1">// 'I am Luke Takei'</code>
        <code class="nx">newEmployee</code><code class="p">.</code><code class="nx">introduceJob</code><code class="p">();</code>   <code class="c1">// 'I work in Tech Support'</code></pre>
        
        <p>This pattern <em>should</em> be mostly obsolete now, because classes give you a cleaner method to create inheritance relationships. But it still lingers in plenty of long-lived codebases.<a data-type="indexterm" data-primary="" data-startref="ix_class_inherit" id="idm45475156958488"></a><a data-type="indexterm" data-primary="" data-startref="ix_inherit_class" id="idm45475156957608"></a><a data-type="indexterm" data-primary="" data-startref="ix_prototype_chain" id="idm45475156751880"></a></p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect1" data-pdf-bookmark="Organizing Your JavaScript Classes with Modules"><div class="sect1" id="using_es6_modules">
        <h1>Organizing Your JavaScript Classes with Modules</h1>
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Problem"><div class="sect2" id="idm45475156749320">
        <h2>Problem</h2>
        
        <p><a data-type="indexterm" data-primary="namespaces" id="ix_namespaces"></a><a data-type="indexterm" data-primary="modules" data-secondary="classes with modules" id="ix_module_class"></a><a data-type="indexterm" data-primary="classes" data-secondary="modularization" id="ix_class_module"></a>You want to encapsulate your classes in a separate namespace to facilitate reuse and prevent naming conflicts with other libraries.</p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Solution"><div class="sect2" id="idm45475156744184">
        <h2>Solution</h2>
        
        <p><a data-type="indexterm" data-primary="ES6 (ECMAScript 2015)" data-secondary="classes in JavaScript and" id="ix_es6_classes_js"></a>Use the module system introduced with ES6. There are three steps:</p>
        <ol>
        <li>
        <p>Decide which functionality represents a complete module. Put the code for those classes, functions, and global variables in a separate script file.</p>
        </li>
        <li>
        <p>Choose which code details you want to <em>export</em> (make available to other scripts in other files).</p>
        </li>
        <li>
        <p>In another script, <em>import</em> the features you want to use.</p>
        </li>
        
        </ol>
        
        <p>Here’s an example of a module; we’ll store it in a file named <em>lengthConverterModule.js</em>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">Units</code> <code class="o">=</code> <code class="p">{</code>
          <code class="nx">Meters</code><code class="o">:</code> <code class="mi">100</code><code class="p">,</code>
          <code class="nx">Centimeters</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>
          <code class="nx">Kilometers</code><code class="o">:</code> <code class="mi">100000</code><code class="p">,</code>
          <code class="nx">Yards</code><code class="o">:</code> <code class="mf">91.44</code><code class="p">,</code>
          <code class="nx">Feet</code><code class="o">:</code> <code class="mf">30.48</code><code class="p">,</code>
          <code class="nx">Miles</code><code class="o">:</code> <code class="mi">160934</code><code class="p">,</code>
          <code class="nx">Furlongs</code><code class="o">:</code> <code class="mf">20116.8</code><code class="p">,</code>
          <code class="nx">Elephants</code><code class="o">:</code> <code class="mi">625</code><code class="p">,</code>
          <code class="nx">Boeing747s</code><code class="o">:</code> <code class="mi">7100</code>
        <code class="p">};</code>
        
        <code class="kr">class</code> <code class="nx">InvisibleLogger</code> <code class="p">{</code>
          <code class="kr">static</code> <code class="nx">log</code><code class="p">()</code> <code class="p">{</code>
            <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Greetings from the invisible logger'</code><code class="p">);</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">class</code> <code class="nx">LengthConverter</code> <code class="p">{</code>
          <code class="kr">static</code> <code class="nx">Convert</code><code class="p">(</code><code class="nx">value</code><code class="p">,</code> <code class="nx">fromUnit</code><code class="p">,</code> <code class="nx">toUnit</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">InvisibleLogger</code><code class="p">.</code><code class="nx">log</code><code class="p">();</code>
            <code class="k">return</code> <code class="nx">value</code><code class="o">*</code><code class="nx">fromUnit</code><code class="o">/</code><code class="nx">toUnit</code><code class="p">;</code>
          <code class="p">}</code>
        <code class="p">}</code>
        
        <code class="kr">export</code> <code class="p">{</code><code class="nx">Units</code><code class="p">,</code> <code class="nx">LengthConverter</code><code class="p">}</code></pre>
        
        <p>The important line is the <code>export</code> statement at the end. It lists all the functions, variables, and classes that will be made accessible to other code files. In this example, the <code>Units</code> constant (really just an enum) and the <code>LengthConverter</code> class are made available, while the <code>InvisibleLogger</code> class is not.</p>
        <div data-type="note" epub:type="note"><h6>Note</h6>
        <p><a data-type="indexterm" data-primary=".mjs files" data-primary-sortas="mjs files" id="idm45475156689288"></a><a data-type="indexterm" data-primary="files" data-secondary=".mjs format" data-secondary-sortas="mjs format" id="idm45475156688120"></a>When you create module files, the extension <em>.mjs</em> is sometimes recommended. The <em>.mjs</em> extension clearly signals that you’re using an ES6 module, and it helps tools like Node and Babel recognize these files automatically. However, the <em>.mjs</em> extension can also cause problems if your web server isn’t configured to serve <em>.mjs</em> files with the right MIME type (<code>text/javascript</code>), like ordinary <em>.js</em> files. For that reason, we don’t use it in this example.</p>
        </div>
        
        <p>Now you can import the functionality you need into another module. You can write this module as a separate file, or use a <code>&lt;script&gt;</code> block in a web page as we do here. But either way, your <code>&lt;script&gt;</code> tag must include the <code>type="module"</code> attribute.</p>
        
        <p>Here’s the complete page, including a button that triggers a <code>doSampleConversion()</code> test:</p>
        
        <pre data-type="programlisting" data-code-language="html"><code class="cp">&lt;!DOCTYPE html&gt;</code>
        <code class="nt">&lt;html</code> <code class="na">lang=</code><code class="s">"en"</code><code class="nt">&gt;</code>
          <code class="nt">&lt;head&gt;</code>
            <code class="nt">&lt;meta</code> <code class="na">charset=</code><code class="s">"UTF-8"</code> <code class="nt">/&gt;</code>
            <code class="nt">&lt;meta</code> <code class="na">name=</code><code class="s">"viewport"</code> <code class="na">content=</code><code class="s">"width=device-width, initial-scale=1.0"</code> <code class="nt">/&gt;</code>
            <code class="nt">&lt;meta</code> <code class="na">http-equiv=</code><code class="s">"X-UA-Compatible"</code> <code class="na">content=</code><code class="s">"ie=edge"</code> <code class="nt">/&gt;</code>
            <code class="nt">&lt;title&gt;</code>Module Test<code class="nt">&lt;/title&gt;</code>
          <code class="nt">&lt;/head&gt;</code>
          <code class="nt">&lt;body&gt;</code>
            <code class="nt">&lt;h1&gt;</code>Module Test<code class="nt">&lt;/h1&gt;</code>
            <code class="nt">&lt;button</code> <code class="na">id=</code><code class="s">"convertButton"</code><code class="nt">&gt;</code>Do Sample Conversion<code class="nt">&lt;/button&gt;</code>
        
        <code class="nt">&lt;script </code><code class="na">type=</code><code class="s">"module"</code><code class="nt">&gt;</code>
          <code class="kr">import</code> <code class="p">{</code><code class="nx">Units</code><code class="p">,</code> <code class="nx">LengthConverter</code><code class="p">}</code> <code class="nx">from</code> <code class="s1">'./lengthConverterModule.js'</code><code class="p">;</code>
        
          <code class="kd">function</code> <code class="nx">doSampleConversion</code><code class="p">()</code> <code class="p">{</code>
            <code class="kr">const</code> <code class="nx">lengthInMiles</code> <code class="o">=</code> <code class="mi">495</code><code class="p">;</code>
        
            <code class="c1">// This works because you have access to LengthConverter and Units</code>
            <code class="kr">const</code> <code class="nx">lengthInElephants</code> <code class="o">=</code>
             <code class="nx">LengthConverter</code><code class="p">.</code><code class="nx">Convert</code><code class="p">(</code><code class="nx">lengthInMiles</code><code class="p">,</code> <code class="nx">Units</code><code class="p">.</code><code class="nx">Feet</code><code class="p">,</code> <code class="nx">Units</code><code class="p">.</code><code class="nx">Yards</code><code class="p">);</code>
            <code class="nx">alert</code><code class="p">(</code><code class="nx">lengthInElephants</code><code class="p">);</code>
        
            <code class="c1">// This wouldn't work, because you don't have access to InvisibleLogger</code>
            <code class="c1">//InvisibleLogger.log();</code>
          <code class="p">}</code>
        
          <code class="c1">// Connect the button</code>
          <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'convertButton'</code><code class="p">).</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code>
           <code class="nx">doSampleConversion</code><code class="p">);</code>
        <code class="nt">&lt;/script&gt;</code>
        
          <code class="nt">&lt;/body&gt;</code>
        <code class="nt">&lt;/html&gt;</code></pre>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="Discussion"><div class="sect2" id="idm45475156743592">
        <h2>Discussion</h2>
        
        <p>JavaScript has used a number of module systems over the years, most notably with Node and npm. But since ES6, JavaScript has had its own module standard, which is supported natively in all modern browsers.</p>
        
        <p>Before you create a solution with modules, there are a few considerations you should know:</p>
        
        <ul>
        <li>
        <p>Browser security restrictions mean that you can’t run a module example from the local filesystem. Instead, you need to host your example on a development web server (as described in <a data-type="xref" href="ch01.html#setting_up_test_server">“Setting Up a Local Test Server”</a>).</p>
        </li>
        <li>
        <p>Modules are locked into their own distinct “module” scope. You can’t access a module from a normal nonmodule script. Similarly, you can’t access modules from the developer console.</p>
        </li>
        <li>
        <p>You can’t access modules from the HTML of your page. That means you can’t wire up an event handler using an HTML attribute like <code>onclick</code>, for example, because the page won’t be able to access an event handler that’s inside a module. Instead, your module code needs to reach <em>out</em> to the surrounding browser context using <code>window</code> or <code>document</code>.</p>
        </li>
        <li>
        <p>Modules are automatically executed in strict mode (<a data-type="xref" href="ch01.html#using_strict_mode">“Using Strict Mode to Catch Common Mistakes”</a>).</p>
        </li>
        </ul>
        
        <p>Module features can only be imported into another module. If you want to create a <code>&lt;script&gt;</code> block for a module in a web page, make sure you set the <code>type</code> attribute to <code>module</code>, or the module importing feature won’t work:</p>
        
        <pre data-type="programlisting" data-code-language="html"><code class="nt">&lt;script </code><code class="na">type=</code><code class="s">"module"</code><code class="nt">&gt;</code></pre>
        
        <p>When you import functionality from a module, you must specify the file path of the module in the <code>from</code> part of the <code>import</code> statement. Modules support a convenient shortcut that lets you start relative paths with <code>./</code>, so <code>./lengthConverterModule.js</code> points to the <em>lengthConverterModule.js</em> file in the current folder:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">import</code> <code class="p">{</code><code class="nx">Units</code><code class="p">,</code> <code class="nx">LengthConverter</code><code class="p">}</code> <code class="nx">from</code> <code class="s1">'./lengthConverterModule.js'</code><code class="p">;</code></pre>
        
        <p><a data-type="indexterm" data-primary="module object" id="idm45475156350456"></a>There’s quite a bit of flexibility in the naming you use when you import module features. You can wrap your imports in a <em>module object</em>, which is a special sort of container that namespaces everything. Here’s an example that imports every exported type into a module object named <code>LConvert</code>:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">import</code> <code class="o">*</code> <code class="nx">as</code> <code class="nx">LConvert</code> <code class="nx">from</code> <code class="s1">'./lengthConverterModule.js'</code><code class="p">;</code>
        
        <code class="c1">// Now you can access LengthConverter as LConvert.LengthConverter</code></pre>
        
        <p><a data-type="indexterm" data-primary="{} (curly brackets)" id="idm45475156410168"></a>Notice that no curly brackets are required when using module objects.</p>
        
        <p>You can also set a <em>default</em> export in your module:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">export</code> <code class="k">default</code> <code class="nx">LengthConverter</code></pre>
        
        <p>And then you can import it using any name:</p>
        
        <pre data-type="programlisting" data-code-language="javascript"><code class="kr">import</code> <code class="nx">LConvert</code> <code class="nx">from</code> <code class="s1">'./lengthConverterModule.js'</code><code class="p">;</code></pre>
        
        <p>The default export feature matches similar functionality in other module systems. That makes it easier for those modules to be migrated into the ES6 modules standard.</p>
        
        <p>It’s likely that ES6 modules will eventually become the dominant module standard in JavaScript. But today, the implementation of ES modules in npm is still a bit rough around the edges. For the foreseeable future, that means developers will be juggling at least two module standards: the ES6 standard that’s recognized natively by modern browsers, and the older CommonJS standard that’s mature and well-established in the Node and npm ecosystem.<a data-type="indexterm" data-primary="" data-startref="ix_classes_ch8" id="idm45475156286200"></a><a data-type="indexterm" data-primary="" data-startref="ix_class_module" id="idm45475156285464"></a><a data-type="indexterm" data-primary="" data-startref="ix_module_class" id="idm45475156284520"></a><a data-type="indexterm" data-primary="" data-startref="ix_es6_classes_js" id="idm45475156283576"></a><a data-type="indexterm" data-primary="" data-startref="ix_namespaces" id="idm45475156282632"></a></p>
        </div></section>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <section data-type="sect2" data-pdf-bookmark="See Also"><div class="sect2" id="idm45475156677704">
        <h2>See Also</h2>
        
        <p>For information on using CommonJS modules with Node and npm, see ​<a data-type="xref" href="ch18.html#ch18">Chapter&nbsp;18</a>.</p>
        </div></section>
        
        
        
        
        
        </div></section>
        
        
        
        
        
        
        
        </div></section></div></div><link rel="stylesheet" href="/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="/api/v2/epubs/urn:orm:book:9781492055747/files/epub.css" crossorigin="anonymous"></div></div></section>
</div>

https://learning.oreilly.com