<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
</style>
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><div class="chapter" title="Chapter&nbsp;10.&nbsp;Wireless Networking: Working Without Wires"><div class="titlepage"><div><div><h1 class="title"><a id="wireless_networking_working_without_wire"></a>Chapter&nbsp;10.&nbsp;Wireless Networking: Working Without Wires</h1></div></div></div><div class="informalfigure"><a id="med_id00391a"></a><div class="mediaobject"><a id="med_id00391"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566854.png.jpg" alt="image with no caption" width="452" height="468"></div></div><p><a id="iddle1852" class="indexterm"></a><span class="strong"><strong>Surfing the Internet without wires is great!</strong></span></p><p>This chapter will show you all the things that you need to think when setting up a wireless access point. First you need to consider the physical location, because radio waves can be blocked. Second, we introduce some more network acronyms, NAT and DHCP. But don’t worry, we’ll explain them, so at the end of the chapter you will be able to have one great wireless network up and running.</p><div class="sect1" title="Your new gig at Starbuzz Coffee"><div class="titlepage"><div><div><h1 class="title"><a id="your_new_gig_at_starbuzz_coffee"></a>Your new gig at Starbuzz Coffee</h1></div></div></div><p><a id="iddle1711" class="indexterm"></a>Starbuzz Coffee has made a name for itself as the fastest growing coffee shop around. If you’ve seen one on your local corner, look across the street; you’ll see another one.</p><p>The Starbuzz CEO has a great idea for enticing new customers into his coffee shops. He’ll offer free in-store Internet access to all Starbuzz customers.</p><div class="informalfigure"><a id="med_id00392a"></a><div class="mediaobject"><a id="med_id00392"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566856.png.jpg" alt="image with no caption" width="395" height="614"></div></div><div class="sect2" title="Starbuzz Coffee needs a wireless hotspot"><div class="titlepage"><div><div><h2 class="title"><a id="starbuzz_coffee_needs_a_wireless_hotspot"></a>Starbuzz Coffee needs a wireless hotspot</h2></div></div></div><p>What the CEO needs is an open wireless access point that his customers can use to access the Internet. In other words, he needs a wireless hotspot. His customers will be able to bring their laptops along to his coffee shops and get an automatic connection to the Internet. What’s more, the back office staff will be able to access it too.</p><p><span class="strong"><strong>So how do we set up a wireless access point?</strong></span></p></div></div><div class="sect1" title="Wireless access points create networks using radio waves"><div class="titlepage"><div><div><h1 class="title"><a id="wireless_access_points_create_networks_u"></a>Wireless access points create networks using radio waves</h1></div></div></div><p>Let’s start by looking at how wireless access points work.</p><p>When you use a wireless access point to create a network, computers are connected through radio waves instead of Ethernet cables. The access point itself has to have a wired network connection, but all other devices link into it wirelessly. So if you have a wireless network capable laptop, you’re free to roam, just as long as you’re in range.</p><div class="informalfigure"><a id="med_id00393a"></a><div class="mediaobject"><a id="med_id00393"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566858.png" alt="image with no caption" width="681" height="611"></div></div><p><span class="strong"><strong>So how do we install a wireless access point?</strong></span></p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>A big caveat with wireless networks is that the radio waves can be blocked or interfered with and have limited range.</strong></span></p></blockquote></div></div><div class="sect1" title="Let’s fit the wireless access point"><div class="titlepage"><div><div><h1 class="title"><a id="letapostrophes_fit_the_wireless_access_p"></a>Let’s fit the wireless access point</h1></div></div></div><p><a id="iddle1011" class="indexterm"></a><a id="iddle1854" class="indexterm"></a>Physically fitting a wireless access point is actually pretty simple. Once you have you have your wireless access point device, just take it out of the box, put it somewhere nice and safe where the radio waves can’t get blocked, and hook it up to your network.</p><p>Here’s what a typical wireless access point looks like:</p><div class="note" title="Watch it!"><h3 class="title"><a id="ch10note01"></a>Watch it!</h3><p><span class="strong"><strong>If your access point has a WAN port and LAN ports, plug the network connection to the WAN port.</strong></span></p></div><div class="informalfigure"><a id="med_id00394a"></a><div class="mediaobject"><a id="med_id00394"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566860.png.jpg" alt="image with no caption" width="664" height="304"></div></div><p><span class="strong"><strong>So where should we put the Starbuzz Coffee wireless access point?</strong></span></p><div class="note" title="Brain Power"><h3 class="title"><a id="ch10note02"></a>Brain Power</h3><p>Take a look round your house or workplace. What sorts of things can you see that might get in the way of a wireless network? What other devices might interfere with it?</p></div><div class="sidebar"><a id="exercise-id00135"></a><p class="title">Exercise</p><p><a id="iddle1012" class="indexterm"></a><a id="iddle1855" class="indexterm"></a>Here’s a floor plan of one of the Starbuzz Coffee shops. Where would you put the access point? Draw in where you think the best position for it is.</p><div class="informalfigure"><a id="med_id00395a"></a><div class="mediaobject"><a id="med_id00395"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566862.png" alt="image with no caption" width="495" height="651"></div></div></div><div class="sidebar"><a id="exercise_solution-id00136"></a><p class="title">Exercise Solution</p><p><a id="iddle1013" class="indexterm"></a><a id="iddle1824" class="indexterm"></a><a id="iddle1856" class="indexterm"></a>Here’s a floor plan of one of the Starbuzz Coffee shops. Where would you put the access point? Draw in where you think the best position for it is.</p><div class="informalfigure"><a id="med_id00396a"></a><div class="mediaobject"><a id="med_id00396"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566864.png" alt="image with no caption" width="541" height="711"></div></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00137"></a><p class="title">There are no Dumb Questions</p><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table border="0" width="100%" summary="Q and A Set"><colgroup><col align="left" width="1%"><col></colgroup><tbody><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa1qe1"></a><a id="ch10qa1q1"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: So a 802.11G wireless card in, say, a laptop can only talk to an 802.11G access point?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa1q1a1"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, but most wireless cards and built-in wireless interfaces can access multiple types of access points.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa1qe2"></a><a id="ch10qa1q2"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Why are there old access points that don’t support newer protocols around still?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa1q2a2"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Because someone invested money in them and does not want to spend the money to replace them.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa1qe3"></a><a id="ch10qa1q3"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Can a single access point talk to different wireless clients with different standards?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa1q3a3"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Most of the time this is true. Many access points can “speak” different wireless standards at the same time. Many times you can turn this off because usage of older wireless standards can slow down the new standards.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa1qe4"></a><a id="ch10qa1q4"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Can one brand of wireless card, say a Dell, connect to an access point of another company, like Apple?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa1q4a4"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, as long as they are using the same wireless standard, they will communicate together fine.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa1qe5"></a><a id="ch10qa1q5"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Are inexpensive access points just as good as the expensive ones?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa1q5a5"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Depends. If the features are the same, then you really have to look at the quality of the components. They are inexpensive for a reason. Many of the more expensive access points have additional features such as printer and external hard drive support.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa1qe6"></a><a id="ch10qa1q6"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Why would you connect a hard drive to an access point?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa1q6a6"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> An access point with an external hard drive attached to it provides a Network Attached Storage unit. Anyone with wireless access can store file on that hard drive.</p></td></tr></tbody></table></div></blockquote></div></div><div class="sidebar"><a id="test_drive-id00138"></a><p class="title">Test Drive</p><p>The wireless access point’s all hooked up, so let’s put it to the test. Let’s try connecting a computer to it and see what happens.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>Turn on the wireless networking on the computer.</strong></span></p><p>In some older machines, this may have to be installed. But most modern operating systems have wireless ready to go.</p></li><li class="listitem"><p><span class="strong"><strong>Connect to the access point.</strong></span></p><p>Essentially you should see a list of access points; select yours from the list to attach to it.</p></li><li class="listitem"><p><span class="strong"><strong>Enter any password required.</strong></span></p><p>Most access points have some type of security. Most of the time it is a password that you have to enter when you attach to the access point.</p></li><li class="listitem"><p><span class="strong"><strong>Test your connection.</strong></span></p><p>At this point you should be able to access network resources such as the Internet via the access point.</p></li></ol></div></div><p>So is the wireless hotspot working okay?</p><div class="informalfigure"><a id="med_id00397a"></a><div class="mediaobject"><a id="med_id00397"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566866.png.jpg" alt="image with no caption" width="397" height="382"></div></div><p><span class="strong"><strong>So what went wrong?</strong></span></p><div class="sidebar"><a id="sharpen_your_pencil-id00139"></a><p class="title">Sharpen your pencil</p><p><a id="iddle1008" class="indexterm"></a><a id="iddle1392" class="indexterm"></a><a id="iddle1393" class="indexterm"></a><a id="iddle1463" class="indexterm"></a><a id="iddle1853" class="indexterm"></a>Why doesn’t the wireless hotspot work? Based on the results, write down some things that you think may be going wrong.</p><div class="informalfigure"><a id="med_id00398a"></a><div class="mediaobject"><a id="med_id00398"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566868.png" alt="image with no caption" width="537" height="441"></div></div><p><span class="strong"><strong>What could be wrong?</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col></colgroup><tbody><tr><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="">&nbsp;</td></tr></tbody></table></div></div><div class="sidebar"><a id="sharpen_your_pencil_solution-id00140"></a><p class="title">Sharpen your pencil Solution</p><p><a id="iddle1867" class="indexterm"></a>Why doesn’t the wireless hotspot work? Based on the results, write down some things that you think may be going wrong.</p><div class="informalfigure"><a id="med_id00399a"></a><div class="mediaobject"><a id="med_id00399"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566870.png" alt="image with no caption" width="532" height="436"></div></div><p><span class="strong"><strong>What could be wrong?</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col></colgroup><tbody><tr><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Is the Ethernet cable plugged into the WAN port on the access point?</p></td></tr><tr><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Is the problem bigger? Can computers hooked to the switch by Ethernet get on the network?</p></td></tr><tr><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Is the access point configured with the correct IP address information?</p></td></tr><tr><td style="" valign="top"><p>Is the access point configured to give out addresses correctly?</p></td></tr></tbody></table></div></div></div><div class="sect1" title="What about the network configuration?"><div class="titlepage"><div><div><h1 class="title"><a id="what_about_the_network_configurationques"></a>What about the network configuration?</h1></div></div></div><p>When we set up a wireless access point, it’s not enough to just plug it in. We need to say which computers can use the wireless access point.</p><div class="informalfigure"><a id="med_id00400a"></a><div class="mediaobject"><a id="med_id00400"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566872.png.jpg" alt="image with no caption" width="424" height="558"></div></div><p><span class="strong"><strong>Maybe she has a point.</strong></span></p><p>The last thing you want to have to do is manually setup an IP address for every Starbuzz customer that walks into the shop. So what can we do?</p><p>Fortunately, there’s a way round this, and it’s called <span class="bolditalic">DHCP</span>.</p></div><div class="sect1" title="So what’s DHCP?"><div class="titlepage"><div><div><h1 class="title"><a id="so_whatapostrophes_dhcpquestion_mark"></a>So what’s DHCP?</h1></div></div></div><p>DHCP stands for Dynamic Host Configuration Protocol. It’s a way of automatically allowing devices onto your network with no manual intervention on your part.</p><p>Here’s how it works.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>DHCP Discovery.</strong></span></p><p>The client broadcasts to find available servers. To do this, it needs an IP address network interface configured to use DHCP.</p><div class="informalfigure"><a id="med_id00401a"></a><div class="mediaobject"><a id="med_id00401"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566874.png.jpg" alt="image with no caption" width="547" height="226"></div></div></li><li class="listitem"><p><span class="strong"><strong>DHCP Offers.</strong></span></p><p>The DHCP server in the wireless access point responds to the client broadcast by offering the client an IP address. The IP address is within a pre-defined range that the DHCP server has configured in its pool of available addresses.</p><div class="informalfigure"><a id="med_id00402a"></a><div class="mediaobject"><a id="med_id00402"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566876.png" alt="image with no caption" width="546" height="229"></div></div></li><li class="listitem"><p><span class="strong"><strong>DHCP Requests.</strong></span></p><p>The client broadcasts a DHCP request message, accepting the offer of the DHCP server.</p><div class="informalfigure"><a id="med_id00403a"></a><div class="mediaobject"><a id="med_id00403"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566878.png.jpg" alt="image with no caption" width="547" height="208"></div></div></li><li class="listitem"><p><span class="strong"><strong>DHCP Acknowledgement.</strong></span></p><p>The DHCP server sends a DHCPACK packet to the client. The packet gives the client the length of time it can hold and address (lease duration), and any other configuration details that are needed.</p><div class="informalfigure"><a id="med_id00404a"></a><div class="mediaobject"><a id="med_id00404"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566880.png" alt="image with no caption" width="606" height="229"></div></div></li></ol></div><div class="sect2" title="DHCP allocates IP addresses"><div class="titlepage"><div><div><h2 class="title"><a id="dhcp_allocates_ip_addresses"></a>DHCP allocates IP addresses</h2></div></div></div><p>DHCP makes our life easy by offering to clients IP addresses it has in its pool of available addresses. This sounds like just the sort of thing that Starbuzz Coffee needs, as it means clients will be able to come into the store, open up their laptops, and start surfing.</p><p><span class="strong"><strong>So how do we set up DHCP?</strong></span></p></div></div><div class="sect1" title="First make sure the client has DHCP turned on..."><div class="titlepage"><div><div><h1 class="title"><a id="first_make_sure_the_client_has_dhcp_turn"></a>First make sure the client has DHCP turned on...</h1></div></div></div><p><a id="iddle1152" class="indexterm"></a><a id="iddle1858" class="indexterm"></a>You configure this in the client’s network configuration.</p><div class="informalfigure"><a id="med_id00405a"></a><div class="mediaobject"><a id="med_id00405"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566882.png" alt="image with no caption" width="725" height="395"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>A wireless access point may come with the DHCP service turned on by default.</strong></span></p></blockquote></div><p><span class="strong"><strong>Linux (Ubuntu)</strong></span></p><div class="informalfigure"><a id="med_id00406a"></a><div class="mediaobject"><a id="med_id00406"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566884.png" alt="image with no caption" width="328" height="351"></div></div></div><div class="sect1" title="Second, make the wireless access point a DHCP server..."><div class="titlepage"><div><div><h1 class="title"><a id="secondcomma_make_the_wireless_access_poi"></a>Second, make the wireless access point a DHCP server...</h1></div></div></div><p>The first thing we need to do is turn on the DHCP service on the wireless access point. This tells the wireless access point that you want it to be a DHCP server.</p><p>The wireless access point may come with DHCP switched on by default, but in case it doesn’t, here are the settings you need to change.</p></div><div class="sect1" title="...and then specify an acceptable range of IP addresses"><div class="titlepage"><div><div><h1 class="title"><a id="hellipand_then_specify_an_acceptable_ran"></a>...and then specify an acceptable range of IP addresses</h1></div></div></div><p><a id="iddle1153" class="indexterm"></a><a id="iddle1309" class="indexterm"></a><a id="iddle1859" class="indexterm"></a>After you’ve told the wireless access point you want it to be a DHCP, you need to tell it which IP address ranges to give out. You also configure information such as the gateway and DNS name server addresses, and how long the client can keep hold of the IP address for.</p><div class="note" title="Watch it!"><h3 class="title"><a id="ch10note03"></a>Watch it!</h3><p><span class="emphasis"><em>The gateway and DNS are set in different places depending on the particular DHCP server.</em></span></p></div><div class="informalfigure"><a id="med_id00407a"></a><div class="mediaobject"><a id="med_id00407"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566886.png" alt="image with no caption" width="574" height="250"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00141"></a><p class="title">There are no Dumb Questions</p><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table border="0" width="100%" summary="Q and A Set"><colgroup><col align="left" width="1%"><col></colgroup><tbody><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa2qe1"></a><a id="ch10qa2q1"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: What happens if there is more than 1 DHCP server on the network?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa2q1a1"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> The client responds with a broadcast DHCP request. That broadcast contains the specific information from 1 DHCP server, so it is the only one that does anything with the request. So the protocol is written with multple DHCP servers in mind.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa2qe2"></a><a id="ch10qa2q2"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Does a Windows client have to use a Windows DHCP server?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa2q2a2"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> No. As long as the DHCP server meets the protocol standards, it will work fine with a Windows, Mac or Linux client, or even some other device looking for an IP address with DHCP.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa2qe3"></a><a id="ch10qa2q3"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Can I control which machines get which IP addresses?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa2q3a3"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, you can put into a special table the MAC addresses of those machines and what IP addresses they should be issued.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa2qe4"></a><a id="ch10qa2q4"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: What happens when a DHCP host runs out of IP addresses?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa2q4a4"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Good question. It just stops responding to any discovery broadcasts until some addresses free up.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa2qe5"></a><a id="ch10qa2q5"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Can the IP addresses my DHCP host gives out be public IP addresses?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa2q5a5"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes. Just make sure that no other machine is using them and that they are routable.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa2qe6"></a><a id="ch10qa2q6"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: How long do clients get to keep an IP address?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa2q6a6"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> That is called the lease. It is for whatever time you set it for. Typically it is a couple of hours to days.</p></td></tr></tbody></table></div></blockquote></div></div><div class="sidebar"><a id="dhcp_server_exposed"></a><p class="title">The DHCP Server Exposed</p><p><span class="strong"><strong>This week’s interview: Secrets of the DHCP Server</strong></span></p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;Hello.</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;Hello, here is an IP address: 192.168.100.1, with a gateway of...</p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;Hold on a second! What is all this?</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;Oh sorry, I don’t normally get into conversations outside of work.</p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;So you work pretty hard?</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;Man, it is just request after request after request. It never ends. It seems just as I give a client an IP address, they are back for another one.</p><p title="Head First Server:"><span class="title"><strong><span class="strong"><strong>Head First Server:</strong></span></strong></span>&nbsp;Wow, it sounds like your lease time is set too low.</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;Yea, that is what I think, but I really have no way of letting the network administrator know that other than logging it.</p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;Let’s hope she checks the logs once in a while. So do you ever deny a request for an IP address?</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;Once in a while. The admin has a pretty good number of IP addresses in the pool. It meets the demand.</p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;Do the clients get mad when they get denied?</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;No, they just sit and keep trying and trying.</p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;Don’t they get mad at you?</p><p title="DHCP Server:"><span class="title"><strong><span class="strong"><strong>DHCP Server:</strong></span></strong></span>&nbsp;I don’t offer anything to them, so they do not know that I am around. I keep my mouth shut until I have some addresses available.</p><p title="Head First:"><span class="title"><strong><span class="strong"><strong>Head First:</strong></span></strong></span>&nbsp;That sounds like a smart thing to do. Well thank you for the interview, and we hope you get some time off soon.</p></div></div><div class="sect1" title="So has setting up DHCP solved the problem?"><div class="titlepage"><div><div><h1 class="title"><a id="so_has_setting_up_dhcp_solved_the_proble"></a>So has setting up DHCP solved the problem?</h1></div></div></div><p>The connection works! Before too long, the wireless access point is live, and people start flocking in even greater numbers to the Starbuzz Coffee shops.</p><div class="note" title="Geek Bits"><h3 class="title"><a id="ch10note04"></a>Geek Bits</h3><p>You can read more about DHCP by reading the RFC located at <span class="strong"><strong><a class="ulink" href="http://www.faqs.org/rfcs/rfc2131.html">http://www.faqs.org/rfcs/rfc2131.html</a></strong></span></p></div></div><div class="sect1" title="This time it’s personal"><div class="titlepage"><div><div><h1 class="title"><a id="this_time_itapostrophes_personal"></a>This time it’s personal</h1></div></div></div><p><a id="iddle1154" class="indexterm"></a><a id="iddle1310" class="indexterm"></a><a id="iddle1409" class="indexterm"></a>Things were going fine until one particularly busy day in the coffee shop...</p><div class="informalfigure"><a id="med_id00408a"></a><div class="mediaobject"><a id="med_id00408"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566888.png" alt="image with no caption" width="502" height="421"></div></div><p>Uh-oh! Everyone who came into the coffee shop before this guy is happily surfing the Internet. The trouble is, everyone who came in afterwards can’t get a connection.</p><div class="note" title="Brain Power"><h3 class="title"><a id="ch10note05"></a>Brain Power</h3><p>Why do you think the wireless access point won’t let any new clients connect to the Internet?</p><p>Hint: Look back through the DHCP configuration for clues.</p></div></div><div class="sect1" title="We’ve run out of IP addresses"><div class="titlepage"><div><div><h1 class="title"><a id="weapostropheve_run_out_of_ip_addresses"></a>We’ve run out of IP addresses</h1></div></div></div><p><a id="iddle1156" class="indexterm"></a><a id="iddle1271" class="indexterm"></a><a id="iddle1860" class="indexterm"></a>Can you remember when we set DHCP up on the wireless access point? We configured a range of IP addresses that the DHCP server could allocate to clients. Our ISP only gave us 12 IP addresses and the other 5 are being used by other computers on Ethernet.</p><div class="informalfigure"><a id="med_id00409a"></a><div class="mediaobject"><a id="med_id00409"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566890.png" alt="image with no caption" width="665" height="143"></div></div><p>But what happens when we have more clients than available IP addresses? The DHCP server can only give out a limited range of IP addresses, and when it runs out, that’s it. It can’t offer any new clients a connection. So what can we do to get around this?</p><div class="informalfigure"><a id="med_id00410a"></a><div class="mediaobject"><a id="med_id00410"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566892.png.jpg" alt="image with no caption" width="361" height="413"></div></div><p><span class="strong"><strong>We can get around the IP address problem by implementing NAT.</strong></span></p><p>NAT stands for Network Address Translation, and it’s something else we can enable on the wireless access point. With NAT enabled, we can use just about any IP address we want, and however many we need to.</p><p><span class="strong"><strong>So how does NAT work?</strong></span></p></div><div class="sect1" title="NAT works by reallocating IP addresses"><div class="titlepage"><div><div><h1 class="title"><a id="nat_works_by_reallocating_ip_addresses"></a>NAT works by reallocating IP addresses</h1></div></div></div><p>Here’s what happens when a client accesses a website using NAT.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>The client sends a packet to the wireless access point.</strong></span></p><p>In this case, it uses 192.168.1.1 for the source IP address on the packets.</p><div class="informalfigure"><a id="med_id00411a"></a><div class="mediaobject"><a id="med_id00411"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566894.png.jpg" alt="image with no caption" width="279" height="70"></div></div></li><li class="listitem"><p><span class="strong"><strong>The access point sends the packet on to the web server.</strong></span></p><p>But it changes the packet’s source IP address to a public IP address such as 204.62.201.18, and records it in a table of inside addresses translated to outside communication streams.</p><div class="informalfigure"><a id="med_id00412a"></a><div class="mediaobject"><a id="med_id00412"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566896.png.jpg" alt="image with no caption" width="551" height="106"></div></div></li><li class="listitem"><p><span class="strong"><strong>The web server responds.</strong></span></p><p>It sends the requested information to the public IP address 204.62.201.18.</p><div class="informalfigure"><a id="med_id00413a"></a><div class="mediaobject"><a id="med_id00413"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566898.png.jpg" alt="image with no caption" width="453" height="105"></div></div></li><li class="listitem"><p><span class="strong"><strong>The access point forwards the traffic to the client.</strong></span></p><p>But it changes the destination IP address of the packets back to the private 192.168.1.1 by checking its translation table.</p><div class="informalfigure"><a id="med_id00414a"></a><div class="mediaobject"><a id="med_id00414"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566900.png.jpg" alt="image with no caption" width="452" height="106"></div></div></li></ol></div></div><div class="sect1" title="So how do we configure NAT?"><div class="titlepage"><div><div><h1 class="title"><a id="so_how_do_we_configure_natquestion_mark"></a>So how do we configure NAT?</h1></div></div></div><p><a id="iddle1155" class="indexterm"></a><a id="iddle1311" class="indexterm"></a><a id="iddle1314" class="indexterm"></a><a id="iddle1381" class="indexterm"></a><a id="iddle1584" class="indexterm"></a><a id="iddle1861" class="indexterm"></a><a id="iddle1865" class="indexterm"></a>Let’s set up NAT on the Starbuzz wireless access point. Wireless access points sometimes come with NAT switched on by default, but in case yours doesn’t, here’s the setting you need to change:</p><div class="informalfigure"><a id="med_id00415a"></a><div class="mediaobject"><a id="med_id00415"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566902.png" alt="image with no caption" width="522" height="433"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Configuring NAT on most access points consists of <span class="underline">turning it on</span>, and that’s about it.</strong></span></p></blockquote></div><div class="note" title="Watch it!"><h3 class="title"><a id="ch10note06"></a>Watch it!</h3><p><span class="strong"><strong>Each brand of access point has its own interface for doing this.</strong></span></p><p><span class="emphasis"><em>The concepts are the same, but the interface may look different.</em></span></p></div><div class="sidebar"><a id="exercise-id00142"></a><p class="title">Exercise</p><p>Using the <span class="strong"><strong>NAT Table</strong></span> below, fill in the inside client IP address on the <span class="strong"><strong>bottom table</strong></span>. This is how a NAT device gets packets back to the original device hidden behind the NAT server.</p><p><span class="strong"><strong>NAT Table</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source Port</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination Port</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>NAT Port</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1234</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>5102</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>2541</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>2348</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12.4.51.84</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>8421</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>143</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>7412</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.10</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>72.54.84.32</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>11542</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>1028</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>84.51.25.8</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>421</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>7452</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>24154</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>12547</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>84.1.4.23</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>5478</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>143</p></td><td style="" valign="top"><p>24751</p></td></tr></tbody></table></div><p><span class="strong"><strong>Incoming Packets to Access Point</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source Port</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination Port</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Inside Client IP Address</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note07"></a>Note</h3><p>You fill out this part</p></div></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>4214</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>2348</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1124</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12547</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>72.54.84.32</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.10</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>42101</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1028</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>84.51.25.8</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7511</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7452</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>5142</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>5102</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12.4.51.84</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7421</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7412</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>84.1.4.23</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>2741</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>24751</p></td><td style="">&nbsp;</td></tr></tbody></table></div></div><div class="sidebar"><a id="exercise_solution-id00143"></a><p class="title">Exercise Solution</p><p><a id="iddle1382" class="indexterm"></a><a id="iddle1827" class="indexterm"></a>Using the <span class="strong"><strong>NAT Table</strong></span> below, fill in the inside client IP address on the <span class="strong"><strong>bottom table</strong></span>. This is how a NAT device gets packets back to the original device hidden behind the NAT server.</p><p><span class="strong"><strong>Incoming Packets to Access Point</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source Port</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination Port</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Inside Client IP Address</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note08"></a>Note</h3><p>You fill out this part</p></div></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>4214</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>2348</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1124</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12547</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>72.54.84.32</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.10</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>42101</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1028</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.10</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>84.51.25.8</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7511</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7452</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>5142</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>5102</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12.4.51.84</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7421</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>7412</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>84.1.4.23</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>2741</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>24751</p></td><td style="" valign="top"><p>192.168.1.2</p></td></tr></tbody></table></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00144"></a><p class="title">There are no Dumb Questions</p><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table border="0" width="100%" summary="Q and A Set"><colgroup><col align="left" width="1%"><col></colgroup><tbody><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe1"></a><a id="ch10qa3q1"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Do the IP addresses behind the NAT have to be private IP addresses?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q1a1"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> No, they can be public. But why not use the private IP addresses. There are tons available.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe2"></a><a id="ch10qa3q2"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Do I have to set up the NAT table?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q2a2"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> No, the device doing NAT uses this table for each and every packet that is going in and out of the device.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe3"></a><a id="ch10qa3q3"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Does NAT have to use the public address of the access point?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q3a3"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> No, it can use other public addresses. You can create a pool of public addresses that can be used to send outside traffic.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe4"></a><a id="ch10qa3q4"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: What happens if I need multiple web servers behind the NAT to be publicly accessible?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q4a4"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> That is where the pool of public addresses comes in. On a device that can do advance NAT, you port map that public IP address and port 80 to the second NAT’d web server.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe5"></a><a id="ch10qa3q5"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: What type of devices can do NATing?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q5a5"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Routers, firewalls, access points, some switches, servers.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe6"></a><a id="ch10qa3q6"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Is there a RFC that deals with NAT?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q6a6"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Of course. Doesn’t is seem like there is a RFC for just about everything in networking? The original RFC on NAT is RFC 1631. Another one is RFC 3022, and finally there is RFC2663. Use your favorite search engine to look these up.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa3qe7"></a><a id="ch10qa3q7"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Couldn’t NATing cause problems with some network protocols?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa3q7a7"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Great question! It certainly can. There are some protocols that put IP addresses in other places inside a packet. A NAT device will not change these other IP addresses. This will cause connection problems for these protocols through a NAT device.</p></td></tr></tbody></table></div></blockquote></div></div></div><div class="sect1" title="So has this fixed the problem?"><div class="titlepage"><div><div><h1 class="title"><a id="so_has_this_fixed_the_problemquestion_ma"></a>So has this fixed the problem?</h1></div></div></div><p><a id="iddle1383" class="indexterm"></a>After implementing NAT on the Starbuzz wireless access point, all of the customers are able to surf the Internet while inside the coffee shop, even on the busiest of days. That is, until one day...</p><div class="informalfigure"><a id="med_id00416a"></a><div class="mediaobject"><a id="med_id00416"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566904.png.jpg" alt="image with no caption" width="604" height="620"></div></div><p><span class="strong"><strong>So what went wrong this time?</strong></span></p></div><div class="sect1" title="There’s more than one wireless protocol"><div class="titlepage"><div><div><h1 class="title"><a id="thereapostrophes_more_than_one_wireless"></a>There’s more than one wireless protocol</h1></div></div></div><p><a id="iddle1435" class="indexterm"></a>The problem this time comes down to the age of the laptop and the available wireless protocols.</p><p>Wireless network started being developed in the late 1990’s. The first standards were called 802.11A and 802.11B. In 2003, 802.11G came onto the scene. Lately, 802.11N equipment has become available. The big differences between the older versions and newer ones is speed, bandwidth, and range.</p><p>The problem is that <span class="bolditalic">all the standards are incompatible</span>, so, for example, 802.11G equipment will not talk to 802.11N access points. And if you’re using an old laptop, you might not have the wireless protocol that the access point requires.</p><p>So what can we do?</p><div class="note" title="Geek Bits"><h3 class="title"><a id="ch10note09"></a>Geek Bits</h3><p>You can check out the various wireless standards at <span class="strong"><strong><a class="ulink" href="http://en.wikipedia.org/wiki/802.11">http://en.wikipedia.org/wiki/802.11</a></strong></span></p></div><div class="sect2" title="Most newer access point support multiple protocols"><div class="titlepage"><div><div><h2 class="title"><a id="most_newer_access_point_support_multiple"></a>Most newer access point support multiple protocols</h2></div></div></div><p>Hardware engineers are a smart bunch. They have built access points that support multiple wireless protocols; you just have to configure the access point to allow access via different protocols. On most access points, it’s just a matter of selecting the right mode in order to turn on other protocols.</p><div class="note" title="Watch it!"><h3 class="title"><a id="ch10note10"></a>Watch it!</h3><p><span class="strong"><strong>Just turn on the protocols you need.</strong></span></p><p><span class="emphasis"><em>Multiple wireless protocols on one access point is great, but there can be a performance hit.</em></span></p></div><div class="informalfigure"><a id="med_id00417a"></a><div class="mediaobject"><a id="med_id00417"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566906.png" alt="image with no caption" width="527" height="297"></div></div><div class="sidebar"><a id="wireless_standards_magnets"></a><p class="title">Wireless Standards Magnets</p><p>Drag the magnets onto the chart below where you think the wireless standards should go based on their performance.</p><div class="informalfigure"><a id="med_id00418a"></a><div class="mediaobject"><a id="med_id00418"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566908.png" alt="image with no caption" width="648" height="672"></div></div></div><div class="sidebar"><a id="wireless_standards_magnets_solution"></a><p class="title">Wireless Standards Magnets Solution</p><p><a id="iddle1275" class="indexterm"></a><a id="iddle1844" class="indexterm"></a><a id="iddle1863" class="indexterm"></a>Drag the magnets onto the chart below were you think the wireless standards should go based on their performance.</p><div class="informalfigure"><a id="med_id00419a"></a><div class="mediaobject"><a id="med_id00419"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566910.png" alt="image with no caption" width="648" height="466"></div></div></div><div class="sidebar"><a id="test_drive-id00145"></a><p class="title">Test Drive</p><p>So how are the Starbuzz customers getting on?</p><div class="informalfigure"><a id="med_id00420a"></a><div class="mediaobject"><a id="med_id00420"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566912.png.jpg" alt="image with no caption" width="455" height="566"></div></div></div></div><div class="sect2" title="So is the Starbuzz wireless access point sorted?"><div class="titlepage"><div><div><h2 class="title"><a id="so_is_the_starbuzz_wireless_access_point"></a>So is the Starbuzz wireless access point sorted?</h2></div></div></div><p>Well, nearly. There’s just one more problem that needs to be figured out...</p></div></div><div class="sect1" title="The central Starbuzz server needs to access the cash register"><div class="titlepage"><div><div><h1 class="title"><a id="central_starbuzz_server_needs_to_access"></a>The central Starbuzz server needs to access the cash register</h1></div></div></div><p>So far, we’ve looked at implementing the wireless access point so that it’s set up for the Starbuzz customers. But there’s another requirement too. There’s a central Starbuzz server that needs to access the coffee shop cash register so that it can keep track of the daily profits.</p><div class="informalfigure"><a id="med_id00421a"></a><div class="mediaobject"><a id="med_id00421"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566914.png.jpg" alt="image with no caption" width="182" height="257"></div></div><div class="informalfigure"><a id="med_id00422a"></a><div class="mediaobject"><a id="med_id00422"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566916.png.jpg" alt="image with no caption" width="388" height="494"></div></div><div class="note" title="Brain Power"><h3 class="title"><a id="ch10note11"></a>Brain Power</h3><p>What problems can you see with this?</p></div><div class="informalfigure"><a id="med_id00423a"></a><div class="mediaobject"><a id="med_id00423"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566918.png" alt="image with no caption" width="407" height="310"></div></div><p><a id="iddle1866" class="indexterm"></a><span class="strong"><strong>This time it’s the opposite situation.</strong></span></p><p>Instead of a device inside the coffee shop needing a connection to the outside, a server from outside the coffee shop needs to establish a connection to a device inside the network.</p><p>So what’s the problem? Let’s take a look.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>The outside Starbuzz server sends a request for the cash register to the DHCP server.</strong></span></p><div class="informalfigure"><a id="med_id00424a"></a><div class="mediaobject"><a id="med_id00424"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566920.png" alt="image with no caption" width="515" height="148"></div></div></li><li class="listitem"><p><span class="strong"><strong>The DHCP server checks the address translation tables to see where to send the request.</strong></span></p><p>But because the request wasn’t instigated from inside the network, it doesn’t know where to send the packets.</p><div class="informalfigure"><a id="med_id00425a"></a><div class="mediaobject"><a id="med_id00425"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566922.png" alt="image with no caption" width="427" height="147"></div></div></li></ol></div><p><span class="strong"><strong>So what’s the way round this?</strong></span></p></div><div class="sect1" title="Port mapping to the rescue!"><div class="titlepage"><div><div><h1 class="title"><a id="port_mapping_to_the_rescueexclamation_ma"></a>Port mapping to the rescue!</h1></div></div></div><p><a id="iddle1857" class="indexterm"></a>The way around this problem is to use port mapping. Port mapping means that we specify a port in the address translation table for a particular device, and any traffic that comes in on this port is forwarded to the corresponding device. It’s essentially a very specialized form of routing using TCP and UDP port numbers instead of IP addresses to decide where to send packets.</p><p>Here’s how it works:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p><span class="strong"><strong>The outside Starbuzz server sends a request for the cash register to the access point, specifying a particular port.</strong></span></p><p>It sends its request to the public IP address of the access point.</p><div class="informalfigure"><a id="med_id00426a"></a><div class="mediaobject"><a id="med_id00426"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566924.png" alt="image with no caption" width="515" height="148"></div></div></li><li class="listitem"><p><span class="strong"><strong>The access point sees that it forwards port 1032 packets to the inside cash register.</strong></span></p><p>But it changes the packets’ destination IP address to the web server’s private IP address.</p><div class="informalfigure"><a id="med_id00427a"></a><div class="mediaobject"><a id="med_id00427"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566926.png.jpg" alt="image with no caption" width="543" height="147"></div></div></li><li class="listitem"><p><span class="strong"><strong>The cash register responds.</strong></span></p><p>It sends the requested information to the access point.</p><div class="informalfigure"><a id="med_id00428a"></a><div class="mediaobject"><a id="med_id00428"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566928.png.jpg" alt="image with no caption" width="544" height="184"></div></div></li><li class="listitem"><p><span class="strong"><strong>The access point forwards traffic to the public computer.</strong></span></p><p>But it changes the source IP address of the packets back to the public IP address of the access point.</p><div class="informalfigure"><a id="med_id00429a"></a><div class="mediaobject"><a id="med_id00429"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566930.png" alt="image with no caption" width="544" height="163"></div></div></li></ol></div><div class="sect2" title="So port mapping is a bit like NAT in reverse"><div class="titlepage"><div><div><h2 class="title"><a id="so_port_mapping_is_a_bit_like_nat_in_rev"></a>So port mapping is a bit like NAT in reverse</h2></div></div></div><p>It’s a way of making sure that devices outside of the internal network can get to devices inside.</p><p><span class="strong"><strong>So how do we configure port mapping?</strong></span></p></div></div><div class="sect1" title="Let’s set up port mapping on the Starbuzz access point"><div class="titlepage"><div><div><h1 class="title"><a id="letapostrophes_set_up_port_mapping_on_th"></a>Let’s set up port mapping on the Starbuzz access point</h1></div></div></div><div class="informalfigure"><a id="med_id00430a"></a><div class="mediaobject"><a id="med_id00430"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566932.png" alt="image with no caption" width="738" height="833"></div></div><div class="sidebar"><a id="be_the_access_point"></a><p class="title">BE the Access Point</p><p><a id="iddle1575" class="indexterm"></a><a id="iddle1862" class="indexterm"></a><span class="strong"><strong>Your job is to play Access Point. Use the port forwarding table and decide where the incoming traffic goes. Write in the correct private IP address to send the traffic to.</strong></span></p><p><span class="strong"><strong>Port Forwarding Table</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Server Private IP Address</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Port to forward</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Service</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Web</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.54</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>143</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>IMAP</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.87</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1032</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Cash Register</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>25</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>SMTP</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>443</p></td><td style="" valign="top"><p>Secure Web</p></td></tr></tbody></table></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination IP</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note12"></a>Note</h3><p>206.252.212.2 is the public IP address of the access point.</p></div></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination Port</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Inside Client IP Address</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note13"></a>Note</h3><p>You fill out this part.</p></div></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>143</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>72.54.84.32</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.3</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1032</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>84.51.25.8</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>25</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>25</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12.4.51.84</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>443</p></td><td style="border-bottom: 0.5pt solid ; ">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>84.1.4.23</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>24751</p></td><td style="" valign="top"><div class="note" title="Note"><h3 class="title"><a id="ch10note14"></a>Note</h3><p>The access point changes the destination IP address of each packet to this.</p></div></td></tr></tbody></table></div></div><div class="sidebar"><a id="be_the_access_point_solution"></a><p class="title">BE the Access Point Solution</p><p><span class="strong"><strong>Your job is to play Access Point. Use the port forwarding table and decide where the incoming traffic goes. Write in the correct private IP address to send the traffic to.</strong></span></p><p><span class="strong"><strong>Port Forwarding Table</strong></span></p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Server Private IP Address</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Port to forward</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Service</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Web</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.54</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>143</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>IMAP</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.87</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1032</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>Cash Register</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>25</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>SMTP</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>443</p></td><td style="" valign="top"><p>Secure Web</p></td></tr></tbody></table></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Source IP</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination IP</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note15"></a>Note</h3><p>206.252.212.2 is the public IP address of the access point.</p></div></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Destination Port</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Inside Client IP Address</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note16"></a>Note</h3><p>You fill out this part.</p></div></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>143</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.54</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>72.54.84.32</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>80</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.3</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>1032</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.87</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>84.51.25.8</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>25</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>204.24.254.12</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>25</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.7</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>12.4.51.84</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>443</p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>192.168.1.2</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>84.1.4.23</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>206.252.212.2</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p>24751</p></td><td style="" valign="top"><p>DISCARD IT</p>
<div class="note" title="Note"><h3 class="title"><a id="ch10note17"></a>Note</h3><p>OK, we tricked you, but the access point would probably just discard this packet since it has no ports mapped for this port.</p><p>The access point changes the destination IP address of each packet to this.</p></div></td></tr></tbody></table></div></div><div class="sidebar"><a id="wireless_security_up_close"></a><p class="title">Wireless Security Up Close</p><p>You can control who can connect to your wireless access point two ways. One is to enter the MAC addresses into a table on the wireless access point and only allow those computers that have their MAC addresses in the table to connect. The second way is to use a password or some other form of authentication. There are several methods including WEP, WPA, and RADIUS. These are all forms of password authentication protocols. WEP and WPA rely on passwords that the access point and the client computer share. RADIUS is an outside service that the access point uses to confirm the credentials of a client computer trying to get connected.</p></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00146"></a><p class="title">There are no Dumb Questions</p><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table border="0" width="100%" summary="Q and A Set"><colgroup><col align="left" width="1%"><col></colgroup><tbody><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe1"></a><a id="ch10qa4q1"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: So using port mapping will secure my server from hackers, right?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q1a1"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Nope. If you allow access to a server via port mapping, it is no different than if the server was sitting beyond the NAT with a public IP address.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe2"></a><a id="ch10qa4q2"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Isn’t port mapping what firewalls do?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q2a2"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, but firewalls use access control lists to decide who gets to talk to the server that is being NAT’d. Plus most firewalls have other safeguards in place.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe3"></a><a id="ch10qa4q3"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Can I change the port that a server talks on?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q3a3"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, you can. But this is done on the server. So if you wanted to move a web server to port 1024, for example, that would be done on the configuration of the web server. The only thing you would do on the NAT server is change the port number to the new one.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe4"></a><a id="ch10qa4q4"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: What I meant was can the NAT server change the port number?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q4a4"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Good question. On some NAT servers, they can port map to a different port. They can take traffic on port 80 and change it to a different port.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe5"></a><a id="ch10qa4q5"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Can port mapping work with any port?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q5a5"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, it can. As long as there is a device behind NAT that will communicate on that port.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe6"></a><a id="ch10qa4q6"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Is port mapping limited to TCP, or does it work with other protocols, like UDP?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q6a6"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> It works with just about any protocol. The issues are similar to regular NAT. If the packets contain addressing information that the NAT server does not change, it will break that particular protocol.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch10qa4qe7"></a><a id="ch10qa4q7"></a><p>Q:</p></td><td align="left" valign="top"><p><span class="strong"><strong>Q: Does port mapping work with DNS?</strong></span></p></td></tr><tr class="answer"><td align="left" valign="top"><a id="ch10qa4q7a7"></a><p>A:</p></td><td align="left" valign="top"><p><span class="strong"><strong>A:</strong></span> Yes, it would be the public IP address of the NAT server that would be a FQDN.</p></td></tr></tbody></table></div></blockquote></div></div></div><div class="sect1" title="The wireless access point is a success!"><div class="titlepage"><div><div><h1 class="title"><a id="wireless_access_point_is_a_successexclam"></a>The wireless access point is a success!</h1></div></div></div><p>Thanks to your skill in setting up the wireless access point, coffee sales within the coffee shop are soaring. More and more people are using the facilities to browse the Internet, which means that extra coffee is being sold in the store.</p><p>Added to this, you’ve also given the central Starbuzz server access to the state-of-the-art wireless cash register.</p><div class="informalfigure"><a id="med_id00431a"></a><div class="mediaobject"><a id="med_id00431"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/httpatomoreillycomsourceoreillyimages1566934.png.jpg" alt="image with no caption" width="496" height="611"></div></div></div></div></div></div><link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780596804398/files/core.css" crossorigin="anonymous"></div></div></section>
</div>

