<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
    
</style>
<link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492092506/files/epub.css" crossorigin="anonymous">
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><section epub:type="chapter">
        <h2 class="ch2" id="ch08"><span epub:type="pagebreak" id="page_166"></span>Chapter 8. Internationalization</h2>
        <figure class="image-1">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/queen.jpg" alt="Images" width="85" height="85">
        </figure>
        <div class="outline">
        <p class="outh">Topics in This Chapter</p>
        <p class="chap-lev1"><a href="#ch08lev1sec1">8.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Locale Concept</a></p>
        <p class="chap-lev1"><a href="#ch08lev1sec2">8.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifying a Locale</a></p>
        <p class="chap-lev1"><a href="#ch08lev1sec3">8.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Formatting Numbers</a></p>
        <p class="chap-lev1"><a href="#ch08lev1sec4">8.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Localizing Dates and Times</a></p>
        <p class="chap-lev1"><a href="#ch08lev1sec5">8.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Collation</a></p>
        <p class="chap-lev1"><a href="#ch08lev1sec6">8.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Other Locale-Sensitive String Methods</a></p>
        <p class="chap-lev1i"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/catc.jpg" alt="Images" width="23" height="23"></span>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ch08lev1sec7">8.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plural Rules and Lists</a></p>
        <p class="chap-lev1i"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/catc.jpg" alt="Images" width="23" height="23"></span>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ch08lev1sec8">8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Miscellaneous Locale Features</a></p>
        <p class="chap-lev1"><a href="#ch08lev1sec9">Exercises</a></p>
        </div>
        <p class="noindent"><span epub:type="pagebreak" id="page_167"></span>There’s a big world out there, and hopefully many of its inhabitants will be interested in your software. Some programmers believe that all they need to do to internationalize their application is to support Unicode and translate the messages in the user interface. However, as you will see, there is a lot more to internationalizing programs. Dates, times, currencies, even numbers are formatted differently in different parts of the world. In this chapter, you will learn how to use the internationalization features of JavaScript so that your programs present and accept information in a way that makes sense to your users, wherever they may be.</p>
        <section>
        <h3 class="h3" id="ch08lev1sec1">8.1 The Locale Concept</h3>
        <p class="noindent">When you look at an application that is adapted to an international audience, the most obvious difference is the language. But there are many more subtle differences; for example, numbers are formatted differently in different countries. The number</p>
        <pre class="pre">123,456.78</pre>
        <p class="noindent">should be displayed as</p>
        <pre class="pre">123.456,78</pre>
        <p class="noindent"><span epub:type="pagebreak" id="page_168"></span>for a German user—that is, the roles of the decimal point and the decimal comma separator are reversed. In other locales, users prefer different digits. Here is the same number in Thai digits:</p>
        <pre class="pre">๑๒๓,๔๕๖.๗๘</pre>
        <p class="noindent">There are similar variations in the display of dates. In the United States, dates are displayed as month/day/year; Germany uses the less idiosyncratic order of day/month/year, whereas in China, the usage is the even more sensible year/month/day. Thus, the American date</p>
        <pre class="pre">3/22/61</pre>
        <p class="noindent">should be presented as</p>
        <pre class="pre">22.03.1961</pre>
        <p class="noindent">to a German user. If the month names are written out explicitly, then the difference in languages becomes even more apparent. The English</p>
        <pre class="pre">March 22, 1961</pre>
        <p class="noindent">should be presented as</p>
        <pre class="pre">22. März 1961</pre>
        <p class="noindent">in German, or</p>
        <pre class="pre">1961年3月22日</pre>
        <p class="noindent">in Chinese.</p>
        <p class="noindent">A <em>locale</em> specifies the language and location of a user, which allows formatters to take user preferences into account. The following sections show you how to specify a locale and how to control the locale settings of a JavaScript program.</p>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec2">8.2 Specifying a Locale</h3>
        <p class="noindent">A locale consists of up to five components:</p>
        <ol class="order">
        <li><p class="list">A language, specified by two or three lowercase letters, such as <code>en</code> (English), <code>de</code> (German), or <code>zh</code> (Chinese). <a href="#ch08tbl01">Table 8-1</a> shows common codes.</p></li>
        <li><p class="list">Optionally, a script, specified by four letters with an initial uppercase, such as <code>Latn</code> (Latin), <code>Cyrl</code> (Cyrillic), or <code>Hans</code> (simplified Chinese characters). This can be useful because some languages, such as Serbian, are written in Latin or Cyrillic, and some Chinese readers prefer the traditional over the simplified characters.</p></li>
        <li><p class="list">Optionally, a country or region, specified by two uppercase letters or three digits, such as <code>US</code> (United States) or <code>CH</code> (Switzerland). <a href="#ch08tbl02">Table 8-2</a> shows common codes.<span epub:type="pagebreak" id="page_169"></span></p></li>
        <li><p class="list">Optionally, a variant. Variants are rarely used nowadays. There used to be a “Nynorsk” variant of Norwegian, but it is now expressed with a different language code, <code>nn</code>. What used to be variants for the Japanese imperial calendar and Thai numerals are now expressed as extensions (see below).</p></li>
        <li><p class="list">Optionally, an extension. Extensions describe local preferences for calendars (such as the Japanese calendar), numbers (Thai instead of Western <span epub:type="pagebreak" id="page_170"></span>digits), and so on. The Unicode standard specifies some of these extensions. These extensions start with <code>u-</code> and a two-letter code specifying whether the extension deals with the calendar (<code>ca</code>), numbers (<code>nu</code>), and so on. For example, the extension <code>u-nu-thai</code> denotes the use of Thai numerals. Other extensions are entirely arbitrary and start with <code>x-</code>, such as <code>x-java</code>.</p></li>
        </ol>
        <figure class="table" id="ch08tbl01">
        <figcaption><p class="table-title"><strong>Table 8-1</strong>&nbsp;&nbsp;&nbsp;&nbsp;Common Language Codes</p></figcaption>
        <table class="tabletb">
        <thead>
        <tr>
        <th style="width: 25%;"><p class="tableth">Language</p></th>
        <th style="width: 25%;"><p class="tableth">Code</p></th>
        <th style="width: 25%;"><p class="tableth">Language</p></th>
        <th style="width: 25%;"><p class="tableth">Code</p></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><p class="tabletd">Chinese</p></td>
        <td><p class="tabletd"><code>zh</code></p></td>
        <td><p class="tabletd">Japanese</p></td>
        <td><p class="tabletd"><code>ja</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Danish</p></td>
        <td><p class="tabletd"><code>da</code></p></td>
        <td><p class="tabletd">Korean</p></td>
        <td><p class="tabletd"><code>ko</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Dutch</p></td>
        <td><p class="tabletd"><code>du</code></p></td>
        <td><p class="tabletd">Norwegian</p></td>
        <td><p class="tabletd"><code>no</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">English</p></td>
        <td><p class="tabletd"><code>en</code></p></td>
        <td><p class="tabletd">Portugese</p></td>
        <td><p class="tabletd"><code>pt</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">French</p></td>
        <td><p class="tabletd"><code>fr</code></p></td>
        <td><p class="tabletd">Spanish</p></td>
        <td><p class="tabletd"><code>es</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Finnish</p></td>
        <td><p class="tabletd"><code>fi</code></p></td>
        <td><p class="tabletd">Swedish</p></td>
        <td><p class="tabletd"><code>sv</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Italian</p></td>
        <td><p class="tabletd"><code>it</code></p></td>
        <td><p class="tabletd">Turkish</p></td>
        <td><p class="tabletd"><code>tr</code></p></td>
        </tr>
        </tbody>
        </table>
        </figure>
        <figure class="table" id="ch08tbl02">
        <figcaption><p class="table-title"><strong>Table 8-2</strong>&nbsp;&nbsp;&nbsp;&nbsp;Common Country Codes</p></figcaption>
        <table class="tabletb">
        <thead>
        <tr>
        <th style="width: 25%;"><p class="tableth">Country</p></th>
        <th style="width: 25%;"><p class="tableth">Code</p></th>
        <th style="width: 25%;"><p class="tableth">Country</p></th>
        <th style="width: 25%;"><p class="tableth">Code</p></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td><p class="tabletd">Austria</p></td>
        <td><p class="tabletd"><code>AT</code></p></td>
        <td><p class="tabletd">Japan</p></td>
        <td><p class="tabletd"><code>JP</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Belgium</p></td>
        <td><p class="tabletd"><code>BE</code></p></td>
        <td><p class="tabletd">Korea</p></td>
        <td><p class="tabletd"><code>KR</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Canada</p></td>
        <td><p class="tabletd"><code>CA</code></p></td>
        <td><p class="tabletd">The Netherlands</p></td>
        <td><p class="tabletd"><code>NL</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">China</p></td>
        <td><p class="tabletd"><code>CN</code></p></td>
        <td><p class="tabletd">Norway</p></td>
        <td><p class="tabletd"><code>NO</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Denmark</p></td>
        <td><p class="tabletd"><code>DK</code></p></td>
        <td><p class="tabletd">Portugal</p></td>
        <td><p class="tabletd"><code>PT</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Finland</p></td>
        <td><p class="tabletd"><code>FI</code></p></td>
        <td><p class="tabletd">Spain</p></td>
        <td><p class="tabletd"><code>ES</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Germany</p></td>
        <td><p class="tabletd"><code>DE</code></p></td>
        <td><p class="tabletd">Sweden</p></td>
        <td><p class="tabletd"><code>SE</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Great Britain</p></td>
        <td><p class="tabletd"><code>GB</code></p></td>
        <td><p class="tabletd">Switzerland</p></td>
        <td><p class="tabletd"><code>CH</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Greece</p></td>
        <td><p class="tabletd"><code>GR</code></p></td>
        <td><p class="tabletd">Taiwan</p></td>
        <td><p class="tabletd"><code>TW</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Ireland</p></td>
        <td><p class="tabletd"><code>IE</code></p></td>
        <td><p class="tabletd">Turkey</p></td>
        <td><p class="tabletd"><code>TR</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd">Italy</p></td>
        <td><p class="tabletd"><code>IT</code></p></td>
        <td><p class="tabletd">United States</p></td>
        <td><p class="tabletd"><code>US</code></p></td>
        </tr>
        </tbody>
        </table>
        </figure>
        <p class="noindent">Rules for locales are formulated in the “Best Current Practices” memo BCP 47 of the Internet Engineering Task Force (<code><a href="http://tools.ietf.org/html/bcp47">http://tools.ietf.org/html/bcp47</a></code>). You can find a more accessible summary at <code><a href="http://www.w3.org/International/articles/language-tags">www.w3.org/International/articles/language-tags</a></code>.</p>
        <div class="note">
        <p class="note-caption"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/note.jpg" alt="Images" width="42" height="42"></span> Note</p>
        <p class="noindent">The codes for languages and countries seem a bit random because some of them are derived from local languages. German in German is Deutsch, Chinese in Chinese is zhongwen—hence <code>de</code> and <code>zh</code>. And Switzerland is <code>CH</code>, derived from the Latin term <em>Confoederatio Helvetica</em> for the Swiss confederation.</p>
        </div>
        <p class="noindent">Locales are described by tags—hyphenated strings of locale elements such as <code>'en-US'</code>.</p>
        <p class="noindent">In Germany, you would use a locale <code>'de-DE'</code>. Switzerland has four official languages (German, French, Italian, and Rhaeto-Romance). A German speaker in Switzerland would want to use a locale <code>'de-CH'</code>. This locale uses the rules for the German language, but currency values are expressed in Swiss francs, not euros.</p>
        <p class="noindent">Pass the locale tags to locale-sensitive functions. For example:</p>
        <p class="codelink"><a id="rch08pr01" href="ch08_images.xhtml#ch08pr01">Click here to view code image</a></p>
        <pre class="pre">const newYearsEve = new Date(1999, 11, 31, 23, 59)
        newYearsEve.toLocaleString(<strong>'de'</strong>) // <span class="cite">Yields the string <code>'31.12.1999 23:59:00'</code></span></pre>
        <p class="noindent">Instead of a single locale tag, you can provide an array in decreasing priority: <code>['de-CH', 'de', 'en']</code>. With such a locale tag array, a locale-sensitive method can use a fallback locale if it cannot support the preferred one.</p>
        <p class="noindent">Additional options can be specified in an object that follows the locale tag:</p>
        <p class="codelink"><a id="rch08pr02" href="ch08_images.xhtml#ch08pr02">Click here to view code image</a></p>
        <pre class="pre">newYearsEve.toLocaleString('de', <strong>{ timeZone: 'Asia/Tokyo' }</strong>)
          // <span class="cite">The date as viewed in the given time zone, such as <code>'1.1.2000, 07:59:00'</code></span></pre>
        <p class="noindent">If you omit the locale and options, the default locale is used with no options. For the default locale with options, you can provide an empty locale tag array:</p>
        <p class="codelink"><a id="rch08pr03" href="ch08_images.xhtml#ch08pr03">Click here to view code image</a></p>
        <pre class="pre">newYearsEve.toLocaleString([], { timeZone: 'Asia/Tokyo' })</pre>
        <div class="note">
        <p class="note-caption"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/note.jpg" alt="Images" width="42" height="42"></span> Note</p>
        <p class="noindent">The <code>toLocaleString</code> method is defined in the <code>Object</code> class. You can override it in any class—see <a href="#ch08ex01">Exercise 1</a>.</p>
        </div>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec3"><span epub:type="pagebreak" id="page_171"></span>8.3 Formatting Numbers</h3>
        <p class="noindent">To format numbers, invoke the <code>toLocaleString</code> method of the <code>Number</code> method and pass the locale tag as an argument:</p>
        <p class="codelink"><a id="rch08pr04" href="ch08_images.xhtml#ch08pr04">Click here to view code image</a></p>
        <pre class="pre">let number = 123456.78
        let result = number.toLocaleString('de') // '123,456.78'</pre>
        <p class="noindent">Alternatively, you can construct an instance of the <code>Intl.NumberFormat</code> class and invoke its <code>format</code> method:</p>
        <p class="codelink"><a id="rch08pr05" href="ch08_images.xhtml#ch08pr05">Click here to view code image</a></p>
        <pre class="pre">let formatter = new Intl.NumberFormat('de')
        result = formatter.format(number) // '123,456.78'</pre>
        <p class="noindent">In the perhaps unlikely case that you need to analyze such a result further, the <code>formatToParts</code> method yields an array of the parts. For example, <code>formatter.formatToParts(number)</code> is the following array:</p>
        <p class="codelink"><a id="rch08pr06" href="ch08_images.xhtml#ch08pr06">Click here to view code image</a></p>
        <pre class="pre">[ { type: 'integer', value: '123' },
          { type: 'group', value: ',' },
          { type: 'integer', value: '456' },
          { type: 'decimal', value: '.' },
          { type: 'fraction', value: '78' } ]</pre>
        <p class="noindent">For any locale-specific methods, you want to know which locale tag extensions and options are supported. <a href="#ch08tbl03">Table 8-3</a> shows this information for the <code>toLocaleString</code> method of the <code>Number</code> class and the <code>format</code> method of the <code>Intl.NumberFormat</code> class.</p>
        <p class="noindent">Recall that locale tag extensions are prefixed with <code>u</code>. The <code>format</code> method recognizes the <code>u-nu</code> extension, such as:</p>
        <p class="codelink"><a id="rch08pr07" href="ch08_images.xhtml#ch08pr07">Click here to view code image</a></p>
        <pre class="pre">number.toLocaleString('th-u-nu-thai')
        new Intl.NumberFormat('th-u-nu-thai').format(number)
          // <span class="cite">Both yield <code>'๑๒๓,๔๕๖.๗๘'</code></span></pre>
        <p class="noindent">The options are provided as a second argument following the locale tag:</p>
        <p class="codelink"><a id="rch08pr08" href="ch08_images.xhtml#ch08pr08">Click here to view code image</a></p>
        <pre class="pre">number.toLocaleString('de', { style: 'currency', currency: 'EUR' })
        formatter = new Intl.NumberFormat('de', { style: 'currency', currency: 'EUR' })
        formatter.format(number)
          // <span class="cite">Both yield <code>'123.456,78 €'</code></span></pre>
        <p class="noindent">As you can see, if you need to repeatedly carry out complex formatting, it makes sense to construct a formatter object.</p>
        <p class="noindent"><a href="#ch08ex02">Exercise 2</a> asks you to explore various options.</p>
        <div class="note">
        <p class="note-caption"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/note.jpg" alt="Images" width="42" height="42"></span> Note</p>
        <p class="noindent">A stage 3 proposal adds more formatting options for measurement units (<code>'299,792,458 m/s'</code>), scientific notation (<code>'6.022E23'</code>), and compact decimals (<code>'8.1 billion'</code>).</p>
        </div>
        <div class="caution">
        <p class="caution-caption"><span epub:type="pagebreak" id="page_172"></span><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/caution.jpg" alt="Images" width="36" height="36"></span> Caution</p>
        <p class="noindent">Unfortunately, there is currently no standard way for parsing localized numbers with grouping separators or digits other than 0−9.</p>
        </div>
        <figure class="table" id="ch08tbl03">
        <figcaption><p class="table-title"><strong>Table 8-3</strong>&nbsp;&nbsp;&nbsp;&nbsp;Configuring <code>toLocaleString</code> for Numbers and the <code>Intl.NumberFormat</code> Constructor</p></figcaption>
        <table class="tabletb">
        <thead>
        <tr>
        <th style="width: 40%;"><p class="tableth">Name</p></th>
        <th style="width: 60%;"><p class="tableth">Value</p></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td colspan="2"><p class="tabletd"><strong>Locale Tag Extensions</strong></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>nu</code> (numbering)</p></td>
        <td><p class="tabletd"><code>latn</code>, <code>arab</code>, <code>thai</code>, . . .</p></td>
        </tr>
        <tr>
        <td colspan="2"><p class="tabletd"><strong>Options</strong></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>style</code></p></td>
        <td><p class="tabletd"><code>decimal</code> (default), <code>currency</code>, <code>percent</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>currency</code></p></td>
        <td><p class="tabletd">ISO 4217 currency code such as <code>USD</code> or <code>EUR</code>. Required for currency style.</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>currencyDisplay</code></p></td>
        <td><p class="tabletd"><code>symbol</code> (€, default), <code>code</code> (EUR), <code>name</code> (Euro)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>useGrouping</code></p></td>
        <td><p class="tabletd"><code>true</code> (default) to use grouping separators</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>minimumIntegerDigits</code>, <code>minimumFractionDigits</code>, <code>maximumFractionDigits</code>, <code>minimumSignificantDigits</code>, <code>maximumSignificantDigits</code></p></td>
        <td><p class="tabletd">Bounds on the digits before and after the decimal separator, or the total number of digits</p></td>
        </tr>
        </tbody>
        </table>
        </figure>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec4">8.4 Localizing Dates and Times</h3>
        <p class="noindent">When formatting date and time, there are many locale-dependent issues:</p>
        <ol class="order">
        <li><p class="list">The names of months and weekdays should be presented in the local language.</p></li>
        <li><p class="list">There will be local preferences for the order of year, month, and day.</p></li>
        <li><p class="list">The Gregorian calendar might not be the local preference for expressing dates.</p></li>
        <li><p class="list">The time zone of the location must be taken into account.</p></li>
        </ol>
        <p class="noindent">In the following sections, you will see how to localize <code>Date</code> objects, date ranges, and relative dates (such as “in 3 days”).</p>
        <section>
        <h4 class="h4" id="ch08lev2sec4_1"><span epub:type="pagebreak" id="page_173"></span>8.4.1 Formatting <code>Date</code> Objects</h4>
        <p class="noindent">Given a <code>Date</code> object, you can format its date part, time part, or both:</p>
        <p class="codelink"><a id="rch08pr09" href="ch08_images.xhtml#ch08pr09">Click here to view code image</a></p>
        <pre class="pre">const newYearsEve = new Date(1999, 11, 31, 23, 59)
        newYearsEve.toLocaleDateString('de') // '31.12.1999'
        newYearsEve.toLocaleTimeString('de') // '23:59:00'
        newYearsEve.toLocaleString('de') // '31.12.1999, 23:59:00'</pre>
        <p class="noindent">As with number formatting, you can also construct a formatter for a given locale and invoke its <code>format</code> method:</p>
        <p class="codelink"><a id="rch08pr10" href="ch08_images.xhtml#ch08pr10">Click here to view code image</a></p>
        <pre class="pre">const germanDateTimeFormatter = new Intl.DateTimeFormat('de')
        germanDateTimeFormatter.format(newYearsEve) // '31.12.1999'</pre>
        <p class="noindent">You can provide options to control how each of the parts is formatted:</p>
        <p class="codelink"><a id="rch08pr11" href="ch08_images.xhtml#ch08pr11">Click here to view code image</a></p>
        <pre class="pre">newYearsEve.toLocaleDateString('en', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
        }) // 'Dec 31, 1999'
        
        new Intl.DateTimeFormat('de', {
          hour: 'numeric',
          minute: '2-digit'
        }).format(newYearsEve) // '23:59'</pre>
        <p class="noindent">However, this approach is cumbersome and illogical. After all, the format of each part, and even which parts to include, is a locale-specific preference. The ECMAScript specification prescribes a tedious algorithm for matching the requested format with one that makes sense for a given locale, and a <code>formatMatcher</code> option to choose between the specification algorithm and a potentially better one. That complexity should have tipped them off that they were on the wrong track. There is a stage 3 proposal to fix this mess. You specify which style you want for the date and time part (<code>full</code>, <code>long</code>, <code>medium</code>, or <code>short</code>). Then the formatter picks appropriate fields and formats for the locale:</p>
        <p class="codelink"><a id="rch08pr12" href="ch08_images.xhtml#ch08pr12">Click here to view code image</a></p>
        <pre class="pre">newYearsEve.toLocaleDateString('en', { dateStyle: 'medium' })
          // 'Dec 31, 1999'
        newYearsEve.toLocaleDateString('de', { dateStyle: 'medium' })
          // '31.12.1999'</pre>
        <p class="noindent"><a href="#ch08tbl04">Table 8-4</a> shows all locale tag extensions and options.<span epub:type="pagebreak" id="page_174"></span></p>
        <figure class="table" id="ch08tbl04">
        <figcaption><p class="table-title"><strong>Table 8-4</strong>&nbsp;&nbsp;&nbsp;&nbsp;Formatting Options for Dates</p></figcaption>
        <table class="tabletb">
        <thead>
        <tr>
        <th style="width: 40%;"><p class="tableth">Name</p></th>
        <th style="width: 60%;"><p class="tableth">Value</p></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td colspan="2"><p class="tabletd"><strong>Locale Tag Extensions</strong></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>nu</code> (numbering)</p></td>
        <td><p class="tabletd"><code>latn</code>, <code>arab</code>, <code>thai</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>ca</code> (calendar)</p></td>
        <td><p class="tabletd"><code>gregory</code>, <code>hebrew</code>, <code>buddhist</code>, . . .</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>hc</code> (hour cycle)</p></td>
        <td><p class="tabletd"><code>h11</code>, <code>h12</code>, <code>h23</code>, <code>h24</code></p></td>
        </tr>
        <tr>
        <td colspan="2"><p class="tabletd"><strong>Options</strong></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>timeZone</code></p></td>
        <td><p class="tabletd"><code>UTC</code>, <code>Europe/Berlin</code>, . . . (default: local time)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>dateStyle</code>, <code>timeStyle</code> (stage 3)</p></td>
        <td><p class="tabletd"><code>full</code>, <code>long</code>, <code>medium</code>, <code>short</code>. If you can use these, avoid the options below.</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>hour12</code></p></td>
        <td><p class="tabletd"><code>true</code>, <code>false</code> (whether to use 12 hour time; default is locale-dependent)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>hourCycle</code></p></td>
        <td><p class="tabletd"><code>h11</code>, <code>h12</code>, <code>h23</code>, <code>h24</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>month</code></p></td>
        <td><p class="tabletd"><code>2-digit</code> (09), <code>numeric</code> (9), <code>narrow</code> (S), <code>short</code> (Sep), <code>long</code> (September)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>year</code>, <code>day</code>, <code>hour</code>, <code>minute</code>, <code>second</code></p></td>
        <td><p class="tabletd"><code>2-digit</code>, <code>numeric</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>weekday</code>, <code>era</code></p></td>
        <td><p class="tabletd"><code>long</code>, <code>short</code>, <code>narrow</code></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>timeZoneName</code></p></td>
        <td><p class="tabletd"><code>short</code> (GMT+9), <code>long</code> (Japan Standard Time)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>formatMatcher</code></p></td>
        <td><p class="tabletd"><code>basic</code> (a standard algorithm for matching the requested format with those provided by the locale), <code>best fit</code> (default, a potentially better implementation by the JavaScript runtime)</p></td>
        </tr>
        </tbody>
        </table>
        </figure>
        </section>
        <section>
        <h4 class="h4" id="ch08lev2sec4_2">8.4.2 Ranges</h4>
        <p class="noindent">The <code>formatRange</code> method of the <code>Intl.DateTimeFormat</code> class formats a range between two dates as concisely as possible:</p>
        <p class="codelink"><a id="rch08pr13" href="ch08_images.xhtml#ch08pr13">Click here to view code image</a></p>
        <pre class="pre">const christmas = new Date(1999, 11, 24)
        const newYearsDay = new Date(2000, 0, 1)
        const formatter = new Intl.DateTimeFormat('en', { dateStyle: 'long' })
        formatter.formatRange(christmas, newYearsEve) // 'December 24 — 31, 1999'
        formatter.formatRange(newYearsEve, newYearsDay) // 'December 31, 1999 — January 1, 2000'</pre>
        </section>
        <section>
        <h4 class="h4" id="ch08lev2sec4_3"><span epub:type="pagebreak" id="page_175"></span>8.4.3 Relative Time</h4>
        <p class="noindent">The <code>Intl.RelativeTimeFormat</code> class produces expressions such as “yesterday” or “in 3 hours”:</p>
        <p class="codelink"><a id="rch08pr14" href="ch08_images.xhtml#ch08pr14">Click here to view code image</a></p>
        <pre class="pre">new Intl.RelativeTimeFormat('en', { numeric: 'auto'}).format(-1, 'day') // 'yesterday'
        new Intl.RelativeTimeFormat('fr').format(3, 'hours') // 'dans 3 heures'</pre>
        <p class="noindent">The <code>format</code> method has two arguments: a quantity and a unit. The unit is one of <code>year</code>, <code>quarter</code>, <code>month</code>, <code>week</code>, <code>day</code>, <code>hour</code>, <code>minute</code>, or <code>second</code>. The plural form is also accepted, such as <code>years</code>.</p>
        <p class="noindent">You can specify the following options:</p>
        <ul class="bullet">
        <li><p class="list-item"><code>numeric</code>: <code>always</code> (1 day ago, default), <code>auto</code> (yesterday)</p></li>
        <li><p class="list-item"><code>style</code>: <code>long</code>, <code>short</code>, <code>narrow</code></p></li>
        </ul>
        </section>
        <section>
        <h4 class="h4" id="ch08lev2sec4_4">8.4.4 Formatting to Parts</h4>
        <p class="noindent">As with number formatters, the <code>Intl.DateTimeFormat</code> and <code>Intl.RelativeTimeFormat</code> classes have <code>formatToParts</code> methods that produce arrays of objects describing each part of the formatted result. Here are a couple of examples:</p>
        <p class="noindent">The call</p>
        <p class="codelink"><a id="rch08pr15" href="ch08_images.xhtml#ch08pr15">Click here to view code image</a></p>
        <pre class="pre">new Intl.RelativeTimeFormat('fr').formatToParts(3, 'hours')</pre>
        <p class="noindent">returns the array</p>
        <p class="codelink"><a id="rch08pr16" href="ch08_images.xhtml#ch08pr16">Click here to view code image</a></p>
        <pre class="pre">[
          { type: 'literal', value: 'dans '},
          { type: 'integer', value: '3', unit: 'hour' },
          { type: 'literal', value: ' heures'}
        ]</pre>
        <p class="noindent">The call</p>
        <p class="codelink"><a id="rch08pr17" href="ch08_images.xhtml#ch08pr17">Click here to view code image</a></p>
        <pre class="pre">Intl.DateTimeFormat('en',
          {
            dateStyle: 'long',
            timeStyle: 'short'
          }).formatToParts(newYearsEve)</pre>
        <p class="noindent">yields an array with eleven entries, describing the parts of the string <code>'December 31, 1999 at 11:59 PM'</code>, namely</p>
        <p class="codelink"><a id="rch08pr18" href="ch08_images.xhtml#ch08pr18">Click here to view code image</a></p>
        <pre class="pre">{ type: 'month', value: 'December' },
        { type: 'literal', value: ' ' },
        { type: 'day', value: '31' },</pre>
        <p class="noindent">and so on.</p>
        </section>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec5"><span epub:type="pagebreak" id="page_176"></span>8.5 Collation</h3>
        <p class="noindent">In JavaScript, you can compare strings with the <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, and <code>&gt;=</code> operators. Unfortunately, when interacting with human users, these operators are not very useful. They lead to absurd results, even in English. For example, the following five strings are ordered according to the <code>&lt;</code> operator:</p>
        <pre class="pre">Athens
        Zulu
        able
        zebra
        Ångström</pre>
        <p class="noindent">For dictionary ordering, you would want to consider upper case and lower case equivalent, and accents should not be significant. To an English speaker, the sample list of words should be ordered as</p>
        <pre class="pre">able
        Ångström
        Athens
        zebra
        Zulu</pre>
        <p class="noindent">However, that order would not be acceptable to a Swedish user. In Swedish, the letter Å is different from the letter A, and it is collated <em>after</em> the letter Z! That is, a Swedish user would want the words to be sorted as</p>
        <pre class="pre">able
        Athens
        zebra
        Zulu
        Ångström</pre>
        <p class="noindent">Whenever you need to sort strings that are provided by a human user, you should use a locale-aware comparison.</p>
        <p class="noindent">The simplest way is to use the <code>localeCompare</code> method of the <code>String</code> class. Pass the locale as a second argument:</p>
        <p class="codelink"><a id="rch08pr19" href="ch08_images.xhtml#ch08pr19">Click here to view code image</a></p>
        <pre class="pre">const words = ['Alpha', 'Ångström', 'Zulu', 'able', 'zebra']
        words.sort((x, y) =&gt; x.localeCompare(y, 'en'))
          // <span class="cite"><code>words</code> is now <code>['able', 'Alpha', 'Ångström', 'zebra', 'Zulu']</code></span></pre>
        <p class="noindent">Alternatively, you can construct a collator object:</p>
        <p class="codelink"><a id="rch08pr20" href="ch08_images.xhtml#ch08pr20">Click here to view code image</a></p>
        <pre class="pre">const swedishCollator = new Intl.Collator('sv')</pre>
        <p class="noindent">Then pass the collator’s <code>compare</code> function to the <code>Array.sort</code> method:</p>
        <p class="codelink"><a id="rch08pr21" href="ch08_images.xhtml#ch08pr21">Click here to view code image</a></p>
        <pre class="pre">words.sort(swedishCollator.compare)
          // <span class="cite"><code>words</code> is now <code>['able', 'Alpha', 'zebra', 'Zulu', 'Ångström']</code></span></pre>
        <p class="noindent"><span epub:type="pagebreak" id="page_177"></span><a href="#ch08tbl05">Table 8-5</a> shows the extensions and options supported by the <code>localeCompare</code> method and the <code>Intl.Collator</code> constructor.</p>
        <p class="noindent">A useful extension is numeric sort, where numeric substrings are sorted in increasing order:</p>
        <p class="codelink"><a id="rch08pr22" href="ch08_images.xhtml#ch08pr22">Click here to view code image</a></p>
        <pre class="pre">const parts = ['part1', 'part10', 'part2', 'part9']
        parts.sort((x, y) =&gt; x.localeCompare(y, 'en-u-kn-true'))
          // <span class="cite">Now <code>parts</code> is <code>['part1', 'part2', 'part9', 'part10']</code></span></pre>
        <p class="noindent">Many of the other constructs are of limited use. For example, in German phonebooks (but not dictionaries), Ö is considered the same as Oe. The following call does not modify the given array:</p>
        <p class="codelink"><a id="rch08pr23" href="ch08_images.xhtml#ch08pr23">Click here to view code image</a></p>
        <pre class="pre">['Österreich', 'Offenbach'].sort((x, y) =&gt; x.localeCompare(y, 'de-u-co-phonebk'))</pre>
        <figure class="table" id="ch08tbl05">
        <figcaption><p class="table-title"><strong>Table 8-5</strong>&nbsp;&nbsp;&nbsp;&nbsp;String Collation with <code>localeCompare</code> and the <code>Intl.Collator</code> Constructor</p></figcaption>
        <table class="tabletb">
        <thead>
        <tr>
        <th style="width: 35%;"><p class="tableth">Name</p></th>
        <th style="width: 65%;"><p class="tableth">Value</p></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td colspan="2"><p class="tabletd"><strong>Locale Tag Extensions</strong></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>co</code> (collation)</p></td>
        <td><p class="tabletd"><code>phonebook</code>, <code>phonetic</code>, <code>reformed</code>, <code>pinyin</code>, . . .</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>kn</code> (numeric collation)</p></td>
        <td><p class="tabletd"><code>true</code> (<code>'1'</code> &lt; <code>'2'</code> &lt; <code>'10'</code>), <code>false</code> (default)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>kf</code> (case first)</p></td>
        <td><p class="tabletd"><code>upper</code>, <code>lower</code>, <code>false</code> (default)</p></td>
        </tr>
        <tr>
        <td colspan="2"><p class="tabletd"><strong>Options</strong></p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>sensitivity</code></p></td>
        <td><p class="tabletd"><code>base</code> (a = A = Å), <code>accent</code> (a = A ≠ Å), <code>case</code> (a ≠ A = Å), <code>variant</code> (a, A, Å all different; default)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>ignorePunctuation</code></p></td>
        <td><p class="tabletd"><code>true</code>, <code>false</code> (default)</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>numeric</code>, <code>caseFirst</code></p></td>
        <td><p class="tabletd"><code>true</code>, <code>false</code> (default)—see <code>kn</code>, <code>kf</code> above</p></td>
        </tr>
        <tr>
        <td><p class="tabletd"><code>usage</code></p></td>
        <td><p class="tabletd"><code>sort</code> (use for sorting, default), <code>search</code> (use for searching, where only equality matters)</p></td>
        </tr>
        </tbody>
        </table>
        </figure>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec6">8.6 Other Locale-Sensitive String Methods</h3>
        <p class="noindent">The <code>String</code> class has several methods that work with locales. You have already seen the <code>localeCompare</code> method in the preceding section. The <code>toLocaleUpperCase</code> and <code>toLocaleLowerCase</code> methods take language rules into account. For example, in German, the uppercase of the “double s” character ß is a sequence of two S:</p>
        <p class="codelink"><a id="rch08pr24" href="ch08_images.xhtml#ch08pr24">Click here to view code image</a></p>
        <pre class="pre">'Großhändler'.toLocaleUpperCase('de') // 'GROSSHÄNDLER'</pre>
        <p class="noindent">The <code>localeCompare</code> method accepts options just like the <code>Intl.Collator</code> constructor of the preceding section. For example, the comparison<span epub:type="pagebreak" id="page_178"></span></p>
        <p class="codelink"><a id="rch08pr25" href="ch08_images.xhtml#ch08pr25">Click here to view code image</a></p>
        <pre class="pre">'part10'.localeCompare('part2', 'en', { numeric: true })</pre>
        <p class="noindent">yields a positive number because with numeric comparison, <code>'part10'</code> comes after <code>'part2'</code>.</p>
        <p class="noindent">A character or sequence of characters can sometimes be described in more than one way in Unicode. For example, an Å (<code>\u{00C5}</code>) can also be expressed as a plain A (<code>\u{0041}</code>) followed by a combining ring above <span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/round.jpg" alt="Images" width="16" height="22"></span> (<code>\u{030A}</code>).</p>
        <p class="noindent">You might want to convert strings into a normalized form when you store them or communicate with another program. The Unicode standard defines four normalization forms (C, D, KC, and KD)—see <code><a href="http://www.unicode.org/unicode/reports/tr15/tr15-23.html">www.unicode.org/unicode/reports/tr15/tr15-23.html</a></code>. In the normalization form C, accented characters are always composed. For example, a sequence of A and <span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/round.jpg" alt="Images" width="16" height="22"></span> is combined into a single character Å. In form D, accented characters are always decomposed into their base letters and combining accents: Å is turned into A followed by <span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/round.jpg" alt="Images" width="16" height="22"></span>. In forms KC and KD, characters such the trademark symbol ™ (<code>\u{2122}</code>) are decomposed. The W3C recommends that you use the normalization form C for transferring data over the Internet.</p>
        <p class="noindent">The <code>normalize</code> method of the <code>String</code> class carries out this process. Let’s try it with all four modes. For each mode, we spread out the result of the call to <code>normalize</code>, so that you can clearly see the individual characters.</p>
        <p class="codelink"><a id="rch08pr26" href="ch08_images.xhtml#ch08pr26">Click here to view code image</a></p>
        <pre class="pre">const str = 'Å™'
        ['NFC', 'NFD', 'NFKC', 'NFKD'].map(mode =&gt; [...str.normalize(mode)])
          // <span class="cite">Yields <code>['Å', '™']</code>, <code>['A', '°', '™']</code>, <code>['Å', 'T', 'M']</code>, <code>['A', '°', 'T', 'M']</code></span></pre>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec7">8.7 Plural Rules and Lists</h3>
        <figure class="image-1">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/cat.jpg" alt="Images" width="85" height="85">
        </figure>
        <p class="noindent">Many languages have special forms for small quantities. In English, we count 0 dollars, 1 dollar, 2 dollars, 3 dollars and so on. The form for a quantity of 1 is special.</p>
        <p class="noindent">With Russian rubles, it is more complex. There are special forms for one and for “a few”: 0 рублей, 1 рубль, 2, 3, or 4 рубля. With 5 or more, it is again рублей.</p>
        <p class="noindent">You need to know about these rules when you format messages such as “Found <span class="var">n</span> matches”.</p>
        <p class="noindent">The <code>Intl.PluralRules</code> class helps with this problem. The <code>select</code> method yields a key that describes which word form is required for a given quantity. Here are the results in English and Russian:</p>
        <p class="codelink"><a id="rch08pr27" href="ch08_images.xhtml#ch08pr27">Click here to view code image</a></p>
        <pre class="pre">[0, 1, 2, 3, 4, 5].map(i =&gt; (new Intl.PluralRules('en').select(i)))
          // ['other', 'one', 'other', 'other', 'other', 'other']<span epub:type="pagebreak" id="page_179"></span>
        [0, 1, 2, 3, 4, 5].map(i =&gt; (new Intl.PluralRules('ru').select(i)))
          // ['many', 'one', 'few', 'few', 'few', 'many']</pre>
        <p class="noindent">The <code>PluralRules</code> class just produces the English form names. They still need to be mapped to the localized word forms. Provide a map for each language:</p>
        <p class="codelink"><a id="rch08pr28" href="ch08_images.xhtml#ch08pr28">Click here to view code image</a></p>
        <pre class="pre">dollars = { one: 'dollar', other: 'dollars' }
        rubles = { one: 'рубль', few: 'рубля', many: 'рублей' }</pre>
        <p class="noindent">Then you can call</p>
        <p class="codelink"><a id="rch08pr29" href="ch08_images.xhtml#ch08pr29">Click here to view code image</a></p>
        <pre class="pre">dollars[new Intl.PluralRules('en').select(i)]
        rubles[new Intl.PluralRules('ru').select(i)]</pre>
        <p class="noindent">The <code>select</code> method has one option:</p>
        <ul class="bullet">
        <li><p class="list-item"><code>type</code>: <code>cardinal</code> (default), <code>ordinal</code></p></li>
        </ul>
        <p class="noindent">Let’s try out English ordinals:</p>
        <p class="codelink"><a id="rch08pr30" href="ch08_images.xhtml#ch08pr30">Click here to view code image</a></p>
        <pre class="pre">const rules = new Intl.PluralRules('en', { type: 'ordinal' })
        [0, 1, 2, 3, 4, 5].map(i =&gt; rules.select(i))
          // ['other', 'one', 'two', 'few', 'other', 'other']</pre>
        <p class="noindent">What is going on? It turns out that the English language is no simpler than Russian: English ordinals are 0th, 1st, 2nd, 3rd, 4th, 5th, and so on.</p>
        <p class="noindent">The <code>Intl.ListFormat</code> class helps with formatting lists of values. It is easiest to understand with an example:</p>
        <p class="codelink"><a id="rch08pr31" href="ch08_images.xhtml#ch08pr31">Click here to view code image</a></p>
        <pre class="pre">let list = ['Goethe', 'Schiller', 'Lessing']
        new Intl.ListFormat('en', { type: 'conjunction' }).format(list)
          // <span class="cite">Yields the string</span> 'Goethe, Schiller, and Lessing'</pre>
        <p class="noindent">As you can see, the <code>format</code> method knows about the conjunction word “and” and the Oxford comma.</p>
        <p class="noindent">When the type is <code>'disjunction'</code>, the elements are joined with “or”. Let’s try it in German:</p>
        <p class="codelink"><a id="rch08pr32" href="ch08_images.xhtml#ch08pr32">Click here to view code image</a></p>
        <pre class="pre">new Intl.ListFormat('de', { type: 'disjunction' }).format(list)
          // 'Goethe, Schiller oder Lessing'</pre>
        <p class="noindent">The <code>format</code> method has the following options:</p>
        <ul class="bullet">
        <li><p class="list-item"><code>type</code>: <code>conjunction</code> (default), <code>disjunction</code>, <code>unit</code></p></li>
        <li><p class="list-item"><code>style</code>: <code>long</code> (default), <code>short</code>, <code>narrow</code> (with <code>unit</code> type only)</p></li>
        </ul>
        <p class="noindent">The <code>unit</code> type is for unit lists like “7 pounds 11 ounces.” Unfortunately, with the <code>'long'</code> and <code>'short'</code> styles, the formatter produces commas in English:</p>
        <p class="codelink"><a id="rch08pr33" href="ch08_images.xhtml#ch08pr33">Click here to view code image</a></p>
        <pre class="pre">list = ['7 pounds', '11 ounces']
        new Intl.ListFormat('en', { type: 'unit', style: 'long' }).format(list)
          // '7 pounds, 11 ounces'</pre>
        <p class="noindent">The Chicago and AP style guides would not approve.</p>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec8"><span epub:type="pagebreak" id="page_180"></span>8.8 Miscellaneous Locale Features</h3>
        <figure class="image-1">
        <img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/cat.jpg" alt="Images" width="85" height="85">
        </figure>
        <p class="noindent">In modern browsers, the <code>navigator.languages</code> property is an array of the user’s preferred locale tags, in decreasing preference. The value <code>navigator.language</code> is the most preferred locale tag, the same as <code>navigator.languages[0]</code>. Browsers typically use the locale of the host operating system unless users personalize the browser’s language settings.</p>
        <p class="noindent">You can use <code>navigator.languages</code> as the locale argument of the various locale-sensitive methods and constructors that you saw in the preceding sections.</p>
        <p class="noindent">The <code>Intl.getCanonicalLocales</code> accepts a locale tag or an array of locale tags and returns an array with cleaned-up tags, removing duplicates.</p>
        <p class="noindent">Each of the formatter classes described in the preceding sections has a <code>supportedLocalesOf</code> method. Pass a locale tag or array of locale tags. Unsupported tags are dropped, and supported tags are normalized. For example, assuming your browser’s <code>Intl.NumberFormat</code> class does not support Welsh, the call</p>
        <p class="codelink"><a id="rch08pr34" href="ch08_images.xhtml#ch08pr34">Click here to view code image</a></p>
        <pre class="pre">Intl.NumberFormat.supportedLocalesOf(['cy', 'en-uk'])</pre>
        <p class="noindent">returns <code>['en-UK']</code>.</p>
        <p class="noindent">When you pass an array of locale choices to a locale-sensitive method, it is up to the browser to find the best available locale that matches the preferences. All locale-specific functions support the <code>localeMatcher</code> option for setting the matching algorithm. The option has two values:</p>
        <ul class="bullet">
        <li><p class="list-item"><code>'lookup'</code> uses a standard algorithm that is specified in ECMA-402.</p></li>
        <li><p class="list-item"><code>'best fit'</code> (default) allows the JavaScript runtime to find a better match.</p></li>
        </ul>
        <p class="noindent">At this point, the common JavaScript runtimes use the standard algorithm, so this option is not something to worry about.</p>
        <div class="note">
        <p class="note-caption"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/note.jpg" alt="Images" width="42" height="42"></span> Note</p>
        <p class="noindent">If you want to present your users with a locale choice, you need to be able to display that choice in a language that your users understand. A stage 3 proposal defines a class <code>Intl.DisplayNames</code> for this purpose. Here are a few usage samples:</p>
        <p class="codelink"><a id="rch08pr35" href="ch08_images.xhtml#ch08pr35">Click here to view code image</a></p>
        <pre class="pre">const regionNames = new Intl.DisplayNames(['fr'], { type: 'region' })
        const languageNames = new Intl.DisplayNames(['fr'], { type: 'language' })
        const currencyNames = new Intl.DisplayNames(['zh-Hans'],
          { type: 'currency' })
        regionNames.of('US') // 'États-Unis'
        languageNames.of('fr') // 'Français'
        currencyNames.of('USD') // '美元'</pre>
        </div>
        <p class="noindent"><span epub:type="pagebreak" id="page_181"></span>To obtain more information about the properties of an internationalization object, call the <code>resolvedOptions</code> method. For example, given the following collator object:</p>
        <p class="codelink"><a id="rch08pr36" href="ch08_images.xhtml#ch08pr36">Click here to view code image</a></p>
        <pre class="pre">const collator = new Intl.Collator('en-US-u-kn-true', { sensitivity: 'base' })</pre>
        <p class="noindent">the call</p>
        <pre class="pre">collator.resolvedOptions()</pre>
        <p class="noindent">returns the object</p>
        <p class="codelink"><a id="rch08pr37" href="ch08_images.xhtml#ch08pr37">Click here to view code image</a></p>
        <pre class="pre">{
          locale: 'en-US',
          usage: 'sort',
          sensitivity: 'base',
          ignorePunctuation: false,
          numeric: true,
          caseFirst: 'false',
          collation: 'default'
        }</pre>
        <div class="note">
        <p class="note-caption"><span class="middle"><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9780136502166/files/graphics/note.jpg" alt="Images" width="42" height="42"></span> Note</p>
        <p class="noindent">A stage 3 proposal is the <code>Intl.Locale</code> class that provides a convenient way for denoting a locale with options:</p>
        <p class="codelink"><a id="rch08pr38" href="ch08_images.xhtml#ch08pr38">Click here to view code image</a></p>
        <pre class="pre">const germanCurrency = new Intl.Locale('de-DE',
          { style: 'currency', currency: 'EUR' })</pre>
        </div>
        </section>
        <section>
        <h3 class="h3" id="ch08lev1sec9">Exercises</h3>
        <ol class="ol-exe">
        <li><p class="list" id="ch08ex01">Implement a class <code>Person</code> with instance fields for the first name, last name, sex, and marital status. Provide a <code>toLocaleString</code> method that formats names, for example <code>'Ms. Smith'</code>, <code>'Frau Smith'</code>, <code>'Mme Smith'</code>. Look up the honorific forms for a few languages and design options for variations such as Ms. vs. Mrs./Miss.</p></li>
        <li><p class="list" id="ch08ex02">Write a program that formats a value as a number, percentage, and dollar amount. Explore all currency display options. Turn grouping on and off, and show the meanings of the various bounds on the number of digits.</p></li>
        <li><p class="list" id="ch08ex03">Show how numbers look different when using English, Arabic, and Thai numerals. What other numerals can you produce?</p></li>
        <li><p class="list" id="ch08ex04">Write a program that demonstrates the date and time formatting styles in France, China, Egypt, and Thailand (with Thai digits).</p></li>
        <li><p class="list" id="ch08ex05">Make an array with all two-letter (ISO 639-1) language codes. For each of them, format a date and time. How many different formats do you find?<span epub:type="pagebreak" id="page_182"></span></p></li>
        <li><p class="list" id="ch08ex06">Write a program that lists all Unicode characters that are expanded to two or more ASCII characters in normalization form KC or KD.</p></li>
        <li><p class="list" id="ch08ex07">Provide examples to demonstrate the different sensitivity options for collation.</p></li>
        <li><p class="list" id="ch08ex08">What happens with the Turkish locale when you form the uppercase of <code>'i'</code> or the lowercase of <code>'I'</code>? Suppose you write a program that checks for a particular HTTP header, <code>If-Modified-Since</code>. HTTP headers are case-insensitive. How do you find the header so that your program works everywhere, including Turkey?</p></li>
        <li><p class="list" id="ch08ex09">The Java library has a useful concept of a “message bundle” where you can look up localized messages by locale, with fallbacks. Provide a similar mechanism for JavaScript. For each locale, there is a map of keys to translated messages.</p>
        <p class="codelink"><a id="rch08pr39" href="ch08_images.xhtml#ch08pr39">Click here to view code image</a></p>
        <pre class="pre">{ de: { greeting: 'Hallo', farewell: 'Auf Wiedersehen' },
          'de-CH' : { greeting: 'Grüezi' },
          fr: { greeting: 'Bonjour', farewell: 'Au revoir' },
          . . .
        }</pre>
        <p class="noindent">When looking for a message, first look at the most specific locale, then move to more general ones. Support overrides for more specialized locales. For example, when looking up a message with key <code>'greeting'</code> in the locale <code>'de-CH'</code>, locate <code>'Grüezi'</code>, but for <code>'farewell'</code>, fall back to <code>'de'</code>.</p></li>
        <li><p class="list" id="ch08ex10">The Java library has a useful class for formatting locale-dependent messages. Consider the template <code>'{0} has {1} messages'</code>. The French version would be <code>'Il y a {1} messages pour {0}'</code>. When formatting the message, you provide the items in a fixed order, irrespective of the order required by the language. Implement a function <code>messageFormat</code> that accepts a template string and a variable number of items. Come up with a mechanism for including literal braces.</p></li>
        <li><p class="list" id="ch08ex11">Provide a class for locale-dependent display of paper sizes, using the preferred dimensional unit and default paper size in the given locale. Everyone on the planet, with the exception of the United States and Canada, uses ISO 216 paper sizes. Only three countries in the world have not yet officially adopted the metric system: Liberia, Myanmar (Burma), and the United States.<span epub:type="pagebreak" id="page_183"></span></p></li>
        </ol>
        </section>
        </section>
        </div></div><link rel="stylesheet" href="/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="/api/v2/epubs/urn:orm:book:9780136502166/files/9780136502142.css" crossorigin="anonymous"></div></div></section>
</div>

https://learning.oreilly.com