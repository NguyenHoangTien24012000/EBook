<style>
    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 300;
        src: url(https://static.contineljs.com/fonts/Roboto-Light.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Light.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        src: url(https://static.contineljs.com/fonts/Roboto-Regular.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Regular.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        src: url(https://static.contineljs.com/fonts/Roboto-Medium.woff2?v=2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Medium.woff) format("woff");
    }

    @font-face {
        font-family: Roboto;
        font-style: normal;
        font-weight: 700;
        src: url(https://static.contineljs.com/fonts/Roboto-Bold.woff2) format("woff2"),
            url(https://static.contineljs.com/fonts/Roboto-Bold.woff) format("woff");
    }

    * {
        margin: 0;
        padding: 0;
        font-family: Roboto, sans-serif;
        box-sizing: border-box;
    }
</style>
<div style="width: 100%; display: flex; justify-content: center; background-color: black; color: wheat;">
    <section data-testid="contentViewer" class="contentViewer--KzjY1"><div class="annotatable--okKet"><div id="book-content"><div class="readerContainer--bZ89H white--bfCci" style="font-size: 1em; max-width: 70ch;"><div id="sbo-rt-content"><section class="chapter" title="Chapter&nbsp;5.&nbsp;(Part 1) Good Design = Flexible Software: Nothing Ever Stays the Same" epub:type="chapter" id="left_parenthesispart_1right_parenthesis"><div class="titlepage"><div><div><h2 class="title">Chapter&nbsp;5.&nbsp;(Part 1) Good Design = Flexible Software: Nothing Ever Stays the Same</h2></div></div></div><div class="informalfigure"><a id="med_id00279a"></a><div class="mediaobject"><a id="med_id00279"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069240.png.jpg" alt="image with no caption" width="455" height="531"></div></div><p><span class="strong"><strong>Change is inevitable.</strong></span> No matter how much you like your software right now, it’s probably going to <span class="strong"><strong>change</strong></span> tomorrow. And the harder you make it for your software to change, the more difficult it’s going to be to respond to your <span class="strong"><strong>customer’s changing needs</strong></span>. In this chapter, we’re going to revisit an old friend, try and improve an existing software project, and see how <span class="strong"><strong>small changes can turn into big problems</strong></span>. In fact, we’re going to uncover a problem so big that it will take a TWO-PART chapter to solve it!</p><div class="sect1" title="Rick’s Guitars Stringed Instruments is expanding"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="rickapostrophes_guitars_stringed_instrum">Rick’s <span class="strikethrough">Guitars</span> Stringed Instruments is expanding</h2></div></div></div><p>Fresh off the heels of selling three guitars to the rock group Augustana, Rick’s guitar business is doing better than ever—and the search tool you built Rick back in <a class="xref" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Well-Designed Apps Rock: Great Software Begins Here">Chapter&nbsp;1</a> is the cornerstone of his business.</p><div class="informalfigure"><a id="med_id00280a"></a><div class="mediaobject"><a id="med_id00280"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069242.png.jpg" alt="image with no caption" width="589" height="712"></div></div><div class="informalfigure"><a id="med_id00281a"></a><div class="mediaobject"><a id="med_id00281"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069244.png.jpg" alt="image with no caption" width="290" height="363"></div></div></div><div class="sect1" title="Let’s put our design to the test"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_put_our_design_to_the_tes">Let’s put our design to the test</h2></div></div></div><p>We’ve talked a lot about good analysis and design being the key to software that you can reuse and extend... and now it looks like we’re going to have to prove that to Rick. Let’s figure out how easy it is to restructure his application so that it supports mandolins.</p><div class="sidebar"><a id="sharpen_your_pencil-id00072"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1620" class="indexterm"></a>Add support for mandolins to Rick’s search tool.</p><p>Below is the completed class diagram for Rick’s guitar search app, just like it was when we finished up with <a class="xref" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Well-Designed Apps Rock: Great Software Begins Here">Chapter&nbsp;1</a>. It’s up to you to add to this diagram so that Rick can start selling mandolins, and your search tool can help him find mandolins that match his clients’ preferences, just like he already can with guitars.</p><div class="informalfigure"><a id="med_id00282a"></a><div class="mediaobject"><a id="med_id00282"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069246.png.jpg" alt="image with no caption" width="763" height="683"></div></div><div class="note" title="Note"><h3 class="title"><a id="ch05note01"></a>Note</h3><p>HINT: Do a Guitar and Mandolin have anything in common? If so, maybe a little <span class="underline">inheritance</span> might be the way to go.</p></div></div><div class="sidebar"><a id="sharpen_your_pencil_partial_answers"></a><div class="sidebar-title">Sharpen your pencil partial answers</div><p><a id="iddle1002" class="indexterm"></a><a id="iddle1422" class="indexterm"></a><a id="iddle1621" class="indexterm"></a>Add support for mandolins to Rick’s search tool.</p><p>Below is the completed class diagram for Rick’s guitar search app, just like it was when we finished up with <a class="xref" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Well-Designed Apps Rock: Great Software Begins Here">Chapter&nbsp;1</a>. Here’s what we did first to add support for mandolins (we’ll make some more changes over the next few pages).</p><div class="informalfigure"><a id="med_id00283a"></a><div class="mediaobject"><a id="med_id00283"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069248.png.jpg" alt="image with no caption" width="846" height="679"></div></div></div></div><div class="sect1" title="Did you notice that abstract base class?"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="did_you_notice_that_abstract_base_classq">Did you notice that abstract base class?</h2></div></div></div><p><a id="iddle1368" class="indexterm"></a><a id="iddle1371" class="indexterm"></a><a id="iddle1496" class="indexterm"></a><a id="iddle1725" class="indexterm"></a>Take a close look at the new <span class="strong"><strong><code class="literal">Instrument</code></strong></span> class that we created:</p><div class="informalfigure"><a id="med_id00284a"></a><div class="mediaobject"><a id="med_id00284"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069250.png.jpg" alt="image with no caption" width="406" height="183"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Abstract classes are <span class="underline">placeholders</span> for actual implementation classes.</strong></span></p></blockquote></div><p>Instrument is an abstract class: that means that you can’t create an instance of <span class="strong"><strong><code class="literal">Instrument</code></strong></span>. You have to define subclasses of <span class="strong"><strong><code class="literal">Instrument</code></strong></span>, like we did with <span class="strong"><strong><code class="literal">Mandolin</code></strong></span> and <span class="strong"><strong><code class="literal">Guitar</code></strong></span>:</p><div class="informalfigure"><a id="med_id00285a"></a><div class="mediaobject"><a id="med_id00285"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069252.png.jpg" alt="image with no caption" width="540" height="389"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>The abstract class <span class="underline">defines</span> <span class="underline">behavior</span>, and the subclasses <span class="underline">implement</span> <span class="underline">that</span> <span class="underline">behavior</span>.</strong></span></p></blockquote></div><p>We made <span class="strong"><strong><code class="literal">Instrument</code></strong></span> abstract because <span class="strong"><strong><code class="literal">Instrument</code></strong></span> is just a <span class="strong"><strong><span class="emphasis"><em>placeholder</em></span></strong></span> for actual instruments like <span class="strong"><strong><code class="literal">Guitar</code></strong></span> and <span class="strong"><strong><code class="literal">Mandolin</code></strong></span>. An abstract class defines some basic behavior, but it’s really the <span class="emphasis"><em>subclasses</em></span> of the abstract class that add the implementation of those behaviors. <span class="strong"><strong><code class="literal">Instrument</code></strong></span> is just a generic class that stands in for your actual implementation classes.</p></div><div class="sect1" title="We’ll need a MandolinSpec class, too"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="weapostrophell_need_a_mandolinspec_class">We’ll need a MandolinSpec class, too</h2></div></div></div><p><a id="iddle1423" class="indexterm"></a>Mandolins and guitars are similar, but there are just a few things different about mandolins... we can capture those differences in a <span class="strong"><strong><code class="literal">MandolinSpec</code></strong></span> class:</p><div class="informalfigure"><a id="med_id00286a"></a><div class="mediaobject"><a id="med_id00286"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069254.png.jpg" alt="image with no caption" width="777" height="394"></div></div><p>It’s OK if you don’t know anything about mandolins, or didn’t figure out the different properties in the MandolinSpec class. The main thing is that you realized we probably need a new class for mandolins and their specs. If you came up with using an Instrument interface or abstract class, all the better!</p><div class="informalfigure"><a id="med_id00287a"></a><div class="mediaobject"><a id="med_id00287"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069256.png.jpg" alt="image with no caption" width="485" height="344"></div></div><div class="note" title="Brain Power"><h3 class="title"><a id="ch05note02"></a>Brain Power</h3><p>What do you think about this design? Will it do what the customer wants it to do? How flexible is it? Do you think software designed like this will be easy to extend and maintain?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00073"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa1qe1"></a><a id="ch05qa1q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1374" class="indexterm"></a><a id="iddle1786" class="indexterm"></a><span class="strong"><strong>Q: We made Instrument abstract because we abstracted the properties common to Guitar and Mandolin into it, right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa1q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> No, we made <span class="strong"><strong><code class="literal">Instrument</code></strong></span> abstract because in Rick’s system right now, there’s no such thing as an actual “instrument.” All it does is provide a common place to store properties that exist in both the <span class="strong"><strong><code class="literal">Guitar</code></strong></span> and <span class="strong"><strong><code class="literal">Mandolin</code></strong></span> classes. But since an instrument currently has no behavior outside of its subclasses, it’s really just defining common attributes and properties that all instruments need to implement.</p><p>So while we did abstract out the properties common to both instrument types, that doesn’t necessarily mean that <span class="strong"><strong><code class="literal">Instrument</code></strong></span> <span class="emphasis"><em>has</em></span> to be abstract. In fact, we might later make <span class="strong"><strong><code class="literal">Instrument</code></strong></span> a concrete class, if that starts to make sense in our design...</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa1qe2"></a><a id="ch05qa1q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Couldn’t we do the same thing with GuitarSpec and MandolinSpec? It looks like they share a lot of common attributes and operations, just like Guitar and Mandolin.</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa1q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Good idea! We can create another abstract base class, called <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, and then have <span class="strong"><strong><code class="literal">GuitarSpec</code></strong></span> and <span class="strong"><strong><code class="literal">MandolinSpec</code></strong></span> inherit from that base class:</p><div class="informalfigure"><a id="med_id00288a"></a><div class="mediaobject"><a id="med_id00288"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069258.png.jpg" alt="image with no caption" width="486" height="377"></div></div></td></tr></tbody></table></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Let’s put everything together...</strong></span></p></blockquote></div></div></div><div class="sect1" title="Behold: Rick’s new application"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="behold_rickapostrophes_new_application">Behold: Rick’s new application</h2></div></div></div><p>It looks like all that work on design back in <a class="xref" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Well-Designed Apps Rock: Great Software Begins Here">Chapter&nbsp;1</a> has paid off; it took us less than 10 pages to add support for mandolins to Rick’s search tool. Here’s the completed class diagram:</p><div class="informalfigure"><a id="med_id00289a"></a><div class="mediaobject"><a id="med_id00289"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069260.png.jpg" alt="image with no caption" width="753" height="668"></div></div><div class="blockquote"><blockquote class="blockquote"><p><a id="iddle1004" class="indexterm"></a><a id="iddle1118" class="indexterm"></a><a id="iddle1424" class="indexterm"></a><span class="strong"><strong>Whenever you find common behavior in two or more places, look to abstract that behavior into a class, and then reuse that behavior in the common classes.</strong></span></p><div class="note" title="Note"><h3 class="title">Note</h3><p>Here’s the principle that led to us creating both the Instrument and InstrumentSpec abstract base classes.</p></div></blockquote></div><div class="informalfigure"><a id="med_id00290a"></a><div class="mediaobject"><a id="med_id00290"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069262.png.jpg" alt="image with no caption" width="849" height="649"></div></div></div><div class="sect1" title="Class diagrams dissected (again)"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="class_diagrams_dissected_left_parenthesi">Class diagrams dissected (again)</h2></div></div></div><p><a id="iddle1090" class="indexterm"></a><a id="iddle1095" class="indexterm"></a><span class="strong"><strong>Now that you’ve added abstract classes, subclasses, and a new kind of association, it’s time to upgrade your UML and class diagram skills.</strong></span></p><div class="informalfigure"><a id="med_id00291a"></a><div class="mediaobject"><a id="med_id00291"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069203.png.jpg" alt="image with no caption" width="86" height="136"></div></div><div class="informalfigure"><a id="med_id00292a"></a><div class="mediaobject"><a id="med_id00292"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069264.png.jpg" alt="image with no caption" width="849" height="613"></div></div><div class="note" title="Note"><h3 class="title"><a id="ch05note04"></a>Note</h3><p><a id="iddle1808" class="indexterm"></a><a id="iddle1824" class="indexterm"></a>Fold this page down so you can refer back to it when you forget some of UML’s notation and symbols.</p></div><div class="sidebar"><a id="uml_cheat_sheet"></a><div class="sidebar-title">UML Cheat Sheet</div><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span class="underline">What we call it in Java</span></strong></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span class="underline">What we call it in UML</span></strong></span></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span class="underline">How we show it in UML</span></strong></span></p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Abstract Class</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Abstract Class</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span class="emphasis"><em>Italicized Class Name</em></span></strong></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Relationship</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Association</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00014"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069266.png.jpg" alt="" width="193" height="12"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Inheritance</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Generalization</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00015"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069268.png.jpg" alt="" width="197" height="25"></span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>Aggregation</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>Aggregation</p></td><td style="vertical-align: top; "><p><span class="inlinemediaobject"><a id="inline_id00016"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069270.png.jpg" alt="" width="194" height="21"></span></p></td></tr></tbody></table></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00074"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa2qe1"></a><a id="ch05qa2q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Are there lots more types of symbols and notations that I’m going to have to keep up with to use UML?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa2q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> There are a lot more symbols and notations in UML, but it’s up to you how many of them you use, let alone memorize. Many people use just the basics you’ve already learned, and are perfectly happy (as are their customers and managers). But other folks like to really get into UML, and use every trick in the UML toolbox. It’s really up to you; as long as you can communicate your design, you’ve used UML the way it’s intended.</p></td></tr></tbody></table></div></blockquote></div></div></div><div class="sect1" title="Let’s code Rick’s new search tool"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_code_rickapostrophes_new">Let’s code Rick’s new search tool</h2></div></div></div><p><a id="iddle1010" class="indexterm"></a><a id="iddle1339" class="indexterm"></a><a id="iddle1367" class="indexterm"></a><a id="iddle1372" class="indexterm"></a><a id="iddle1420" class="indexterm"></a>We can start off by creating a new class, <span class="strong"><strong><code class="literal">Instrument</code></strong></span>, and making it abstract. Then we put all the properties common to an instrument in this class:</p><div class="informalfigure"><a id="med_id00293a"></a><div class="mediaobject"><a id="med_id00293"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069272.png.jpg" alt="image with no caption" width="761" height="446"></div></div><p>Next we need to rework <span class="strong"><strong><code class="literal">Guitar.java</code></strong></span>, and create a class for mandolins. These both extend <span class="strong"><strong><code class="literal">Instrument</code></strong></span> to get the common instrument properties, and then define their own constructors with the right type of spec class:</p><div class="informalfigure"><a id="med_id00294a"></a><div class="mediaobject"><a id="med_id00294"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069274.png.jpg" alt="image with no caption" width="848" height="304"></div></div></div><div class="sect1" title="Create an abstract class for instrument specifications"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="create_an_abstract_class_for_instrument">Create an abstract class for instrument specifications</h2></div></div></div><p><a id="iddle1375" class="indexterm"></a><a id="iddle1378" class="indexterm"></a>With the instruments taken care of, we can move on to the spec classes. We need to create another abstract class, <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, since so many instruments have common specifications:</p><div class="informalfigure"><a id="med_id00295a"></a><div class="mediaobject"><a id="med_id00295"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069276.png.jpg" alt="image with no caption" width="816" height="637"></div></div></div><div class="sect1" title="Let’s code GuitarSpec..."><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_code_guitarspechellip">Let’s code GuitarSpec...</h2></div></div></div><p><a id="iddle1348" class="indexterm"></a>With <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> coded up, it’s pretty simple to write the <span class="strong"><strong><code class="literal">GuitarSpec</code></strong></span> class:</p><div class="informalfigure"><a id="med_id00296a"></a><div class="mediaobject"><a id="med_id00296"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069278.png.jpg" alt="image with no caption" width="640" height="560"></div></div><div class="informalfigure"><a id="med_id00297a"></a><div class="mediaobject"><a id="med_id00297"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069280.png.jpg" alt="image with no caption" width="1000" height="235"></div></div></div><div class="sect1" title="... and MandolinSpec, too"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="hellip_and_mandolinspeccomma_too">... and MandolinSpec, too</h2></div></div></div><p><a id="iddle1421" class="indexterm"></a><a id="iddle1425" class="indexterm"></a><a id="iddle1718" class="indexterm"></a>After seeing <span class="strong"><strong><code class="literal">GuitarSpec</code></strong></span>, <span class="strong"><strong><code class="literal">MandolinSpec</code></strong></span> is pretty simple. It’s very similar, with the addition of a member variable to reference the mandolin’s style (like “A” or “F” style), and a slightly different <span class="strong"><strong><code class="literal">matches()</code></strong></span> method:</p><div class="informalfigure"><a id="med_id00298a"></a><div class="mediaobject"><a id="med_id00298"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069282.png.jpg" alt="image with no caption" width="759" height="526"></div></div></div><div class="sect1" title="Finishing up Rick’s search tool"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="finishing_up_rickapostrophes_search_tool">Finishing up Rick’s search tool</h2></div></div></div><p><a id="iddle1003" class="indexterm"></a><a id="iddle1387" class="indexterm"></a><a id="iddle1397" class="indexterm"></a>All that’s left is to update the <span class="strong"><strong><code class="literal">Inventory</code></strong></span> class to work with multiple instrument types, instead of just the <span class="strong"><strong><code class="literal">Guitar</code></strong></span> class:</p><div class="informalfigure"><a id="med_id00299a"></a><div class="mediaobject"><a id="med_id00299"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069284.png.jpg" alt="image with no caption" width="318" height="183"></div></div><div class="informalfigure"><a id="med_id00300a"></a><div class="mediaobject"><a id="med_id00300"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069286.png.jpg" alt="image with no caption" width="835" height="817"></div></div><p>At this point, you’re ready to try out Rick’s improved app. See if you can update FindGuitarTester on your own, and see how things are working with these design changes.</p><div class="sidebar"><a id="there_are_no_dumb_questions-id00075"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3qe1"></a><a id="ch05qa3q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1785" class="indexterm"></a><span class="strong"><strong>Q: Guitar and Mandolin only have a constructor. That seems sort of silly. Do we really need a subclass for each type of instrument just for that?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> We do, at least for now. Otherwise, how could you tell a mandolin from a guitar? There’s no other way to figure out what type of instrument you’re working with than by checking the type of the class. Besides, those subclasses allow us to have constructors that ensure that the right type of spec is passed in. So you can’t create a <span class="strong"><strong><code class="literal">Guitar</code></strong></span>, and pass a <span class="strong"><strong><code class="literal">MandolinSpec</code></strong></span> into its constructor.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note05"></a>Note</h3><p>These are little indicators that we may have a design problem. When things just don’t seem to make sense in your application, you may want to investigate a little further... which is exactly what we’re about to do.</p></div></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3qe2"></a><a id="ch05qa3q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: But with Instrument as an abstract class, the addInstrument() method in Inventory.java becomes a real pain!</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> You’re talking about <span class="strong"><strong><code class="literal">addInstrument()</code></strong></span> in <a class="xref" href="ch05.html#uh_ohhellip_adding_new_instruments_is_no" title="Uh oh... adding new instruments is not easy!">Uh oh... adding new instruments is <span class="underline">not</span> easy!</a>, aren’t you? Yes, with <span class="strong"><strong><code class="literal">Instrument</code></strong></span> as an abstract class, you do have some extra code to deal with. But it’s still a fairly small price to pay to ensure that you can’t create an <span class="strong"><strong><code class="literal">Instrument</code></strong></span>, which really doesn’t exist in the real world.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3qe3"></a><a id="ch05qa3q3"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Isn’t there some middle ground, though? I mean, even if there’s no such thing as an “instrument” that isn’t a guitar or mandolin or whatever, it still seems like we must have a design problem somewhere. Right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3q3a3"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Well, you may be onto something. It does seem like parts of our code would benefit from a concrete <span class="strong"><strong><code class="literal">Instrument</code></strong></span> class, while other parts wouldn’t. Sometimes this means you have to make a decision one way or the other, and just accept the trade-off. But maybe there’s more going on here that we’re not thinking about...</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3qe4"></a><a id="ch05qa3q4"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Why do we have two different versions of search()? Can’t we combine those into a single method that takes an InstrumentSpec?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05qa3q4a4"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Since <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> is an abstract class, like <span class="strong"><strong><code class="literal">Instrument</code></strong></span>, Rick’s clients will have to give either a <span class="strong"><strong><code class="literal">GuitarSpec</code></strong></span> or a <span class="strong"><strong><code class="literal">MandolinSpec</code></strong></span> to the <span class="strong"><strong><code class="literal">search()</code></strong></span> method in <span class="strong"><strong><code class="literal">Inventory</code></strong></span>. And since a spec will match only other specs of the same instrument type, there’s never a case where both mandolins <span class="emphasis"><em>and</em></span> guitars would be returned in the list of matching instruments. So even if you consolidated the two <span class="strong"><strong><code class="literal">search()</code></strong></span> methods into one, you wouldn’t get any functionality benefit—and even worse, it might <span class="emphasis"><em>look</em></span> like the method would return both mandolins and guitars (since the return type of <span class="strong"><strong><code class="literal">search()</code></strong></span> would be <span class="strong"><strong><code class="literal">Instrument [*]</code></strong></span>), even though it never actually would.</p></td></tr></tbody></table></div></blockquote></div></div><div class="informalfigure"><a id="med_id00301a"></a><div class="mediaobject"><a id="med_id00301"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069288.png.jpg" alt="image with no caption" width="475" height="480"></div></div><p><span class="strong"><strong>You’ve made some <span class="underline">MAJOR</span> improvements to Rick’s app</strong></span></p><p>You’ve done a lot more than just add support for mandolins to Rick’s application. By abstracting common properties and behavior into the <span class="strong"><strong><code class="literal">Instrument</code></strong></span> and <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> classes, you’ve made the classes in Rick’s app more independent. That’s a significant improvement in his design.</p><div class="informalfigure"><a id="med_id00302a"></a><div class="mediaobject"><a id="med_id00302"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069290.png.jpg" alt="image with no caption" width="437" height="542"></div></div><p><span class="strong"><strong>Great software isn’t built in a day</strong></span></p><p>Along with some major design improvements, we’ve uncovered a few problems with the search tool. That’s OK... you’re almost always going to find a few new problems when you make big changes to your design.</p><p>So now our job is to take Rick’s better-designed application, and see if we can improve it even further... to take it from good software to GREAT software.</p><div class="sidebar"><a id="three_steps_to_great_software_left_paren"></a><div class="sidebar-title"><span class="underline">3</span> <span class="underline">steps</span> to great software (revisited)</div><p><a id="iddle1333" class="indexterm"></a><a id="iddle1698" class="indexterm"></a>Is Rick’s search tool <span class="strong"><strong>great software</strong></span>?</p><p>Remember the three things we talked about that you can do to write great software? Let’s review them to see how well we’ve done on the latest version of Rick’s search tool.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Does the new search tool do what it’s supposed to do?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></li><li class="listitem"><p>Have you used solid OO principles, like encapsulation, to avoid duplicate code and make your software easy to extend?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></li><li class="listitem"><p>How easy is it to reuse Rick’s application? Do changes to one part of the app force you to make lots of changes in other parts of the app? Is his software loosely coupled?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><div class="note" title="Note"><h3 class="title"><a id="ch05note06"></a>Note</h3><p>Be sure to answer these questions, and then turn the page to see what we wrote down.</p></div><div class="informalfigure"><a id="med_id00303a"></a><div class="mediaobject"><a id="med_id00303"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069292.png.jpg" alt="image with no caption" width="449" height="367"></div></div></li></ol></div></div><div class="sidebar"><a id="exercise_solutions-id00076"></a><div class="sidebar-title">Exercise Solutions</div><p><a id="iddle1334" class="indexterm"></a>Is Rick’s search tool <span class="strong"><strong>great software</strong></span>?</p><p>Remember the three things we talked about that you can do to write great software? Let’s review them to see how well we’ve done on the latest version of Rick’s search tool.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Does the new search tool do what it’s supposed to do?</p><p><span class="strong"><strong><span class="underline">Absolutely. It finds guitars and mandolins, although not at the same time. So maybe it just mostly does what it’s supposed to do. Better ask Rick to be sure...</span></strong></span></p></li><li class="listitem"><p>Have you used solid OO principles, like encapsulation, to avoid duplicate code and make your software easy to extend?</p><p><span class="strong"><strong><span class="underline">We used encapsulation when we came up with the InstrumentSpec classes, and inheritance when we developed an Instrument and InstrumentSpec abstract superclass. But it still takes a lot of work to add new instrument types...</span></strong></span></p></li><li class="listitem"><p>How easy is it to reuse Rick’s application? Do changes to one part of the app force you to make lots of changes in other parts of the app? Is his software loosely coupled?</p><p><span class="strong"><strong><span class="underline">It’s sort of hard to use just parts of Rick’s application. Everything’s pretty tightly connected, and InstrumentSpec is actually part of Instrument (remember when we talked about aggregation?).</span></strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch05note07"></a>Note</h3><p>It’s OK if you got some different answers and had different ideas than we did on these questions... just make sure you thought things through, and that you understand why we answered how we did.</p></div><div class="informalfigure"><a id="med_id00304a"></a><div class="mediaobject"><a id="med_id00304"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069294.png.jpg" alt="image with no caption" width="321" height="380"></div></div></li></ol></div></div><div class="informalfigure"><a id="med_id00305a"></a><div class="mediaobject"><a id="med_id00305"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069296.png.jpg" alt="image with no caption" width="734" height="508"></div></div><p><a id="iddle1699" class="indexterm"></a><a id="iddle1899" class="indexterm"></a><span class="strong"><strong>One of the best ways to see if software is well-designed is to try and <span class="underline">CHANGE</span> it.</strong></span></p><p>If your software is hard to change, there’s probably something you can improve about the design. Let’s see how hard it is to add a couple of new instruments to Rick’s app:</p><div class="informalfigure"><a id="med_id00306a"></a><div class="mediaobject"><a id="med_id00306"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069298.png.jpg" alt="image with no caption" width="799" height="651"></div></div></div><div class="sect1" title="Uh oh... adding new instruments is not easy!"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="uh_ohhellip_adding_new_instruments_is_no">Uh oh... adding new instruments is <span class="underline">not</span> easy!</h2></div></div></div><p><a id="iddle1370" class="indexterm"></a><a id="iddle1719" class="indexterm"></a>If ease of change is how we determine if our software is well-designed, then we’ve got some real issues here. Every time we need to add a new instrument, we have to add another subclass of <span class="strong"><strong><code class="literal">Instrument</code></strong></span>:</p><div class="informalfigure"><a id="med_id00307a"></a><div class="mediaobject"><a id="med_id00307"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069300.png.jpg" alt="image with no caption" width="681" height="213"></div></div><p>Then, we need a new subclass of <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, too:</p><div class="informalfigure"><a id="med_id00308a"></a><div class="mediaobject"><a id="med_id00308"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069302.png.jpg" alt="image with no caption" width="780" height="213"></div></div><p>Then things start to really get nasty when you have to update the <span class="strong"><strong><code class="literal">Inventory</code></strong></span> class’s methods to support the new instrument type:</p><div class="informalfigure"><a id="med_id00309a"></a><div class="mediaobject"><a id="med_id00309"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069304.png.jpg" alt="image with no caption" width="862" height="283"></div></div></div><div class="sect1" title="So what are we supposed to do now?"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="so_what_are_we_supposed_to_do_nowquestio">So what are we supposed to do now?</h2></div></div></div><p>It looks like we’ve definitely still got some work to do to turn Rick’s application into great software that’s truly easy to change and extend. But that doesn’t mean the work you’ve done isn’t important... lots of times, you’ve got to improve your design to find some problems that weren’t so apparent earlier on. Now that we’ve applied some of our OO principles to Rick’s search tool, we’ve been able to locate some issues that we’re going to have to resolve if we don’t want to spend the next few years writing new <span class="strong"><strong><code class="literal">Banjo</code></strong></span> and <span class="strong"><strong><code class="literal">Fiddle</code></strong></span> classes (and who really wants to do that?).</p><p>Before you’re ready to really tackle the next phase of Rick’s app, though, there are a few things you need to know about. So, without further ado, let’s take a quick break from Rick’s software, and tune in to...</p><div class="informalfigure"><a id="med_id00310a"></a><div class="mediaobject"><a id="med_id00310"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069306.png.jpg" alt="image with no caption" width="250" height="419"></div></div><div class="informalfigure"><a id="med_id00311a"></a><div class="mediaobject"><a id="med_id00311"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069308.png.jpg" alt="image with no caption" width="428" height="74"></div></div></div><div class="sect1" title="OO CATASTROPHE: Objectville’s Favorite Quiz Show"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="oo_catastrophe_objectville_favor">OO CATASTROPHE: Objectville’s Favorite Quiz Show</h2></div></div></div><div class="informalfigure"><a id="med_id00313a"></a><div class="mediaobject"><a id="med_id00313"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069310.png.jpg" alt="image with no caption" width="662" height="684"></div></div><div class="informalfigure"><a id="med_id00314a"></a><div class="mediaobject"><a id="med_id00314"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069312.png.jpg" alt="image with no caption" width="464" height="446"></div></div><div class="sidebar"><a id="there_are_no_dumb_answers"></a><div class="sidebar-title">there are no Dumb Answers</div><p><a id="iddle1755" class="indexterm"></a><span class="strong"><strong>A:</strong></span> It might not seem like it, but we are working on Rick’s search tool, in a manner of speaking. We’re going to need some pretty advanced OO techniques to make his application flexible and reusable, and we wanted to give you a chance to get a handle on these principles before you had to start applying them to a pretty complicated problem.</p><p><span class="strong"><strong>Q: Why are we playing a game show? Shouldn’t we be fixing Rick’s search tool?</strong></span></p><p><span class="strong"><strong>A:</strong></span> The questions that match up with the answers in this chapter aren’t easy, but you should be able to reason them all out. Take your time; it’s important that you come up with these questions on your own if at all possible, and only then turn the page to get a little more information on each question and the OO principle it involves. Besides, we think you’re getting to be a pretty kick-ass developer, so we have lots of confidence in you.</p><p><span class="strong"><strong>Q: If these are new OO principles, how am I supposed to figure out what the questions are? That’s asking a lot, isn’t it?</strong></span></p></div><div class="informalfigure"><a id="med_id00315a"></a><div class="mediaobject"><a id="med_id00315"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069314.png.jpg" alt="image with no caption" width="723" height="124"></div></div><div class="informalfigure"><a id="med_id00316a"></a><div class="mediaobject"><a id="med_id00316"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069316.png.jpg" alt="image with no caption" width="595" height="559"></div></div></div><div class="sect1" title="“What is an INTERFACE?”"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="quotation_markwhat_is_an_interfacequesti">“What is an <span class="underline">INTERFACE</span>?”</h2></div></div></div><div class="note" title="Note"><h3 class="title"><a id="ch05note09"></a>Note</h3><p><a id="iddle1480" class="indexterm"></a><a id="iddle1296" class="indexterm"></a><a id="iddle1382" class="indexterm"></a>Did you get this? You should have asked this as the question for the answer in <a class="xref" href="ch05.html#oo_catastrophe_objectville_favor" title="OO CATASTROPHE: Objectville’s Favorite Quiz Show">OO CATASTROPHE: Objectville’s Favorite Quiz Show</a>.</p></div><p>Suppose you’ve got an application that has an interface, and then lots of subclasses that inherit common behavior from that interface:</p><div class="informalfigure"><a id="med_id00317a"></a><div class="mediaobject"><a id="med_id00317"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069318.png.jpg" alt="image with no caption" width="536" height="275"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Coding to an <span class="underline">interface</span>, rather than to an implementation, makes your software <span class="underline">easier</span> <span class="underline">to</span> <span class="underline">extend</span>.</strong></span></p></blockquote></div><p>Anytime you’re writing code that interacts with these classes, you have two choices. You can write code that interacts directly with a subclass, like <span class="strong"><strong><code class="literal">FootballPlayer</code></strong></span>, or you can write code that interacts with the interface, <span class="strong"><strong><code class="literal">Athlete</code></strong></span>. When you run into a choice like this, you should <span class="emphasis"><em>always</em></span> favor <span class="strong"><strong><span class="emphasis"><em>coding to the interface, not the implementation</em></span></strong></span>.</p><div class="informalfigure"><a id="med_id00318a"></a><div class="mediaobject"><a id="med_id00318"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069320.png.jpg" alt="image with no caption" width="487" height="219"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>By coding to an interface, your code will work with <span class="underline">all</span> of the interface’s subclasses—even ones that <span class="underline">haven’t been created yet</span>.</strong></span></p></blockquote></div><p>Why is this so important? Because it adds <span class="strong"><strong><span class="emphasis"><em>flexibility</em></span></strong></span> to your app. Instead of your code being able to work with only one specific subclass—like <span class="strong"><strong><code class="literal">BaseballPlayer</code></strong></span>—you’re able to work with the more generic <span class="strong"><strong><code class="literal">Athlete</code></strong></span>. That means that your code will work with any subclass of <span class="strong"><strong><code class="literal">Athlete</code></strong></span>, like <span class="strong"><strong><code class="literal">HockeyPlayer</code></strong></span> or <span class="strong"><strong><code class="literal">TennisPlayer</code></strong></span>, and even subclasses that haven’t even been designed yet (anyone for <span class="strong"><strong><code class="literal">CricketPlayer</code></strong></span>?).</p><div class="informalfigure"><a id="med_id00319a"></a><div class="mediaobject"><a id="med_id00319"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069322.png.jpg" alt="image with no caption" width="595" height="484"></div></div><p><span class="strong"><strong>“What is_______________________?”</strong></span></p></div><div class="sect1" title="“What is ENCAPSULATION?”"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="quotation_markwhat_is_encapsulationquest">“What is <span class="underline">ENCAPSULATION</span>?”</h2></div></div></div><p><a id="iddle1237" class="indexterm"></a><a id="iddle1383" class="indexterm"></a><a id="iddle1491" class="indexterm"></a>We’ve talked a fair bit about encapsulation already, in terms of preventing duplicate code. But there’s more to encapsulation than just avoiding lots of copy-and-paste. Encapsulation also helps you <span class="strong"><strong><span class="emphasis"><em>protect your classes from unnecessary changes</em></span></strong></span>.</p><p>Anytime you have behavior in an application that you think is likely to change, you want to move that behavior away from parts of your application that probably <span class="emphasis"><em>won’t</em></span> change very frequently. In other words, you should always try to <span class="strong"><strong><span class="emphasis"><em>encapsulate what varies</em></span></strong></span>.</p><div class="informalfigure"><a id="med_id00320a"></a><div class="mediaobject"><a id="med_id00320"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069324.png.jpg" alt="image with no caption" width="519" height="261"></div></div><p>It looks like <span class="strong"><strong><code class="literal">Painter</code></strong></span> has two methods that are pretty stable, but that <span class="strong"><strong><code class="literal">paint()</code></strong></span> method is going to vary a lot in its implementation. So let’s encapsulate what varies, and move the implementation of how a painter paints out of the <span class="strong"><strong><code class="literal">Painter</code></strong></span> class.</p><div class="informalfigure"><a id="med_id00321a"></a><div class="mediaobject"><a id="med_id00321"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069326.png.jpg" alt="image with no caption" width="823" height="379"></div></div><div class="informalfigure"><a id="med_id00322a"></a><div class="mediaobject"><a id="med_id00322"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069328.png.jpg" alt="image with no caption" width="595" height="508"></div></div><p><span class="strong"><strong>“What is_______________________?”</strong></span></p></div><div class="sect1" title="“What is CHANGE?”"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="quotation_markwhat_is_changequestion_mar">“What is <span class="underline">CHANGE?</span>”</h2></div></div></div><p><a id="iddle1084" class="indexterm"></a>You already know that the one constant in software is CHANGE. Software that isn’t well-designed falls apart at the first sign of change, but great software can change easily.</p><p>The easiest way to make your software resilient to change is to make sure <span class="strong"><strong><span class="emphasis"><em>each class has only one reason to change</em></span></strong></span>. In other words, you’re minimizing the chances that a class is going to have to change by reducing the number of things in that class that can <span class="bolditalic"><span class="underline">cause</span></span> it to change.</p><div class="informalfigure"><a id="med_id00323a"></a><div class="mediaobject"><a id="med_id00323"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069330.png.jpg" alt="image with no caption" width="622" height="293"></div></div><p>When you see a class that has more than one reason to change, it is probably <span class="strong"><strong><span class="emphasis"><em>trying to do too many things</em></span></strong></span>. See if you can break up the functionality into multiple classes, where <span class="strong"><strong><span class="emphasis"><em>each individual class does only one thing</em></span></strong></span>—and therefore has only <span class="strong"><strong>one</strong></span> reason to change.</p><div class="informalfigure"><a id="med_id00324a"></a><div class="mediaobject"><a id="med_id00324"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069332.png.jpg" alt="image with no caption" width="826" height="255"></div></div><div class="sidebar"><a id="final_catastropheexclamation_mark"></a><div class="sidebar-title">Final Catastrophe!</div><div class="informalfigure"><a id="med_id00325a"></a><div class="mediaobject"><a id="med_id00325"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069334.png.jpg" alt="image with no caption" width="808" height="989"></div></div></div><div class="sidebar"><a id="final_catastropheexclamation_mark_answer"></a><div class="sidebar-title">Final Catastrophe! Answers</div><div class="informalfigure"><a id="med_id00326a"></a><div class="mediaobject"><a id="med_id00326"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069336.png.jpg" alt="image with no caption" width="855" height="574"></div></div></div><div class="sidebar"><a id="there_are_no_dumb_answers-id00077"></a><div class="sidebar-title">There are no Dumb Answers</div><p><a id="iddle1180" class="indexterm"></a><a id="iddle1181" class="indexterm"></a><a id="iddle1284" class="indexterm"></a><a id="iddle1384" class="indexterm"></a><a id="iddle1770" class="indexterm"></a><span class="strong"><strong>A:</strong></span> You’ve seen several times already that when you see a potential for duplicate code, you should look to encapsulate. In this case, it’s reasonable to assume that serving a <span class="strong"><strong><code class="literal">Sundae</code></strong></span> probably isn’t that different from serving a <span class="strong"><strong><code class="literal">Cone</code></strong></span>.</p><p>So you could create a new class, called <span class="strong"><strong><code class="literal">DessertService</code></strong></span>, and put the <span class="strong"><strong><code class="literal">serve()</code></strong></span> method in that class. Then, all of your <span class="strong"><strong><code class="literal">Dessert</code></strong></span>, <span class="strong"><strong><code class="literal">IceCream</code></strong></span>, and <span class="strong"><strong><code class="literal">Topping</code></strong></span> classes could simply refer to <span class="strong"><strong><code class="literal">DessertService.serve()</code></strong></span>. If <span class="strong"><strong><code class="literal">serve()</code></strong></span> changes, you’ve got to update code in only one place: <span class="strong"><strong><code class="literal">DessertService</code></strong></span>.</p><p>So you’re encapsulating what might vary—the code in the <span class="strong"><strong><code class="literal">serve()</code></strong></span> method—and you’re making sure that each class has only a single reason to change. That’s a double win!</p><p><span class="strong"><strong>Q: How did you know to encapsulate the serve() methods out of all those different classes? I missed that.</strong></span></p></div><div class="informalfigure"><a id="med_id00327a"></a><div class="mediaobject"><a id="med_id00327"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069338.png.jpg" alt="image with no caption" width="801" height="649"></div></div><div class="informalfigure"><a id="med_id00328a"></a><div class="mediaobject"><a id="med_id00328"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069340.png.jpg" alt="image with no caption" width="552" height="564"></div></div><p><a id="iddle1238" class="indexterm"></a><a id="iddle1385" class="indexterm"></a><a id="iddle1482" class="indexterm"></a><span class="strong"><strong>You’re ready to tackle Rick’s inflexible code now</strong></span></p><p>With a few new OO tools and techniques under your belt, you’re definitely ready to go back to Rick’s software, and make it a lot more flexible. By the time you’re done, you’ll have used everything you’ve just learned on <span class="strong"><strong>OO Catastrophe</strong></span>, and made it easy to change Rick’s application, too.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note10"></a>Note</h3><p><span class="strong"><strong>OO Principles</strong></span></p><p>Encapsulate what varies.</p><p>Code to an interface rather than to an implementation.</p><p>Each class in your application should have only one reason to change.</p><div class="blockquote"><blockquote class="blockquote"><p>These three principles are HUGE! Take note of them, as we’ll be using them a lot in the upcoming chapters.</p></blockquote></div></div></div><div class="sect1" title="(part 2) good design = flexible software: Give Your Software a 30-minute Workout"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="part_2_good_design_flexible_software">(part 2) good design = flexible software: Give Your Software a 30-minute Workout</h2></div></div></div><div class="informalfigure"><a id="med_id00329a"></a><div class="mediaobject"><a id="med_id00329"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069342.png.jpg" alt="image with no caption" width="504" height="502"></div></div><p><span class="strong"><strong>Ever wished you were just a bit more flexible?</strong></span> When you run into problems making changes to your application, it probably means that your software needs to be <span class="strong"><strong>more flexible and resilient</strong></span>. To help stretch your application out, you’re going to do some analysis, a whole lot of design, and learn how OO principles can really <span class="strong"><strong>loosen up your application</strong></span>. And for the grand finale, you’ll see how <span class="strong"><strong>higher cohesion can really help your coupling</strong></span>. Sound interesting? Turn the page, and let’s get back to fixing that inflexible application.</p></div><div class="sect1" title="Back to Rick’s search tool"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="back_to_rickapostrophes_search_tool">Back to Rick’s search tool</h2></div></div></div><p><a id="iddle1559" class="indexterm"></a>Loaded up with some new OO principles, we’re ready to tackle making Rick’s application well-designed and flexible. Here’s where we left off, and some of the problems we’ve discovered:</p><div class="informalfigure"><a id="med_id00330a"></a><div class="mediaobject"><a id="med_id00330"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069344.png.jpg" alt="image with no caption" width="662" height="682"></div></div><div class="informalfigure"><a id="med_id00331a"></a><div class="mediaobject"><a id="med_id00331"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069346.png.jpg" alt="image with no caption" width="740" height="610"></div></div><div class="informalfigure"><a id="med_id00332a"></a><div class="mediaobject"><a id="med_id00332"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069348.png.jpg" alt="image with no caption" width="480" height="417"></div></div><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Yeah, it’s a pain, but I don’t see any way to get around it. We have to let Rick’s clients search for each different type of instrument somehow.</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;I still don’t see why we can’t have just one search() method that takes in an InstrumentSpec. Wouldn’t that cut down on all those different versions of search()?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Well, it would, but we still don’t have any way to return multiple types of instruments. If the client provides a GuitarSpec, it’s never going to match a BanjoSpec or MandolinSpec. So the list returned from search() will always have only the type of instrument that the client’s spec is for.</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;Because we can’t instantiate InstrumentSpec, right? It’s an abstract class, so we have to create a MandolinSpec, or a BanjoSpec, or whatever.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;So maybe that’s the problem... besides, shouldn’t we be coding to an interface like InstrumentSpec, not an implementation like GuitarSpec or BanjoSpec?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;Hmmm. I hadn’t thought about that, but you’re right; we really should be focusing on the interface, and not all those implementation classes.</p></div><div class="sect1" title="A closer look at the search() method"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="closer_look_at_the_searchleft_parenthesi">A closer look at the search() method</h2></div></div></div><p><a id="iddle1376" class="indexterm"></a><a id="iddle1393" class="indexterm"></a>It seems pretty clear that there’s a problem with the way we’re handling searches for Rick’s clients. We could make <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> a concrete class, but would that solve all our problems?</p><div class="informalfigure"><a id="med_id00333a"></a><div class="mediaobject"><a id="med_id00333"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069350.png.jpg" alt="image with no caption" width="713" height="684"></div></div></div><div class="sect1" title="The benefits of our analysis"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="benefits_of_our_analysis">The benefits of our analysis</h2></div></div></div><p>Let’s take what we’ve figured out about turning <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> into a concrete class, and see if it makes the design of <span class="strong"><strong><code class="literal">Inventory</code></strong></span> any better.</p><div class="informalfigure"><a id="med_id00334a"></a><div class="mediaobject"><a id="med_id00334"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069352.png.jpg" alt="image with no caption" width="338" height="176"></div></div><div class="informalfigure"><a id="med_id00335a"></a><div class="mediaobject"><a id="med_id00335"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069354.png.jpg" alt="image with no caption" width="714" height="718"></div></div><div class="sidebar"><a id="sharpen_your_pencil-id00078"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1651" class="indexterm"></a>One of these things is not like the other... or is it?</p><p>The search() method isn’t the only thing that makes adding new instruments to Rick’s application difficult. You also have to add a new subclass of Instrument for each new instrument type. But why? Let’s do a little more analysis.</p><p>Why is there a need for an Instrument class in Rick’s application?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>What things are common to all instruments?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>What things are different between instruments?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>If you have any ideas for how you might change Rick’s application so that you don’t need all the instrument-specific subclasses, mark those changes on the class diagram below. Feel free to add or remove classes and properties; it’s up to you to decide how you can improve Rick’s design.</p><div class="informalfigure"><a id="med_id00336a"></a><div class="mediaobject"><a id="med_id00336"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069356.png.jpg" alt="image with no caption" width="559" height="310"></div></div></div><div class="sidebar"><a id="sharpen_your_pencil_answers-id00079"></a><div class="sidebar-title">Sharpen your pencil answers</div><p><a id="iddle1652" class="indexterm"></a>One of these things is not like the other... or is it?</p><p>The search() method isn’t the only thing that makes adding new instruments to Rick’s application difficult. You also have to add a new subclass of Instrument for each new instrument type. But why? Let’s do a little more analysis.</p><div class="informalfigure"><a id="med_id00337a"></a><div class="mediaobject"><a id="med_id00337"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069358.png.jpg" alt="image with no caption" width="662" height="331"></div></div><p>If you have any ideas for how you might change Rick’s application so that you don’t need all the instrument-specific subclasses, mark those changes on the class diagram below. Feel free to add or remove classes and properties; it’s up to you how you can improve Rick’s design.</p><div class="informalfigure"><a id="med_id00338a"></a><div class="mediaobject"><a id="med_id00338"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069360.png.jpg" alt="image with no caption" width="738" height="334"></div></div></div></div><div class="sect1" title="A closer look at the instrument classes"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="closer_look_at_the_instrument_classes">A closer look at the instrument classes</h2></div></div></div><p><a id="iddle1057" class="indexterm"></a><a id="iddle1395" class="indexterm"></a><a id="iddle1720" class="indexterm"></a>Even though <span class="strong"><strong><code class="literal">search()</code></strong></span> is looking better, there are still some real problems with all the instrument subclasses, and the <span class="strong"><strong><code class="literal">addInstrument()</code></strong></span> method in <span class="strong"><strong><code class="literal">Inventory</code></strong></span>.</p><p>Remember, we originally made <span class="strong"><strong><code class="literal">Instrument</code></strong></span> abstract because each instrument type was represented by its own subclass:</p><div class="informalfigure"><a id="med_id00339a"></a><div class="mediaobject"><a id="med_id00339"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069362.png.jpg" alt="image with no caption" width="823" height="565"></div></div></div><div class="sect1" title="But classes are really about behavior!"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="but_classes_are_really_about_behaviorexc">But classes are really about <span class="underline">behavior</span>!</h2></div></div></div><p>But the reason you usually create a subclass is because the <span class="strong"><strong>behavior</strong></span> of the subclass is different than the superclass. In Rick’s application, is the behavior of a <span class="strong"><strong><code class="literal">Guitar</code></strong></span> different than that of an <span class="strong"><strong><code class="literal">Instrument</code></strong></span>? Does it <span class="emphasis"><em>function</em></span> differently in his application than a <span class="strong"><strong><code class="literal">Mandolin</code></strong></span> or <span class="strong"><strong><code class="literal">Banjo</code></strong></span>?</p><div class="informalfigure"><a id="med_id00340a"></a><div class="mediaobject"><a id="med_id00340"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069364.png.jpg" alt="image with no caption" width="522" height="370"></div></div><p><a id="iddle1721" class="indexterm"></a>All the instruments—at least from Rick’s perspective—<span class="strong"><strong><span class="emphasis"><em>behave the same</em></span></strong></span>. So that leaves only two reasons to have subclasses for each instrument type:</p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote01"></a>Note</h3><p>If we were writing a system that represented how these instruments played, we might need subclasses to handle behavior like pluck(), strum(), or frail().</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Because the <span class="strong"><strong><code class="literal">Instrument</code></strong></span> class represents a concept, and not an actual object, it really should be abstract. So we have to have subclasses for each instrument type.</p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote02"></a>Note</h3><p>This is a good OO principle, but it sure is causing headaches with all the subclasses. We’ll come back to this one in a moment.</p></div></li><li class="listitem"><p>Each different type of instrument has different properties, and uses a different subclass of <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, so we need an instrument-specific constructor for each type of instrument.</p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote03"></a>Note</h3><p>This looks like another case where we’re coding to an implementation instead of an interface. So this isn’t a good reason to keep Instrument abstract.</p></div><p>These seem like pretty good reasons (well, at least the first one does), but we’re ending up with lots of extra classes that don’t do much... and that makes our software inflexible and difficult to change. So what do we do?</p><p><span class="strong"><strong>Remember the second step in writing great software, from back in <a class="xref" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Well-Designed Apps Rock: Great Software Begins Here">Chapter&nbsp;1</a>:</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote04"></a>Note</h3><p>Since Rick’s app already does what it needs to do (Step 1), we’re ready to try and make his software more flexible.</p></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Apply basic OO principles to add flexibility.</strong></span></p></blockquote></div><div class="note" title="Note"><h3 class="title"><a id="ch05bnote05"></a>Note</h3><p>How can we take this step and apply it to the problems we’re finding in Rick’s app?</p></div></li></ol></div><div class="sidebar"><a id="sharpen_your_pencil-id00080"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1005" class="indexterm"></a><a id="iddle1239" class="indexterm"></a><a id="iddle1357" class="indexterm"></a><a id="iddle1498" class="indexterm"></a><a id="iddle1656" class="indexterm"></a>Object-Oriented Principles to the rescue!</p><p>There’s definitely a problem with Rick’s app, but we’re not sure what it is. When you don’t know what to do to solve a design problem, just run through the OO principles you know, and see if any of them might help improve your software’s design.</p><p>For each principle, check the box if you think it could help us out. Then, if you checked the box for a principle, it’s up to you to write down how you could use that principle to improve Rick’s search tool design.</p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00017"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069366.png.jpg" alt="" width="26" height="24"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Inheritance</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00018"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069366.png.jpg" alt="" width="26" height="24"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Polymorphism</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00019"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069366.png.jpg" alt="" width="26" height="24"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Abstraction</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00020"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069366.png.jpg" alt="" width="26" height="24"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>Encapsulation</p></td><td style="vertical-align: top; "><p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p>
<p>_____________________________________________________________________</p></td></tr></tbody></table></div><p><span class="inlinemediaobject"><a id="inline_id00021"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2068819.png.jpg" alt="" width="99" height="9"></span> <span class="strong"><strong>See what we thought on the next page.</strong></span></p></div><div class="sidebar"><a id="sharpen_your_pencil_answers-id00081"></a><div class="sidebar-title">Sharpen your pencil answers</div><p><a id="iddle1657" class="indexterm"></a>Object-Oriented Principles to the rescue!</p><p>There’s definitely a problem with Rick’s app, but we’re not sure what it is. When you don’t know what to do to solve a design problem, just run through the OO principles you know, and see if any of them might help improve your software’s design.</p><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00022"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069368.png.jpg" alt="" width="40" height="43"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Inheritance</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="underline">We’re using inheritance already with the Instrument and InstrumentSpec classes, and their subclasses. But it does seem like the instrument-specific subclasses don’t actually do anything but inherit from Instrument... they just have slightly different constructors.</span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00023"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069370.png.jpg" alt="" width="40" height="48"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Polymorphism</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="underline">We use polymorphism in the search() method to treat all instruments as instances of Instrument, instead of worrying about whether they’re a Guitar or a Mandolin. So searching is a lot easier... but it would be nice to be able to use this in addInstrument(), too, and cut down on some repetitive code.</span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00024"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069372.png.jpg" alt="" width="40" height="47"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Abstraction</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p><span class="underline">InstrumentSpec abstracts the details about each instruments specifications away from the Instrument class itself, so that we can add new instrument properties without affecting the basic Instrument class.</span></p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><span class="inlinemediaobject"><a id="inline_id00025"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069374.png.jpg" alt="" width="40" height="50"></span></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>Encapsulation</p></td><td style="vertical-align: top; "><p><span class="underline">We’re using encapsulation a lot, but maybe we can use it even more... remember, encapsulate what varies! Since the properties in each instrument type are what varies, can we somehow encapsulate those properties away from Instrument and InstrumentSpec completely?</span></p></td></tr></tbody></table></div></div><div class="informalfigure"><a id="med_id00341a"></a><div class="mediaobject"><a id="med_id00341"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069376.png.jpg" alt="image with no caption" width="525" height="480"></div></div><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;<a id="iddle1240" class="indexterm"></a>Yeah, you’re talking about <span class="strong"><strong><span class="emphasis"><em>encapsulating what varies</em></span></strong></span>, right?</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Exactly! And we know that the properties for each instrument are what varies in the application.</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;I thought we’d been over this; that’s why we have all those subclasses of Instrument, like Guitar and Mandolin. So we can represent the differences between each instrument.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;But that really didn’t help... and besides, the <span class="emphasis"><em>behavior</em></span> of each instrument doesn’t vary, so do we really need subclasses for each one?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;So you’re saying we would make Instrument a concrete class, instead of being abstract, right? And then we can get rid of all those instrument-specific subclasses.</p><p title="Jim:"><span class="title"><strong><span class="strong"><strong>Jim:</strong></span></strong></span>&nbsp;But... I’m totally confused. What about the properties that vary across each instrument?</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;What about them? The Instrument class has a reference to an InstrumentSpec, and all the property differences can be handled by those classes. Look:</p><div class="informalfigure"><a id="med_id00342a"></a><div class="mediaobject"><a id="med_id00342"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069378.png.jpg" alt="image with no caption" width="854" height="475"></div></div></div><div class="sect1" title="Death of a design (decision)"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="death_of_a_design_left_parenthesisdecisi">Death of a design (decision)</h2></div></div></div><p><a id="iddle1140" class="indexterm"></a><a id="iddle1160" class="indexterm"></a>One of the hardest things you will ever do is to let go of mistakes you made <span class="emphasis"><em>in your own designs</em></span>. In Rick’s search tool, it doesn’t make sense to have separate <span class="strong"><strong><code class="literal">Instrument</code></strong></span> subclasses for each type of instrument. But it took us almost 30 pages (and 2 parts of <a class="xref" href="ch05.html" title="Chapter&nbsp;5.&nbsp;(Part 1) Good Design = Flexible Software: Nothing Ever Stays the Same">Chapter&nbsp;5</a>) to figure that out. Why?</p><p><span class="strong"><strong>Because <span class="underline">it seemed to make sense at the time</span>, and it’s <span class="underline">HARD</span> to change something you thought was already working!</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote06"></a>Note</h3><p><span class="strong"><strong><span class="emphasis"><em>Code once, look twice (or more!)</em></span></strong></span></p><p><span class="emphasis"><em>Keep looking over your designs when you run into problems. A decision you made earlier may be what’s causing you headaches now.</em></span></p><div class="informalfigure"><a id="med_id00343a"></a><div class="mediaobject"><a id="med_id00343"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069380.png.jpg" alt="image with no caption" width="104" height="92"></div></div></div><div class="informalfigure"><a id="med_id00344a"></a><div class="mediaobject"><a id="med_id00344"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069382.png.jpg" alt="image with no caption" width="337" height="516"></div></div><p>It’s easy to rip apart someone else’s code, but you’ve got to learn to look at your own code, and identify problems. This is also where peer review, having fellow programmers look at your code, can really be a lifesaver. Don’t worry if you have to make changes; a better-designed application will save you tons of time in the long run.</p><p><span class="strong"><strong>Design is <span class="underline">iterative...</span> and you have to be willing to <span class="underline">change your own designs</span>, as well as those that you inherit from other programmers.</strong></span></p><div class="note" title="Watch it!"><h3 class="title"><a id="ch05bnote07"></a>Watch it!</h3><p><span class="strong"><strong><span class="emphasis"><em>Pride kills good design</em></span></strong></span></p><p><span class="emphasis"><em>Never be afraid to examine your own design decisions, and improve on them, even if it means backtracking.</em></span></p></div></div><div class="sect1" title="Let’s turn some bad design decisions into good ones"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_turn_some_bad_design_deci">Let’s turn some bad design decisions into good ones</h2></div></div></div><p><a id="iddle1366" class="indexterm"></a><a id="iddle1722" class="indexterm"></a>Let’s kill all those instrument-specific subclasses:</p><div class="informalfigure"><a id="med_id00345a"></a><div class="mediaobject"><a id="med_id00345"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069384.png.jpg" alt="image with no caption" width="722" height="328"></div></div><p>We also probably need a new property in each instrument to let us know what type of instrument it is:</p><div class="informalfigure"><a id="med_id00346a"></a><div class="mediaobject"><a id="med_id00346"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069386.png.jpg" alt="image with no caption" width="804" height="226"></div></div><div class="informalfigure"><a id="med_id00347a"></a><div class="mediaobject"><a id="med_id00347"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069388.png.jpg" alt="image with no caption" width="525" height="281"></div></div></div><div class="sect1" title="One more cubicle conversation (and some help from Jill)"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="one_more_cubicle_conversation_left_paren">One more cubicle conversation (and some help from Jill)</h2></div></div></div><div class="informalfigure"><a id="med_id00348a"></a><div class="mediaobject"><a id="med_id00348"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069390.png.jpg" alt="image with no caption" width="470" height="487"></div></div><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;But we just did that... we made Instrument concrete, and got rid of all the instrument-specific subclasses.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;Actually, I think that’s really only the first step. What really varies in Rick’s software?</p><p><span class="strong"><strong>What varies in Rick’s app?</strong></span></p><div class="informalfigure"><a id="med_id00349a"></a><div class="mediaobject"><a id="med_id00349"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069392.png.jpg" alt="image with no caption" width="433" height="104"></div></div><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;We’ve gone through this already: the properties for each instrument are what vary.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;So can we encapsulate them somehow?</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;We already have: we used the InstrumentSpec class for that.</p><p title="Frank:"><span class="title"><strong><span class="strong"><strong>Frank:</strong></span></strong></span>&nbsp;Wait a second, Joe. We used InstrumentSpec because those properties were used by both clients and instruments. So that was more about duplicate code...</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;Yes! That’s my point... the properties inside InstrumentSpec vary, too. So maybe we need to add <span class="emphasis"><em>another</em></span> layer of encapsulation.</p><p title="Joe:"><span class="title"><strong><span class="strong"><strong>Joe:</strong></span></strong></span>&nbsp;So since the properties of each instrument vary, we should pull those out of InstrumentSpec? It’s almost like double-encapsulation or something.</p><p title="Jill:"><span class="title"><strong><span class="strong"><strong>Jill:</strong></span></strong></span>&nbsp;Sort of... we encapsulate the specifications common across client requests and instruments from the Instrument class, and then we encapsulate the properties that vary from the InstrumentSpec class.</p></div><div class="sect1" title="“Double encapsulation” in Rick’s software"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="quotation_markdouble_encapsulationquotat">“Double encapsulation” in Rick’s software</h2></div></div></div><div class="note" title="Note"><h3 class="title"><a id="ch05bnote08"></a>Note</h3><p><a id="iddle1230" class="indexterm"></a><a id="iddle1246" class="indexterm"></a>This really isn’t an OOA&amp;D term, so don’t be surprised if your professor looks at you funny if you use it in class.</p></div><p>Let’s look at the layer of encapsulation we already have, and then see how we can add a little more encapsulation to get those properties that vary out of the <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> class.</p><div class="informalfigure"><a id="med_id00350a"></a><div class="mediaobject"><a id="med_id00350"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069394.png.jpg" alt="image with no caption" width="751" height="317"></div></div><p>Since some of these properties vary, we want to move them out of the <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> class. We need a way to refer to properties and their values, but not have those properties hardcoded into the <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> class. Any ideas for how we could do that?</p><p><span class="strong"><strong>What type(s) do you think you could use to represent properties and access their values, but not have to change your InstrumentSpec class to support new properties?</strong></span></p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>By encapsulating what varies, you make your application more flexible, and easier to change.</strong></span></p></blockquote></div></div><div class="sect1" title="Getting dynamic with instrument properties"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="getting_dynamic_with_instrument_properti">Getting dynamic with instrument properties</h2></div></div></div><p><a id="iddle1508" class="indexterm"></a>What did you come up with on the last page to store properties? We decided that using a <span class="strong"><strong><code class="literal">Map</code></strong></span> would be a great way to handle various types of properties, and still be able to easily add new properties at any time:</p><div class="informalfigure"><a id="med_id00351a"></a><div class="mediaobject"><a id="med_id00351"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069396.png.jpg" alt="image with no caption" width="823" height="701"></div></div></div><div class="sect1" title="What we did: a closer look"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="what_we_did_a_closer_look">What we did: a closer look</h2></div></div></div><p><a id="iddle1110" class="indexterm"></a><a id="iddle1509" class="indexterm"></a><a id="iddle1511" class="indexterm"></a>Anytime you see something that varies, you should look for a way to encapsulate. In the case of <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, we realized that the properties of an instrument vary.</p><div class="informalfigure"><a id="med_id00352a"></a><div class="mediaobject"><a id="med_id00352"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069398.png.jpg" alt="image with no caption" width="724" height="335"></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>When you have a set of properties that vary across your objects, use a collection, like a Map, to store those properties dynamically.</strong></span></p><p><span class="strong"><strong>You’ll remove lots of methods from your classes, and avoid having to change your code when new properties are added to your app.</strong></span></p></blockquote></div></div><div class="sect1" title="Using the new Instrument and InstrumentSpec classes"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="using_the_new_instrument_and_instruments">Using the new Instrument and InstrumentSpec classes</h2></div></div></div><p><a id="iddle1373" class="indexterm"></a><a id="iddle1379" class="indexterm"></a>Let’s take one last look at how our new <span class="strong"><strong><code class="literal">Instrument</code></strong></span> and <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> classes work in practice. Here’s where we are with the design right now:</p><div class="informalfigure"><a id="med_id00353a"></a><div class="mediaobject"><a id="med_id00353"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069400.png.jpg" alt="image with no caption" width="830" height="295"></div></div><p>If you were accessing a guitar, and wanted to know who built it, here’s how you could do that:</p><div class="informalfigure"><a id="med_id00354a"></a><div class="mediaobject"><a id="med_id00354"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069402.png.jpg" alt="image with no caption" width="825" height="510"></div></div><div class="sidebar"><a id="code_magnets-id00082"></a><div class="sidebar-title">Code Magnets</div><p><a id="iddle1426" class="indexterm"></a><a id="iddle1510" class="indexterm"></a>Using a Map for storing properties seems like a good idea, but let’s see how things look once we actually code up a new version of InstrumentSpec. Your job is to finish off the code below using the magnets at the bottom of the page.</p><a id="pro_id00003"></a><pre class="programlisting">import java.util.________;
import java.util.________;
import java.util.________;

public class InstrumentSpec {

  private ______ properties;

  public InstrumentSpec(______ ___________) {
    if (properties == ______) {
      this.properties = new _________();
    } else {
      this.properties = new _________(___________);
    }
  }

  public ________ getProperty(String ____________) {
    return properties.get(___________);
  }

  public ______ getProperties() {
    return ______________;
  }

  public boolean matches(______________ otherSpec) {
    for (__________ i = otherSpec._____________().keySet().___________();
         i._________(); ) {
      String _____________ = (String)i.______();
      if (!properties.get(_____________).equals(
           otherSpec.getProperty(____________))) {
        return _________;
      }
    }
    return _________;
  }
}</pre><div class="informalfigure"><a id="med_id00355a"></a><div class="mediaobject"><a id="med_id00355"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069404.png.jpg" alt="image with no caption" width="833" height="166"></div></div></div><div class="sidebar"><a id="code_magnets_solutions-id00083"></a><div class="sidebar-title">Code Magnets Solutions</div><p><a id="iddle1427" class="indexterm"></a>Using a Map for storing properties seems like a good idea, but let’s see how things look once we actually code up a new version of InstrumentSpec. Your job was to finish off the code below:</p><div class="informalfigure"><a id="med_id00356a"></a><div class="mediaobject"><a id="med_id00356"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069406.png.jpg" alt="image with no caption" width="792" height="816"></div></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00084"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1qe1"></a><a id="ch05bqa1q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1780" class="indexterm"></a><span class="strong"><strong>Q: So now both Instrument and InstrumentSpec are concrete classes?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Right. <span class="strong"><strong><code class="literal">Instrument</code></strong></span> isn’t just a concept anymore; it represents actual instruments in Rick’s inventory. And <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> is what clients use to pass in their specs when they’re searching, and what <span class="strong"><strong><code class="literal">Instrument</code></strong></span> uses to store properties for an instrument.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1qe2"></a><a id="ch05bqa1q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: So I can get rid of my Guitar and Mandolin subclasses?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Yup. As well as <span class="strong"><strong><code class="literal">Banjo</code></strong></span>, <span class="strong"><strong><code class="literal">Dobro</code></strong></span>, and any other instrument-specific subclasses of <span class="strong"><strong><code class="literal">Instrument</code></strong></span> you may have created.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1qe3"></a><a id="ch05bqa1q3"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: And that’s because we use the Instrument class directly now, right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1q3a3"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> You got it! Remember, you typically subclass because <span class="emphasis"><em>behavior</em></span> changes. In the <span class="strong"><strong><code class="literal">Instrument</code></strong></span> subclasses, no behavior was changing; in fact, all we did for each instrument subclass was create a new constructor. That added a ton of classes, reduced the flexibility of our app, and really didn’t give us any helpful functionality.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1qe4"></a><a id="ch05bqa1q4"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: I understood getting rid of Guitar and Mandolin, but I’m confused about why we don’t need the different subclasses of InstrumentSpec anymore.</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1q4a4"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> It’s OK; that’s one of the trickiest parts of the design of Rick’s application. Remember, one of the key principles in any OO design is to encapsulate what varies. In Rick’s app, the properties of each instrument varied. So we pulled those properties out of <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, and put them into a <span class="strong"><strong><code class="literal">Map</code></strong></span>. Now, when you add another instrument with a new property, you can just add the new property as a name/value pair in the <span class="strong"><strong><code class="literal">properties Map</code></strong></span>.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1qe5"></a><a id="ch05bqa1q5"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: And with less classes to deal with, our software is more flexible?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1q5a5"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> In this case, that’s true. There are certainly times where adding classes will make your design more flexible, though. Remember, adding an <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> class helped separate instruments from their properties, and that was good; but in this chapter, we’ve been removing classes, and that’s made it easier to add new instruments to Rick’s software.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1qe6"></a><a id="ch05bqa1q6"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: I never would have figured out that we didn’t need subclasses for instruments or their specs. How am I supposed to ever get good at this?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa1q6a6"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> The best way to get good at software design is to write software! In Rick’s application, we had to go down some wrong paths—like adding <span class="strong"><strong><code class="literal">Guitar</code></strong></span> and <span class="strong"><strong><code class="literal">Mandolin</code></strong></span> classes—to figure out what the right thing to do was.</p><p>Most good designs come about through bad designs; almost nobody gets it all right the first time. So just do what makes sense, and then start applying your OO principles and patterns to see if you can make improvements to what you’ve got.</p></td></tr></tbody></table></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Most <span class="underline">good designs</span> come from analysis of <span class="underline">bad designs</span>.</strong></span></p><p><span class="strong"><strong>Never be afraid to make mistakes and then change things around.</strong></span></p></blockquote></div></div></div><div class="sect1" title="Finishing up Rick’s app: the InstrumentType enum"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="finishing_up_rickapostrophes_app_the_ins">Finishing up Rick’s app: the InstrumentType enum</h2></div></div></div><p><a id="iddle1380" class="indexterm"></a><a id="iddle1381" class="indexterm"></a><a id="iddle1388" class="indexterm"></a><a id="iddle1396" class="indexterm"></a>We’ve almost got ourselves a great piece of software. Let’s follow through on our new design ideas, starting with a new enumerated type for each instrument type:</p><div class="informalfigure"><a id="med_id00357a"></a><div class="mediaobject"><a id="med_id00357"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069408.png.jpg" alt="image with no caption" width="706" height="403"></div></div></div><div class="sect1" title="Let’s update Inventory, too"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="letapostrophes_update_inventorycomma_too">Let’s update Inventory, too</h2></div></div></div><p>With the changes to <span class="strong"><strong><code class="literal">Instrument</code></strong></span> and <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span>, our <span class="strong"><strong><code class="literal">Inventory</code></strong></span> class starts to get much simpler:</p><div class="informalfigure"><a id="med_id00358a"></a><div class="mediaobject"><a id="med_id00358"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069410.png.jpg" alt="image with no caption" width="809" height="514"></div></div><div class="sidebar"><a id="sharpen_your_pencil-id00085"></a><div class="sidebar-title">Sharpen your pencil</div><p><a id="iddle1637" class="indexterm"></a>Let’s see what we’ve <span class="underline">really</span> done.</p><p>We’ve made a ton of changes to Rick’s software, all in the name of “more flexibility.” Let’s see how things look now. Flip back to the class diagram of Rick’s app in <a class="xref" href="ch05.html#back_to_rickapostrophes_search_tool" title="Back to Rick’s search tool">Back to Rick’s search tool</a>, and recall what things looked like when we started. Then, below, draw a class diagram for how Rick’s application looks now.</p><div class="blockquote"><blockquote class="blockquote"><p><span class="strong"><strong>Answers on the next page!</strong></span></p></blockquote></div></div></div><div class="sect1" title="Behold: Rick’s flexible application"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="behold_rickapostrophes_flexible_applicat">Behold: Rick’s <span class="underline">flexible</span> application</h2></div></div></div><p>We’ve made a ton of changes to Rick’s application... and it’s easy to forget what we’ve been working towards. Look at the class diagram below, though, and see how much simpler Rick’s application is now:</p><div class="informalfigure"><a id="med_id00359a"></a><div class="mediaobject"><a id="med_id00359"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069412.png.jpg" alt="image with no caption" width="764" height="715"></div></div></div><div class="sect1" title="But does the application actually work?"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="but_does_the_application_actually_workqu">But does the application actually work?</h2></div></div></div><p><a id="iddle1287" class="indexterm"></a>Rick’s software looks a lot better than it did way back at the beginning of this chapter—and it sure looks better than when we added all those subclasses for banjos and mandolins. But we’ve still got to make sure his search tool actually works! So let’s update our test class, and check out how searches work with the new version of Rick’s software:</p><div class="informalfigure"><a id="med_id00360a"></a><div class="mediaobject"><a id="med_id00360"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069414.png.jpg" alt="image with no caption" width="127" height="110"></div></div><div class="informalfigure"><a id="med_id00361a"></a><div class="mediaobject"><a id="med_id00361"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069416.png.jpg" alt="image with no caption" width="828" height="777"></div></div><div class="sidebar"><a id="inventory_roundup"></a><div class="sidebar-title">Inventory Roundup</div><p><a id="iddle1288" class="indexterm"></a><a id="iddle1398" class="indexterm"></a>To see if the new version of Rick’s software works, we need to run a search on more than just guitars. Your job is to write code for the initializeInventory() method in FindInstrument.java, and add several guitars, mandolins, and banjos to Rick’s inventory. Below, we’ve listed the instruments Rick currently has, and even written code to add the first guitar to help you get started.</p><div class="informalfigure"><a id="med_id00362a"></a><div class="mediaobject"><a id="med_id00362"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069418.png.jpg" alt="image with no caption" width="173" height="157"></div></div><div class="informalfigure"><a id="med_id00363a"></a><div class="mediaobject"><a id="med_id00363"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069420.png.jpg" alt="image with no caption" width="842" height="797"></div></div><p><span class="inlinemediaobject"><a id="inline_id00026"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2068819.png.jpg" alt="" width="99" height="9"></span> <span class="strong"><strong>Answers in <a class="xref" href="ch05.html#inventory_roundup_solutions" title="Inventory Roundup Solutions">Inventory Roundup Solutions</a></strong></span></p></div></div><div class="sect1" title="Test driving Rick’s well-designed software"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="test_driving_rickapostrophes_well-design">Test driving Rick’s <span class="underline">well</span>-<span class="underline">designed</span> software</h2></div></div></div><p><a id="iddle1289" class="indexterm"></a><a id="iddle1290" class="indexterm"></a>Be sure you’ve added all the instruments shown on the last page to your <span class="strong"><strong><code class="literal">initializeInventory()</code></strong></span> method in <span class="strong"><strong><code class="literal">FindInstrument.java</code></strong></span>, and then compile all your classes. Now you’re ready to take Rick’s software for a test drive...</p><p>...well, almost. First, you need to figure out what a search based on the current version of <span class="strong"><strong><code class="literal">FindInstrument</code></strong></span> should return. Here’s the set of preferences that Rick’s current client has supplied:</p><div class="informalfigure"><a id="med_id00364a"></a><div class="mediaobject"><a id="med_id00364"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069422.png.jpg" alt="image with no caption" width="613" height="297"></div></div><p>Based on those specs, look over the instruments shown on the last page, and write in which guitars, mandolins, and banjos you think Rick’s search tool should return:</p><div class="informalfigure"><a id="med_id00365a"></a><div class="mediaobject"><a id="med_id00365"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069424.png.jpg" alt="image with no caption" width="712" height="366"></div></div><div class="sidebar"><a id="inventory_roundup_solutions"></a><div class="sidebar-title">Inventory Roundup Solutions</div><p><a id="iddle1399" class="indexterm"></a>To see if the new version of Rick’s software works, we need to run a search on more than just guitars. Your job was to write code for the initializeInventory() method in FindInstrument.java, and add several guitars, mandolins, and banjos to Rick’s inventory.</p><div class="informalfigure"><a id="med_id00366a"></a><div class="mediaobject"><a id="med_id00366"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069426.png.jpg" alt="image with no caption" width="890" height="772"></div></div><div class="informalfigure"><a id="med_id00367a"></a><div class="mediaobject"><a id="med_id00367"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069428.png.jpg" alt="image with no caption" width="870" height="793"></div></div></div></div><div class="sect1" title="Rick’s got working software, his client has three choices"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="rickapostrophes_got_working_softwarecomm">Rick’s got working software, his client has three choices</h2></div></div></div><div class="informalfigure"><a id="med_id00368a"></a><div class="mediaobject"><a id="med_id00368"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069430.png.jpg" alt="image with no caption" width="707" height="559"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00086"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa2qe1"></a><a id="ch05bqa2q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1291" class="indexterm"></a><a id="iddle1781" class="indexterm"></a><span class="strong"><strong>Q: My output isn’t the same as yours. What did I do wrong?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa2q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> If your version of Rick’s tool returned different guitars, or output the same guitars but with different properties, then you should be sure you have the same instruments in your inventory as we do. Check the exercise in <a class="xref" href="ch05.html#inventory_roundup" title="Inventory Roundup">Inventory Roundup</a>, and the answers in <a class="xref" href="ch05.html#test_driving_rickapostrophes_well-design" title="Test driving Rick’s well-designed software">Test driving Rick’s <span class="underline">well</span>-<span class="underline">designed</span> software</a>, and make sure the instruments you have in Rick’s inventory match ours.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa2qe2"></a><a id="ch05bqa2q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Is this really a good test since we only have one banjo and one mandolin?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa2q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> That’s a great question, and you’re right, it would be better to have a few more mandolins and banjos to really make sure Rick’s search tool picks only matching mandolins and banjos. Go ahead and add a few non-matching banjos or mandolins, and try testing out Rick’s search tool with the additional instruments.</p></td></tr></tbody></table></div></blockquote></div></div><div class="informalfigure"><a id="med_id00369a"></a><div class="mediaobject"><a id="med_id00369"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069432.png.jpg" alt="image with no caption" width="556" height="612"></div></div><div class="blockquote"><blockquote class="blockquote"><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="strong"><strong>How easy is it to <span class="underline">change</span> Rick’s software?</strong></span></p></li><li class="listitem"><p><span class="strong"><strong>Is Rick’s software really <span class="underline">well</span>-<span class="underline">designed?</span></strong></span></p></li><li class="listitem"><p><span class="strong"><strong>And what the heck does <span class="underline">cohesive</span> mean?</strong></span></p></li></ul></div></blockquote></div><div class="sidebar"><a id="great_ease-of-change_challenge"></a><div class="sidebar-title">The Great Ease-of-Change Challenge</div><p><a id="iddle1369" class="indexterm"></a>How easy is it to change Rick’s search tool?</p><p>Let’s add support for dobros and fiddles back into Rick’s application. We tried to do that earlier, back in the first part of <a class="xref" href="ch05.html" title="Chapter&nbsp;5.&nbsp;(Part 1) Good Design = Flexible Software: Nothing Ever Stays the Same">Chapter&nbsp;5</a>, and it turned into a total mess. Things should be much easier this time, right? Below is the class diagram for the current version of Rick’s software.</p><div class="informalfigure"><a id="med_id00370a"></a><div class="mediaobject"><a id="med_id00370"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069434.png.jpg" alt="image with no caption" width="623" height="662"></div></div><div class="informalfigure"><a id="med_id00371a"></a><div class="mediaobject"><a id="med_id00371"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069436.png.jpg" alt="image with no caption" width="379" height="235"></div></div><p>Let’s apply the <span class="strong"><strong>ease-of-change test</strong></span> to our software:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>How many classes did you have to <span class="strong"><strong><span class="emphasis"><em>add</em></span></strong></span> to support Rick’s new instrument types?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></li><li class="listitem"><p>How many classes did you have to <span class="strong"><strong><span class="emphasis"><em>change</em></span></strong></span> to support Rick’s new instrument types?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></li><li class="listitem"><p>Suppose that Rick decided that he wanted to start keeping up with what year an instrument was made in. How many classes would you need to change to support keeping up with this new information?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></li><li class="listitem"><p>Rick also wants to add a new property, neckWood, that tracks what wood is used in the neck of an instrument. How many classes would you need to change to support this property?</p><p>_____________________________________________________________________</p><p>_____________________________________________________________________</p></li></ol></div><div class="blockquote"><blockquote class="blockquote"><p><span class="inlinemediaobject"><a id="inline_id00027"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2068819.png.jpg" alt="" width="99" height="9"></span> <span class="strong"><strong>Answers in <a class="xref" href="ch05.html#great_ease-of-change_challenge-id00087" title="The Great Ease-of-Change Challenge">The Great Ease-of-Change Challenge</a></strong></span></p></blockquote></div></div><div class="sidebar"><a id="great_ease-of-change_challenge-id00087"></a><div class="sidebar-title">The Great Ease-of-Change Challenge</div><p>How easy is it to change Rick’s search tool?</p><p>Let’s add support for dobros and fiddles back into Rick’s application. We tried to do that earlier, and it turned into a total mess. Things should be much easier this time, right?</p><p>Let’s apply the <span class="strong"><strong>ease-of-change test</strong></span> to our software:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>How many classes did you have to <span class="strong"><strong><span class="emphasis"><em>add</em></span></strong></span> to support Rick’s new instrument types?</p><p><span class="strong"><strong><span class="underline">None! We got rid of all the instrument-specific subclasses of Instrument and InstrumentSpec.</span></strong></span></p></li><li class="listitem"><p>How many classes did you have to <span class="strong"><strong><span class="emphasis"><em>change</em></span></strong></span> to support Rick’s new instrument types?</p><p><span class="strong"><strong><span class="underline">One: we need to add any new instrument types to the InstrumentType enumerated type.</span></strong></span></p></li><li class="listitem"><p>Suppose that Rick decided that he wanted to start keeping up with what year an instrument was made in. How many classes would you need to change to support keeping up with this new information?</p><p><span class="strong"><strong><span class="underline">None! You can just store the year that an instrument was made in the properties Map in InstrumentSpec.</span></strong></span></p></li><li class="listitem"><p>Rick also wants to add a new property, neckWood, that tracks what wood is used in the neck of an instrument. How many classes would you need to change to support this property?</p><p><span class="strong"><strong><span class="underline">One in the worst case, and maybe none! neckWood is just another property we can store in the InstrumentSpec map... but we might need to add new wood enumerated values to the Wood enum.</span></strong></span></p></li></ol></div></div></div><div class="sect1" title="Sweet! Our software is easy to change... but what about that “cohesive” thing?"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="sweetexclamation_mark_our_software_is_ea">Sweet! Our software is easy to change... but what about that “cohesive” thing?</h2></div></div></div><div class="informalfigure"><a id="med_id00372a"></a><div class="mediaobject"><a id="med_id00372"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069438.png.jpg" alt="image with no caption" width="743" height="396"></div></div><div class="sidebar"><a id="scholarapostrophes_corner-id00088"></a><div class="sidebar-title">The Scholar’s Corner</div><p><a id="iddle1109" class="indexterm"></a><span class="strong"><strong>Cohesion.</strong></span> Cohesion measures the degree of <span class="underline">connectivity</span> among the elements of a single module, class, or object. The <span class="underline">higher the cohesion</span> of your software is, the more <span class="underline">well-defined</span> and <span class="underline">related</span> the responsibilities of each individual class in your application. Each class has a very specific set of <span class="underline">closely related</span> actions it performs.</p></div></div><div class="sect1" title="Cohesion, and one reason for a class to change"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="cohesioncomma_and_one_reason_for_a_class">Cohesion, and one reason for a class to change</h2></div></div></div><p>You may not realize it, but we’ve already talked about cohesion in this book. Remember this?</p><div class="informalfigure"><a id="med_id00373a"></a><div class="mediaobject"><a id="med_id00373"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069440.png.jpg" alt="image with no caption" width="534" height="218"></div></div><p>Cohesion is really just a measure of how closely related the functionality of the classes in an application are. If one class is made up of functionality that’s all related, then it has only one reason to change... which is what we already talked about in <span class="strong"><strong>OO CATASTROPHE!</strong></span></p><p>Here are the classes we talked about when we made sure each class had only a single reason to change:</p><div class="informalfigure"><a id="med_id00374a"></a><div class="mediaobject"><a id="med_id00374"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069442.png.jpg" alt="image with no caption" width="572" height="386"></div></div><div class="sidebar"><a id="there_are_no_dumb_questions-id00089"></a><div class="sidebar-title">There are no Dumb Questions</div><div class="blockquote"><blockquote class="blockquote"><div class="qandaset" title="Frequently Asked Questions"><table style="border: 0; width: 100%; "><colgroup><col style="text-align: left; width: 1%; "><col></colgroup><tbody><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3qe1"></a><a id="ch05bqa3q1"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><a id="iddle1762" class="indexterm"></a><span class="strong"><strong>Q: So cohesion is just a fancy word for how easy it is to change my application?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3q1a1"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Not exactly. Cohesion focuses on how you’ve constructed each individual class, object, and package of your software. If each class does just a few things that are all grouped together, then it’s probably a <span class="strong"><strong><code class="literal">highly cohesive</code></strong></span> piece of software. But if you have one class doing all sorts of things that aren’t that closely related, you’ve probably got <span class="strong"><strong><code class="literal">low cohesion</code></strong></span>.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3qe2"></a><a id="ch05bqa3q2"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: So highly cohesive software is loosely coupled, right?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3q2a2"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Exactly! In almost every situation, <span class="bolditalic">the more cohesive your software is, the looser the coupling between classes</span>. In Rick’s application, the <span class="strong"><strong><code class="literal">Inventory</code></strong></span> class really worries just about managing inventory—and not about how instruments are compared or what properties are stored in an instrument spec. That means that <span class="strong"><strong><code class="literal">Inventory</code></strong></span> is a highly cohesive class. That also means it’s loosely coupled with the rest of the application—changes to <span class="strong"><strong><code class="literal">Instrument</code></strong></span>, for example, don’t have a lot of effect on the <span class="strong"><strong><code class="literal">Inventory</code></strong></span> class.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3qe3"></a><a id="ch05bqa3q3"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: But all that means the software will be easier to change, doesn’t it?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3q3a3"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Most of the time, yes. But remember the version of Rick’s application that we started with in this chapter? It only supported guitars, and we didn’t even have <span class="strong"><strong><code class="literal">Instrument</code></strong></span> or <span class="strong"><strong><code class="literal">InstrumentSpec</code></strong></span> classes. That was pretty cohesive software—<span class="strong"><strong><code class="literal">Guitar</code></strong></span> was very loosely coupled with <span class="strong"><strong><code class="literal">Inventory</code></strong></span>. However, it took a lot of work and redesign to support mandolins.</p><p>When you fundamentally change what an application does—like going from selling only one type of instrument to multiple types—you may have to make lots of changes to a design that’s already cohesive and loosely coupled. So cohesion isn’t <span class="emphasis"><em>always</em></span> a test of how easy it is to change software; but in cases where you’re <span class="emphasis"><em>not</em></span> dramatically changing how software works, highly cohesive software is usually easy to change.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3qe4"></a><a id="ch05bqa3q4"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: And high cohesion is better than low cohesion?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3q4a4"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> Right. Good OO design is when each class and module in your software does <span class="strong"><strong><code class="literal">one basic thing</code></strong></span>, and that one thing really well. As soon as one class starts doing two or three different things, you’re probably moving away from cohesion, and good OO design.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3qe5"></a><a id="ch05bqa3q5"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: Wouldn’t software that’s cohesive be easier to reuse, as well as change?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3q5a5"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> You got it. High cohesion and loose coupling adds up to software that can easily be extended, or even broken up and reused, because all the objects in the software aren’t interdependent.</p><p>Think about it this way: the higher the cohesion in your application, the better defined each object’s job is. And the better defined an object (and its job) is, the easier it is to pull that object out of one context, and have the object do the same job in another context. The object is happy to just keep on doing its very specific job, no matter where it’s being used.</p></td></tr><tr class="question" title="Q:"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3qe6"></a><a id="ch05bqa3q6"></a><p><strong>Q:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>Q: And we’ve been making Rick’s application more cohesive throughout his chapter, haven’t we?</strong></span></p></td></tr><tr class="answer"><td style="text-align: left; vertical-align: top; "><a id="ch05bqa3q6a6"></a><p><strong>A:</strong></p></td><td style="text-align: left; vertical-align: top; "><p><span class="strong"><strong>A:</strong></span> For the most part, yes. But let’s look a little bit closer at that question...</p></td></tr></tbody></table></div></blockquote></div></div></div><div class="sect1" title="Rick’s software, in review"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="rickapostrophes_softwarecomma_in_review">Rick’s software, in review</h2></div></div></div><p>So have our changes to Rick’s software resulted in high cohesion? Are our objects loosely coupled? And can we make changes easily? Let’s take a look:</p><div class="informalfigure"><a id="med_id00375a"></a><div class="mediaobject"><a id="med_id00375"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069444.png.jpg" alt="image with no caption" width="1000" height="553"></div></div><div class="informalfigure"><a id="med_id00376a"></a><div class="mediaobject"><a id="med_id00376"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069446.png.jpg" alt="image with no caption" width="504" height="468"></div></div><p><a id="iddle1162" class="indexterm"></a><a id="iddle1331" class="indexterm"></a><a id="iddle1697" class="indexterm"></a><span class="strong"><strong>Great software is usually about being <span class="underline">good enough</span>.</strong></span></p><p>It’s hard to know when to stop designing software. Sure, you can make sure that your software does what it’s supposed to do, and then start working on increasing the flexibility and cohesion of your code. <span class="emphasis"><em>But then what?</em></span></p><p>Sometimes you just have to stop designing because you run out of time... or money... and sometimes you just have to recognize you’ve <span class="emphasis"><em>done a good enough job to move on</em></span>.</p><p>If your software works, the customer is happy, and you’ve done your best to make sure things are designed well, then it just might be time to move on to the next project. Spending hours trying to write “perfect software” is a waste of time; spending lots of time writing great software and then moving on, is sure to win you <span class="strong"><strong>more work</strong></span>, <span class="strong"><strong>big promotions</strong></span>, and loads of <span class="strong"><strong>cash and accolades</strong></span>.</p></div><div class="sect1" title="Knowing when to say “It’s good enough!”"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="knowing_when_to_say_quotation_markitapos">Knowing when to say “It’s good enough!”</h2></div></div></div><div class="informalfigure"><a id="med_id00377a"></a><div class="mediaobject"><a id="med_id00377"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069448.png.jpg" alt="image with no caption" width="430" height="467"></div></div><p><span class="strong"><strong>Make sure the customer is happy</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote09"></a>Note</h3><p>Before you ever leave a project, you always want to make sure your software does what it’s supposed to do.</p></div><div class="informalfigure"><a id="med_id00378a"></a><div class="mediaobject"><a id="med_id00378"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069450.png.jpg" alt="image with no caption" width="524" height="434"></div></div><p><span class="strong"><strong>Make sure your design is flexible</strong></span></p><div class="note" title="Note"><h3 class="title"><a id="ch05bnote10"></a>Note</h3><p>Once you’ve got functionality down, move on to making good design decisions, using solid OO principles to add flexibility.</p></div><p><span class="strong"><strong>If you’ve done <span class="underline">both</span> of these things, it may just be time to <span class="underline">move</span> <span class="underline">on</span>... to the next project, the next application, even the next chapter!</strong></span></p><div class="sidebar"><a id="tools_for_your_ooaampersandd_too-id00090"></a><div class="sidebar-title">Tools for your OOA&amp;D Toolbox</div><p><a id="iddle1474" class="indexterm"></a><span class="strong"><strong>Wow, you’ve really come a long way since we started working with Rick way back in <a class="xref" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Well-Designed Apps Rock: Great Software Begins Here">Chapter&nbsp;1</a>. You’ve learned a ton about design, so let’s do a quick review of what you’ve added to your toolbox.</strong></span></p><div class="informalfigure"><a id="med_id00379a"></a><div class="mediaobject"><a id="med_id00379"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069452.png.jpg" alt="image with no caption" width="704" height="811"></div></div></div><div class="sidebar"><a id="ooaampersandd_cross-id00091"></a><div class="sidebar-title">OOA&amp;D Cross</div><p><a id="iddle1465" class="indexterm"></a>This one is a particularly tough puzzle: almost all the answers are more than one word, and they’re spread across <span class="strong"><strong>both</strong></span> parts of <a class="xref" href="ch05.html" title="Chapter&nbsp;5.&nbsp;(Part 1) Good Design = Flexible Software: Nothing Ever Stays the Same">Chapter&nbsp;5</a>. Good luck, and keep that left brain working.</p><div class="informalfigure"><a id="med_id00380a"></a><div class="mediaobject"><a id="med_id00380"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069454.png.jpg" alt="image with no caption" width="540" height="385"></div></div><div class="informaltable"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"><col class="c2"></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Across</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Down</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>3. Never code to this if you can help it.</p>
<p>8. Great software is easy to ______________.</p>
<p>12. software that’s easy to change is _____________.</p>
<p>13. Do this to what varies.</p>
<p>15. Never be afraid to do this to your designs.</p>
<p>17. This will kill good design.</p>
<p>18. Classes are about this.</p>
<p>19. When one thing is mode up of another.</p></td><td style="vertical-align: top; "><p>1. Always code to this if possible.</p>
<p>2. Most good designs come from analysis of these.</p>
<p>4. Abstract classes are written this way in UML class diagrams.</p>
<p>5. When a class inherits behavior from another class.</p>
<p>6. This was the type of group ensuring your software was highly cohesive.</p>
<p>7. Apply these to add flexibility to your software.</p>
<p>9. Cohesive classes do this really well.</p>
<p>10.Don’t be afraid to do this: It will help you find better solutions</p>
<p>11. We used this test to see if Rick’s application was cohesive.</p>
<p>14. Highly cohesive software is also almost always_____________ coupled.</p>
<p>16. Great software must always do what it is __________________ to do.</p></td></tr></tbody></table></div></div><div class="sidebar"><a id="exercise_solutions-id00092"></a><div class="sidebar-title">Exercise Solutions</div><div class="informalfigure"><a id="med_id00381a"></a><div class="mediaobject"><a id="med_id00381"></a><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/httpatomoreillycomsourceoreillyimages2069456.png.jpg" alt="image with no caption" width="582" height="419"></div></div></div></div></section></div></div><link rel="stylesheet" href="https://learning.oreilly.com/files/public/epub-reader/override_v1.css" crossorigin="anonymous"><link rel="stylesheet" href="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:0596008678/files/core.css" crossorigin="anonymous"></div></div></section>
</div>

